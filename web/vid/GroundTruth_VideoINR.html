<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><style> html { height: 100%; } body { font-size: 16px; font-family:san-serif; background:#000; height: 100%; overflow: hidden; margin: 0; }</style></head><body><div class="icat-embed-element" style="width:100%;height:100%;"><compare-app id="icat-20187219999999553fdecabf76ce608c924534"></compare-app></div><script type="text/javascript">!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(e,t,i,n=null){if(!e)return console.error("SetEvent error: Invalid host");let a=n;a||(a=e);const o=e._events;if(!Array.isArray(o))return console.error("SetEvent error: Invalid _events array",e);let s=o.length-1;for(;s>-1;){const i=o[Number(s)];if(i&&i.element===a&&i.eventName===t)return console.warn(`Event ${t} already bound`,e);s-=1}e._events.push({element:a,eventName:t,remove:()=>a.removeEventListener(t,i)}),a.addEventListener(t,i)}function t(e,t,i=null){if(!e)return console.error("RemoveEvent error: Invalid host");let n=i;n||(n=e);const a=e._events;if(!Array.isArray(a))return console.error("RemoveEvent error: Invalid _events array",e);let o=a.length-1;for(;o>-1;){const i=a[Number(o)];if(i&&i.element===n&&i.eventName===t)return i.remove(),void e._events.splice(o,1);o-=1}}let i=0;function n(e){return`${performance.now()}xxxxxxxxxxxxxxxx`.replace(/[x]|\./g,(()=>(16*Math.random()|0).toString(16)))+e}function a(){return i+=1,n(i)}const o=["string","number","null","undefined","function","boolean","date"];function s(e){return o.indexOf(typeof e)>-1||null===e||e instanceof Date}let r=!1;try{r="undefined"!=typeof window}catch(e){}function l(e){return null===e?"null":s(e)?"string"==typeof e?"string":Number.isNaN(e)?function(e){if("string"==typeof e&&parseFloat(e).toString()===e)return!1;const t=new Date(Date.parse(e));return"Invalid Date"!==t&&!Number.isNaN(t)&&t instanceof Date}(e)?"date":typeof e:"number":function(e){return!!r&&(e instanceof Element||e instanceof Node)}(e)?"dom":Array.isArray(e)?"array":function(e){return(typeof e).indexOf("object")>-1&&null!==e&&!Array.isArray(e)&&!(e instanceof Date)}(e)?"object":typeof e}function d(e,t){const i=l(e);if(l(t)!==i)return!1;if(s(e)){if("date"===i){let i=e===t;return i=new Date(e).getTime()===new Date(t).getTime(),i}return t===e}if("boolean"===i&&e!==t)return!1;if("array"===i&&e.length!==t.length)return!1;if("object"===i&&Object.keys(e).length!==Object.keys(t).length)return!1;if("object"===i&&e.constructor!==t.constructor)return!1;if("dom"===i)return e.isSameNode(t);if("array"===i){let i=e.length-1;for(;i>-1;){if(!d(e[Number(i)],t[Number(i)]))return!1;i-=1}}if("object"===i){const i=Object.keys(e);let n=i.length-1;for(;n>-1;){if(!d(e[i[Number(n)]],t[i[Number(n)]]))return!1;n-=1}}return!0}function c(e,t={}){const i=a(),n=t.matchType||!1,o=t.formatter&&"function"==typeof t.formatter?t.formatter:e=>e,s=o(e),r=l(s),c={};let h,u=!1,m=s,p=!0;const g={id:i,get previous(){return h},get isInitial(){return p},get isComplete(){return u},get value(){return m},get subscriptions(){return c},next:e=>{const t=o(e,g);if(!(n&&l(t)!==r||d(t,m)))return p=!1,h=m,m=t,f("next",m),g},complete:()=>{f("complete")},subscribe:(e,t=(()=>{}))=>{if(u)throw new Error("Observer that is complete can not be subscribed to");const i=a();c[`${i}`]={next:e,complete:t,id:i,unsubscribe:b(i)};const n=c[`${i}`];return void 0!==m&&"function"==typeof n.next&&n.next(m,g,h),b(i)}};function b(e){return function(){c[`${e}`]=null,delete c[`${e}`]}}function f(e,t){Object.keys(c).forEach((i=>{const n=c[`${i}`];n&&("next"===e?n.next(t,g,h):"complete"===e&&n.complete(g))})),"complete"===e&&(Object.keys(c).forEach((e=>{const t=c[`${e}`];t&&(t.unsubscribe(),delete c[`${e}`])})),h=null,m=null,u=!0)}return g}function h(e){const t=Object.keys(e._stateConfigs),i=e._stateConfigs;t.forEach((t=>function(e,t,i){if(!e||!i||!t)throw new Error("Invalid state arguments");if(e._state[`${t}`])throw new Error(`State observer already set for ${t}`);const n=e,a=e.getAttribute(t),o=n[`${t}`],s=null==a?o:a;e._state[`${t}`]=c(s,{formatter:i.formatter,matchType:!1!==i.matchType}),Object.defineProperty(e,t,{enumerable:!0,get(){const i=e._state[`${t}`];if(i)return i.value;console.warn(`invalid state observer ${t} in get`,e)},set(i){const n=e._state[`${t}`];if(n)return n.next(i);console.warn(`invalid state observer ${t} in set`,e)}})}(e,t,i[`${t}`])))}function u(e){const t=Object.keys(e._stateConfigs),i=e._stateConfigs;t.forEach((t=>function(e,t,i){if(!e||!i||!t)throw new Error("Invalid state subscription arguments");if(!e._state[`${t}`])throw new Error(`State subscription error, state observer not set for ${t}`);const n="function"==typeof i.onChange,a="function"==typeof i.onComplete,o=!!i.reflect;if(!n&&!a&&!o)return;const s=e;s._stateSubscriptions[`${t}`]&&(console.warn(`Overwriting state subscription for ${t} on ${e}`),s._stateSubscriptions[`${t}`]());const r=a?t=>i.onComplete.apply(e,[t]):()=>{};e._stateSubscriptions[`${t}`]=e._state[`${t}`].subscribe(((a,s,r)=>{o&&e.setAttribute(t,a),n&&i.onChange.apply(e,[a,s,r])}),r)}(e,t,i[`${t}`])))}function m(e){const t=Number.isNaN(e)||"string"==typeof e?parseFloat(e):e;return Number.isNaN(e)?t:e.trim()}function p(e){return e}function g(e=""){const t=/\((.*?)\)/g.exec(e||"");return t?t[1]:""}function b(e,t="",i,n=p){if(null==e)return n(i);const a=t.split(".").filter((e=>!!e));let o=e;const s=a.length;let r=a.length;for(;r;){if(null==o){o=i;break}const e=s-r,t=/\(/.exec(a[Number(e)]);if(t){const i=o[a[Number(e)].slice(0,t.index)];if("function"==typeof i){o=i.apply(o,g(a[Number(e)]).split(",").map(m)),r-=1;continue}}o=o[a[Number(e)]],r-=1}return null==o&&(o=i),n(o)}const f=(e="",t="")=>e.split(t).map((e=>e.trim())).filter((e=>!!e));class v extends HTMLElement{_state={};_stateSubscriptions={};_stateDomSubscriptions={};_stateConfigs={};_events=[];_mutationObserver;_childrenMutationObserver;_connected=!1;_disconnected=!0;_initialized=!1;constructor(){super()}attributeChangedCallback(e,t,i){const n=this._state[`${e}`];n&&n.next(i)}stateDomSubscriptionIndex(e,t,i,n,a){return e&&t&&i&&a?this._stateDomSubscriptions[`${t}`].findIndex((t=>t.element===e&&t.type===a&&t.path===n&&t.name===i)):(console.warn(`Invalid arguments for stateDomSubscriptionIndex. stateKey: ${t}, name: ${i}, type: ${a}, path: ${n}, element: ${e}`,this),-1)}initStateDomSubscriptions(){Object.keys(this._state||{}).forEach((e=>{this._stateDomSubscriptions[`${e}`]=(this._stateDomSubscriptions[`${e}`]||[]).reduce(((e,t)=>(this.shadowRoot.contains(t.element)?e.push(t):t.unsubscribe(),e)),[])}))}removeStateDomSubscription(e,t,i,n,a){const o=this.stateDomSubscriptionIndex(e,t,i,n,a);-1!==o&&this._stateDomSubscriptions[`${t}`].splice(o,1)}setEventBindings(){!function(e){let t=e._events.length-1;for(;t>-1;){const i=e._events[Number(t)];if(i){const n=i.element===window;(!e.shadowRoot||n&&!e._connected||!n&&e.shadowRoot&&!e.shadowRoot.contains(i.element)&&e!==i.element)&&(i.remove(),e._events.splice(t,1))}t-=1}}(this),Array.from(this.shadowRoot.querySelectorAll("[bind-events]")).forEach((t=>{const i=t.getAttribute("bind-events");i&&(f(i,"|").forEach((i=>{const n=f(i,":"),a=n[0],o=2===n.length?n[1]:n[2],s=this[`${o}`];if(!o||"function"!=typeof s)return console.warn(`Invalid method ${o} found when binding event ${a}`,this);e(this,a,(e=>s(e)),t)})),t.removeAttribute("bind-events"))}))}registerBindings(){this.initStateDomSubscriptions(),this.setEventBindings();Object.keys(this._state||{}).forEach((e=>{const t={prop:Array.from(this.shadowRoot.querySelectorAll(`[bind-prop-${e}]`)),attr:Array.from(this.shadowRoot.querySelectorAll(`[bind-attr-${e}]`))};Object.keys(t).forEach((i=>t[`${i}`].forEach((t=>{const n=`bind-${i}-${e}`;(t.getAttribute(n)||"").trim().split("|").map((e=>e.trim())).filter((e=>!!e)).forEach((a=>{const o=a.split(":").map((e=>e.trim())).filter((e=>!!e)),s=o[0],r=o[1]||"";if(this._stateDomSubscriptions[`${e}`].findIndex((e=>e.element===t&&e.type===i&&e.path===r&&e.name===s))>-1)return t.removeAttribute(n);const l=this._state[`${e}`].subscribe((e=>{if(!this.shadowRoot.contains(t))return d();"attr"===i?t.setAttribute(s,b(e,r)):t[`${s}`]=b(e,r)})),d=()=>{l(),this.removeStateDomSubscription(t,e,s,r,i)};this._stateDomSubscriptions[`${e}`].push({element:t,type:i,path:r,name:s,unsubscribe:d})})),t.removeAttribute(n)}))))}))}attached(){}connectedCallback(){if(this._connected=!0,this._initialized||(this._initialized=!0,h(this),u(this)),this.registerBindings(),!this._mutationObserver){this._mutationObserver=new MutationObserver((()=>this.registerBindings()));const e=this.shadowRoot.children[0];e&&this._mutationObserver.observe(e,{childList:!0,subtree:!0})}"function"!=typeof this.childrenCallback||this._childrenMutationObserver||(this._childrenMutationObserver=new MutationObserver((()=>{this.childrenCallback.bind(this)()})),this._childrenMutationObserver.observe(this,{childList:!0,subtree:!0})),!0===this._disconnected&&(this._disconnected=!1,this.attached())}detached(){}disconnectedCallback(){this._connected=!1,requestAnimationFrame((()=>{var e;this._connected||(this._initialized=!1,this._disconnected=!0,this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null),this._childrenMutationObserver&&(this._childrenMutationObserver.disconnect(),this._childrenMutationObserver=null),Object.keys(this._stateDomSubscriptions).forEach((e=>{this._stateDomSubscriptions[`${e}`].forEach((e=>{"function"==typeof e.unsubscribe&&e.unsubscribe()})),delete this._stateDomSubscriptions[`${e}`]})),function(e){if(!e)return console.error("RemoveEvents error: Invalid host");const t=e._events;if(!Array.isArray(t))return console.error("RemoveEvents error: Invalid _events array",e);let i=t.length-1;for(;i>-1;){const n=t[Number(i)];n&&"function"==typeof n.remove&&n.remove(),e._events.splice(i,1),i-=1}}(this),e=this,Object.keys(e._stateSubscriptions).forEach((t=>{const i=e._stateSubscriptions[`${t}`];"function"==typeof i&&(i(),delete e._stateSubscriptions[`${t}`])})),Object.keys(this._state).forEach((e=>{this._state[`${e}`].complete(),delete this._state[`${e}`]})),this.detached())}))}}function y({tag:e="",properties:t={},attributes:i={},children:n=[],events:a={}}){if(!e)return;const o=document.createElement(e);return Object.keys(t).forEach((e=>{o[`${e}`]=t[`${e}`]})),Object.keys(i).forEach((e=>o.setAttribute(e,i[`${e}`]))),Object.keys(a).forEach((e=>o.addEventListener(e,a[`${e}`]))),n.forEach((e=>o.appendChild(e))),o}function w(e="<div></div>",t=""){const i=document.createElement("template");return i.innerHTML=e,t&&i.content.appendChild(y({tag:"style",properties:{innerHTML:t}})),i}function x(e){return Object.keys(e).reduce(((t,i)=>!1!==e[`${i}`].attribute?t.concat([i]):t),[])}function E(e,t){customElements.get(e)||customElements.define(e,t)}function S(e){return`00${e}`.slice(-2)}function T(e,t){if(0===t||0===e)return"00:00";const i=Math.ceil(t),n=Math.round(e*i),a=n%i,o=(n-a)/i%60,s=Math.floor(e/60),r=Math.floor(e/3600);return`${r>0?`${S(r)}:`:""}${s>0?`${S(s)}:`:""}${S(o)}.${S(Number.isNaN(a)?0:a)}`}function C(e,t){e&&(e.shadowRoot?(e.shadowRoot.innerHTML="",e.shadowRoot.appendChild(document.importNode(t.content,!0))):e.attachShadow({mode:"open"}).appendChild(document.importNode(t.content,!0)))}function I(e,t,i,n){const a=Math.round(i*e);let o=Math.min(0,n);return a<t?o=(t-a)/2:Math.abs(o)>a-t&&(o=-(a-t)),o}function k({container:e,array:t,getElementsFn:i,createFn:n,updateFn:a,valueKeyFn:o,elementValueKeyFn:s}){if(!e)return;let r=i();const l=r.slice(),d=(e,t)=>e.findIndex(((e,i)=>s(e,i)===t));t.forEach(((t,s)=>{const c=o(t,s),h=d(r,c);if(-1===h){const a=n(t,s);if(!a)return;e.insertBefore(a,r[Number(s)]),r=i()}else{const n=r[Number(h)];h!==s&&(e.insertBefore(n,r[Number(s)]),r=i()),function(e){const t=d(l,e);t>-1&&l.splice(t,1)}(c),"function"==typeof a&&a(n,t,s)}})),l.forEach((t=>e.removeChild(t)))}const R=["tile","split"];function L(e=0){if(0===e)return 0;const t=+(1/Math.round(e)).toFixed(6);return Number.isFinite(t)?t:0}const M=function(e,t=33,i=!1){let n=0;const a=this;return function(){const o=a,s=arguments,r=i&&!n,l=function(){n=requestAnimationFrame((function(){n=0,i||e.apply(o,s)}))};clearTimeout(n),cancelAnimationFrame(n),n=setTimeout(l,t),r&&e.apply(o,s)}};const A="undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0,O=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,B={isElectron:A,iOS:O,electronUrlPrefix:"icat://localhost/?src=",setMediaSourceFromPlayer:(e,t)=>{if(A){const i=e.query.mediaPlayers.find((e=>e.id===t.id));i&&"function"==typeof i.getSrc&&(t.src=i.getSrc())}return t},deleteMediaElement:e=>{if(!e)return;let t=e.src;e.onerror=null,e.src="",B.clearUrl(t),e=null,t=null},pathFromElectronUrl:(e="")=>e?decodeURIComponent(e.replace(B.electronUrlPrefix,"").replace("icat://localhost?src=","")):"",pathToElectronUrl:e=>`${B.electronUrlPrefix}${encodeURIComponent(e)}`,clearCache:()=>{window.NvCompareApi&&window.NvCompareApi.clearCache()},clearUrl:e=>{if(!A)try{URL.revokeObjectURL(e)}catch(e){}B.clearCache()},isElectronUrl:e=>!!e&&"icat://localhost"===e.slice(0,16),getUrl:(e,t)=>A&&t&&"string"==typeof t?B.isElectronUrl(t)?t:B.pathToElectronUrl(t):A&&e?B.pathToElectronUrl(e.path):URL.createObjectURL(e),saveProject:async e=>A?window.NvCompareApi.saveProject(e):Promise.reject(),openProject:()=>A?window.NvCompareApi.openProject():Promise.reject(),logError:e=>{if(A)try{window.NvCompareApi.logError(JSON.stringify([e]))}catch(e){}}};function N(e){return Object.prototype.toString.call(e).slice(8,-1)}const P=["Boolean","Number","String","Error","Date"];function F(e){const t=e.constructor,i=N(e);return P.indexOf(i)>-1?new t(e):"RegExp"===i?function(e){const t=/\w*$/,i=new e.constructor(e.source,t.exec(e));return i.lastIndex=e.lastIndex,i}(e):"Symbol"===i?function(e){return Object(Symbol.prototype.valueOf.call(e))}(e):"Function"===i?e:null}function D(e,t){let i=0;const n=e.length;for(;i<n;)t(e[Number(i)],i),i+=1;return e}function V(e,t=new WeakMap){if("object"!=typeof e||null===e)return e;const i=N(e);let n=null;return t.get(e)?t.get(e):(t.set(e,n),"Set"!==i&&"Map"!==i&&"Array"!==i&&"Object"!==i?F(e):"Set"===i?(n=new Set,e.forEach((e=>{n.add(V(e,t))})),n):"Map"===i?(n=new Map,e.forEach(((e,i)=>{n.set(i,V(e,t))})),n):("Array"===i&&(n=[],D(e,((e,i)=>{n[Number(i)]=V(e,t)}))),"Object"===i&&(n={},D(Object.keys(e),(i=>{n[`${i}`]=V(e[`${i}`],t)}))),n))}const U=navigator.userAgent.indexOf("Macintosh;")>0;function z(){const t=e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},i=this.shadowRoot.getElementById("settings-btn");i&&e(this,"click",(e=>{t(e);this.shadowRoot.getElementById("app-settings-modal").visible=!0}),i),e(this,"toggle-webgl",(()=>{this.webgl=!this.webgl})),e(this,"icat-player-playing",(()=>{this.query.playbackControls.playing=!0})),e(this,"icat-player-paused",(()=>{this.query.playbackControls.playing=!1})),e(this,"updateshaderinput",(e=>{e.preventDefault(),e.stopPropagation();const{id:t,index:i,value:n}=e.detail,a=this.shaderInputs[`${t}`].slice(),o=this.query.mediaPlayers,s=o[o.findIndex((e=>e.id===n))];a&&s&&(a[Number(i)]={id:n,element:s.canvas()},this.shaderInputs={...this.shaderInputs,[t]:a})})),e(this,"updateshadersetting",(e=>{e.preventDefault(),e.stopPropagation();const{id:t,key:i,value:n}=e.detail,a=this.shaderUiSettings[`${t}`];if(!a)return;const o={...a[`${i}`]};o&&(o.value=n,this.shaderUiSettings={...this.shaderUiSettings,[t]:{...a,[i]:o}})})),e(this,"updatemediavisibility",(e=>{t(e),this.mediaVisibility={...this.mediaVisibility,...e.detail}})),e(this,"update-overlay-visibility",(e=>{t(e),this.overlayVisibility={...this.overlayVisibility,...e.detail}})),e(this,"loadset",(e=>{t(e),this.loadSet(e.detail)})),e(this,"confirm-delete-set",(e=>{e.preventDefault(),e.stopPropagation();const t=this.query.confirmDeleteSetModal;t.setId=e.detail.id,t.setName=e.detail.name,t.visible=!0})),e(this,"confirm-delete-media",(e=>{e.preventDefault(),e.stopPropagation();const t=this.query.confirmDeleteMediaModal;t.media=e.detail,t.visible=!0})),e(this,"delete-set",(e=>{t(e);const i=V(this.sets),n=e.detail,a=i.findIndex((e=>e.id===n));if(-1===a)return;if(i.splice(a,1),this.sets=i,n!==this.activeSet)return;const o=this.sets[0];o?this.loadSet(o.id):this.clearMedia()})),e(this,"delete-media-in-all-sets",(e=>{t(e);const i=e.detail;if(!i||!i.metadata)return;const n=i.metadata.size,a=i.metadata.modified,o=i.mediaName.name,s=i.mediaName.path;this.updateCurrentSet();let r=this.mediaOrder.slice();const l=V(this.sets).map((e=>(e.media=e.media.filter((e=>!e.metadata||(e.mediaName.name!==o||e.mediaName.path!==s||e.metadata.size!==n||e.metadata.modified!==a||(r=r.filter((t=>t!==e.id)),!1)))),e)));this.mediaOrder=r,this.sets=l,this.loadSet(this.activeSet)})),e(this,"updatestarttime",(e=>this.updateStartTime(e.detail))),e(this,"updateendtime",(e=>this.updateEndTime(e.detail))),e(this,"deletemedia",(e=>this.deleteMedia(e.detail))),e(this,"icat-update-media-order",(e=>{this.mediaOrder=e.detail})),e(this,"rename-set",(e=>{t(e);const i=V(this.sets),n=e.detail.id,a=e.detail.label,o=i.findIndex((e=>e.id===n));-1!==o&&(i[Number(o)].label=a,this.sets=i)})),e(this,"updateexposure",(e=>{t(e),this.exposure=e.detail})),e(this,"updategamma",(e=>{t(e),this.gamma=e.detail})),e(this,"rendererready",(e=>{const t=e.detail;this.query.mediaPlayers.indexOf(t)>-1&&t&&"function"==typeof t.seek&&t.seek(this.time-this.getMediaStartTime(t.id))})),e(this,"media-message",(e=>{t(e),this.message=e.detail.message})),e(this,"messageoverlayhidden",(e=>{t(e),this.query.messageOverlay===e.detail&&(this.message="")})),e(this,"togglelooping",(e=>{t(e),this.looping=!this.looping,this.playing=!1,this.shouldPlay=!1})),e(this,"setlooping",(e=>{t(e),this.looping=e.detail})),e(this,"setboomerang",(e=>{t(e),this.boomerang=e.detail})),e(this,"toggleplay",(e=>{t(e),this.shouldPlay=!this.playing,this.disableTimeControls&&this.hasVideo||(this.playing=!this.playing)})),e(this,"doplay",(e=>{t(e),this.shouldPlay=!0,this.disableTimeControls||(this.playing=!0)})),e(this,"dopause",(e=>{t(e),this.shouldPlay=!1,this.disableTimeControls||(this.playing=!1)}));const n=e=>{this.setCurrentTime(e,!0)};e(this,"gofirstframe",(e=>{t(e),n(this.startTime)})),e(this,"golastframe",(e=>{t(e),n(this.getEndTime())})),e(this,"gopreviousframe",(e=>{t(e),n(this.time-L(this.fps))})),e(this,"gonextframe",(e=>{t(e),n(this.time+L(this.fps))}));const o=M((e=>{this.setCurrentTime(e.detail.time+this.startTime,e.detail.updatePlayers)}),1);e(this,"updatetime",(e=>{t(e),o(e)}));const s=M((e=>{this.setCurrentTime(e.detail.time,e.detail.updatePlayers)}),1);e(this,"updateplayheadtime",(e=>{t(e),s(e)})),e(this,"showmessage",(e=>{t(e),this.showMessage(e.detail),this.focus()})),e(this,"speedupdate",(e=>{t(e),this.playing=!1,this.shouldPlay=!1,this.addUndo("speed",this.speed),this.speed=e.detail})),e(this,"antialiasupdate",(e=>{t(e),this.playing=!1,this.shouldPlay=!1,this.addUndo("antiAlias",this.antiAlias),this.antiAlias=e.detail})),e(this,"setgrid",(e=>{t(e),this.addUndo("grid",this.grid),this.grid=e.detail})),e(this,"togglefullscreen",(e=>{t(e),this.fullscreen=!this.fullscreen})),e(this,"toggle-media-visibility",(e=>{t(e);const i=e.detail;this.mediaVisibility={...this.mediaVisibility,[`${i}`]:!this.mediaVisibility[`${i}`]}})),e(this,"toggle-overlay-visibility",(e=>{t(e);const i=e.detail;this.overlayVisibility={...this.overlayVisibility,[`${i}`]:!this.overlayVisibility[`${i}`]}})),e(this,"click",(e=>{t(e),this.layout="split"}),this.query.layoutBtnSplit),e(this,"click",(e=>{t(e),this.layout="tile"}),this.query.layoutBtnTile),e(this,"click",(e=>{t(e),this.showHelp()}),this.query.helpBtn),e(this,"mediaerror",(e=>{t(e),this.message=`There was an error trying to load media "${this.mediaNames[`${e.detail.id}`].name}"`})),e(this,"splitupdate",(e=>{t(e),this.splitposition=e.detail})),e(this,"switchmedia",(e=>{t(e),this.switchMedia(e.detail.id,e.detail.index)})),e(this,"fullscreenchange",(()=>{document.fullscreenElement||(this.fullscreen=!1),this.updateXYZ(this.position.x,this.position.y,this.position.z)})),e(this,"setmute",(e=>{t(e),this.playing=!1,this.shouldPlay=!1;const i=e.detail.id,n=e.detail.value;!i||!0!==n&&!1!==n||(this.muteState={...this.muteState,[`${i}`]:n})}));let r=!1;e(this,"dragstartcanvas",(e=>{if(t(e),r)return;document.body.style.userSelect="none";const i=this.query.mediaContainer;if(!i)return;const n=i.getBoundingClientRect();this.lastX=e.detail.clientX-n.left,this.lastY=e.detail.clientY-n.top;const a=e=>{e.preventDefault();const t=this.query.mediaContainer.getBoundingClientRect(),i=e.clientX-t.left,n=e.clientY-t.top,a=this.position.x+(i-this.lastX),o=this.position.y+(n-this.lastY);this.updateXYZ(a,o,this.position.z),this.lastX=i,this.lastY=n},o=e=>{e.preventDefault(),document.body.style.removeProperty("user-select"),this.lastX=0,this.lastY=0,window.removeEventListener("pointermove",a),document.removeEventListener("pointerup",o),document.removeEventListener("pointerleave",o)};window.addEventListener("pointermove",a),document.addEventListener("pointerup",o),document.addEventListener("pointerleave",o)})),e(this,"zoomupdate",(e=>{if(t(e),e.detail===this.position.z)return;const i=this.position.x,n=this.position.y,a=this.position.z/100,o=this.query.mediaContainer.getBoundingClientRect(),s=e.detail/100,r=o.height/2;let l=o.width/2;"split"!==this.layout&&(l=o.width/this.mediaOrder.filter((e=>this.mediaVisibility[`${e}`])).length/2);const d=(l-i)/a,c=(r-n)/a,h=d+(l-d)-d*s,u=c+(r-c)-c*s;this.updateXYZ(h,u,100*s)}));let l=!1;e(this,"wheel",(e=>{if(l)return;t(e);const i=this.query.mediaContainer;if(!i)return;const n=this.position.z/100,a=i.getBoundingClientRect(),o=e.deltaY<0?1:-1,s=Math.exp(.062*o),r=Math.ceil(this.scaleOrMin(Math.min(this.maxZoom,this.position.z*s)))/100,d=e.pageY-a.top;let c=e.pageX-a.left,h=0;if("split"!==this.layout){const t=this.mediaOrder.map((e=>this.mediaVisibility[`${e}`])).filter((e=>!!e)),i=a.width/t.length;for(;h<t.length&&!(i*(h+1)>c);)h+=1;c=e.pageX-i*h-a.left}const u=(c-this.position.x)/n,m=(d-this.position.y)/n,p=u+(c-u)-u*r,g=m+(d-m)-m*r;this.updateXYZ(p,g,100*r)}),this.query.mediaContainer),e(this,"scroll",(()=>{l=!0,requestAnimationFrame((()=>{l=!1}))}),window);e(this,"touchstart",(e=>{if(l)return;t(e);const i=this.query.mediaContainer,n=this.query.mediaContainer;if(!i)return;const a=e.touches||e.changedTouches;if("touchstart"!==e.type||2!==a.length)return;function o(e){const t=e.touches||e.changedTouches;return Math.sqrt((t[0].clientX-t[1].clientX)*(t[0].clientX-t[1].clientX)+(t[0].clientY-t[1].clientY)*(t[0].clientY-t[1].clientY))}r=!0;const s=Math.round(this.position.z),d=o(e),c=e=>{t(e);const n=this.position.z/100,a=o(e),r=Math.ceil(this.scaleOrMin(Math.min(this.maxZoom,s*(a/d))))/100,l=i.getBoundingClientRect(),c=function(e){const t={x:0,y:0};if("touchstart"===e.type||"touchmove"===e.type||"touchend"===e.type){const i=e.touches[0]||e.changedTouches[0];t.x=i.pageX,t.y=i.pageY}else"mousedown"!==e.type&&"mouseup"!==e.type&&"mousemove"!==e.type||(t.x=e.pageX,t.y=e.pageY);return t}(e),h=c.y-l.top;let u=c.x-l.left,m=0;if("split"!==this.layout){const e=this.mediaOrder.map((e=>this.mediaVisibility[`${e}`])).filter((e=>!!e)),t=l.width/e.length;for(;m<e.length&&!(t*(m+1)>u);)m+=1;u=c.x-t*m}const p=(u-this.position.x)/n,g=(h-this.position.y)/n,b=p+(u-p)-p*r,f=g+(h-g)-g*r;this.updateXYZ(b,f,100*r)},h=e=>{t(e),n.removeEventListener("touchmove",c),document.removeEventListener("touchend",h),r=!1};n.addEventListener("touchmove",c),document.addEventListener("touchend",h)}),this.query.mediaContainer),e(this,"appfocus",(e=>{t(e),this.focus()}));e(this,"keydown",(e=>{if((e=>e.path&&("INPUT"===e.path[0].tagName||"TEXTAREA"===e.path[0].tagName)||e.originalTarget&&("INPUT"===e.originalTarget.tagName||"TEXTAREA"===e.originalTarget.tagName))(e))return;const i=(e.ctrlKey&&!U||e.metaKey&&U)&&"z"===e.key;var n;if("Space"!==e.code||!this.hasVideo||this.disableTimeControls||(n=this.shadowRoot.getElementById("embed-overlay"))&&n.visible||(t(e),this.shouldPlay=!this.playing,this.playing=!this.playing),"KeyP"===e.code&&(t(e),this.speed=1),"BracketLeft"===e.code&&(t(e),this.speed=Math.max(this.speed-.25,.25)),"BracketRight"===e.code&&(t(e),this.speed=Math.min(this.speed+.25,1)),"ArrowRight"===e.code&&(t(e),this.setCurrentTime(this.time+L(this.fps),!0)),"ArrowLeft"===e.code&&(t(e),this.setCurrentTime(this.time-L(this.fps),!0)),"0"===e.key&&(t(e),this.setCurrentTime(this.startTime,!0)),"Digit1"===e.code&&(t(e),this.layout=R[0]),"Digit2"===e.code&&(t(e),this.layout=R[1]),"KeyF"===e.code&&e.ctrlKey&&(t(e),this.fullscreen=!this.fullscreen),i&&(t(e),this.undo()),"KeyR"===e.code&&e.ctrlKey){const e=window.NvCompareApi;e&&e.deleteAllTmpFiles(),window.location.reload()}}),this.query.container),e(this,"add-media-to-current-set",(e=>{t(e),this.updateCurrentSet();const i=e.detail.media,n=e.detail.index,o=B.getUrl(this.mediaFiles[i.id],i.src||i.mediaName.path),s=a(),r={id:s,src:o,name:i.mediaName.name,base:i.mediaName.base,extension:i.mediaName.extension,type:i.metadata.type,fps:i.metadata.fps,variableFrameRate:i.metadata.variableFrameRate,duration:i.metadata.duration,thumbnails:i.mediaThumbnails.slice(),width:i.metadata.width,height:i.metadata.height,path:i.mediaName.path,x:i.mediaPosition.x,y:i.mediaPosition.y,z:i.mediaPosition.z,startTime:i.mediaStartTime,intialMediaTime:0,timeOffset:0,codec:i.metadata.codec,bitrate:i.metadata.bitrate,format:i.metadata.format,file:this.mediaFiles[i.id],size:i.metadata.size,modified:i.metadata.modified};this.addMedia(s,r,n)})),e(this,"add-filter",(e=>{t(e),this.addShader(e.detail)})),e(this,"show-thumbnails",(e=>{t(e),this.showThumbnails=e.detail})),this.query.container.focus(),B.clearCache()}function H(e){return!(!0!==e&&"true"!==e)}function $(e){return!(!1===e||"false"===e)}function _(e){return function(t){if(!Number.isNaN(t)&&"string"!=typeof t)return t;const i=parseFloat(t);return Number.isNaN(i)||"string"==typeof i?e:i}}function q(e,t){return function(i,n){return e.indexOf(i)>-1?i:void 0!==t?t:n&&void 0!==n.value?n.value:e[0]}}const G={activeSet:{onChange(e){this.query.contentSidebar.activeSet=e}},adjustedDuration:{attribute:!1,formatter:_(0),onChange(){this.setDurationString()}},adjustedTime:{attribute:!1,formatter:_(0),onChange(){this.setTimeString()}},antiAlias:{formatter:H,onChange(e){this.query.playbackControls.antiAlias=e}},boomerang:{formatter:H,onChange(e){this.query.playbackControls.boomerang=e}},boomerangDirection:{formatter:_(1)},muteState:{onChange(e){this.query.playbackControls.muteState=e}},disableReorder:{attribute:!1,formatter:H,onChange(){this.updateMediaInfo()}},disableTimeControls:{attribute:!1,formatter:H},duration:{formatter:_(0),onChange(e){this.setAdjustedTime(),this.setDurationString(),this.query.playbackControls.duration=e,this.dispatchEvent(new CustomEvent("icatdurationupdate",{bubbles:!0,composed:!0,detail:this.duration}))}},durationString:{attribute:!1},endTime:{formatter:_(0),onChange(e){this.setAdjustedTime(),this.setEndTimeString(),this.startEndUpdate(),this.query.playbackControls.endTime=e,this.dispatchEvent(new CustomEvent("icatendtimeupdate",{bubbles:!0,composed:!0,detail:this.endTime}))}},endTimeString:{attribute:!1},exposure:{formatter:_(1)},fitScale:{formatter:_(100),onChange(e){this.query.playbackControls.fitScale=e}},fps:{formatter:_(0),onChange(e){this.setAdjustedTime(),this.setDurationString(),this.setEndTimeString(),this.setStartTimeString(),this.setTimeString(),this.query.playbackControls.fps=e,this.dispatchEvent(new CustomEvent("icatfpsupdate",{bubbles:!0,composed:!0,detail:this.fps}))}},fullscreen:{formatter:H,onChange(e){if(e)"function"==typeof this.requestFullscreen&&this.requestFullscreen();else{if(null===document.fullscreenElement)return;"function"==typeof document.exitFullscreen&&document.exitFullscreen()}this.focus()}},gamma:{formatter:_(1)},grid:{formatter:_(0),onChange(e){this.query.playbackControls.grid=e}},hasMedia:{attribute:!1},hasShownResolutionMessage:{formatter:H,attribute:!1},hasVideo:{formatter:H,attribute:!1},layout:{formatter:q(R,R[0]),onChange(){this.setSplit()}},logos:{onChange(e){this.updateLogos(),this.query.playbackControls.overlays=e}},looping:{formatter:H,onChange(e){this.query.playbackControls.looping=e}},maxHeight:{formatter:_(0),attribute:!1},maxWidth:{formatter:_(0),attribute:!1},mediaLabels:{},mediaMetadata:{onChange(e){this.refreshMedia(),this.updatePlayers(),this.updateMediaInfo(),this.query.playbackControls.mediaMetadata=e}},mediaNames:{onChange(e){this.updateMediaInfo(),this.query.playbackControls.mediaNames=e}},mediaOrder:{onChange(e){this.updatePlayers(),this.updateMediaInfo(),this.setSplit(),this.query.playbackControls.mediaOrder=e,this.emptySet=0===e.length}},mediaPositions:{},mediaStartTimes:{onChange(e){this.query.playbackControls.mediaStartTimes=e}},mediaVisibility:{onChange(e){this.updatePlayers(),this.updateMediaInfo(),this.setSplit(),this.query.playbackControls.mediaVisibility=e,this.dispatchEvent(new CustomEvent("icatmediavisibilityupdate",{bubbles:!0,composed:!0,detail:this.mediaVisibility}))}},overlayVisibility:{onChange(e){this.updateLogos(),this.query.playbackControls.overlayVisibility=e,this.dispatchEvent(new CustomEvent("icatoverlayvisibilityupdate",{bubbles:!0,composed:!0,detail:this.overlayVisibility}))}},message:{},minScale:{formatter:_(100),onChange(e){this.query.playbackControls.minScale=e}},playing:{formatter:H,onChange(e,t){t.isInitial||(e&&this.hasVideo?this.play():this.pause(),this.dispatchEvent(new CustomEvent("icatplayingupdate",{bubbles:!0,composed:!0,detail:this.playing})))}},position:{formatter:e=>e?{x:parseInt(e.x,10),y:parseInt(e.y,10),z:parseInt(e.z,10)}:{x:0,y:0,z:100},onChange(e){this.query.playbackControls.zoom=(e||{}).z||100}},quickTimeUpdate:{formatter:H},sets:{onChange(e){this.query.contentSidebar.sets=e}},shaderSources:{},shaderInputs:{},shaderUiSettings:{},showSpinner:{formatter:H},showSplit:{formatter:H},speed:{formatter:_(1),onChange(e){this.query.playbackControls.speed=e}},spinnerMessage:{},splitposition:{formatter:_(.5),onChange(){this.setSplit(),this.dispatchEvent(new CustomEvent("icatsplitpositionupdate",{bubbles:!0,composed:!0,detail:this.startTime}))}},startTime:{formatter:_(0),onChange(e){this.setAdjustedTime(),this.setStartTimeString(),this.startEndUpdate(),this.query.playbackControls.startTime=e,this.dispatchEvent(new CustomEvent("icatstarttimeupdate",{bubbles:!0,composed:!0,detail:this.startTime}))}},startTimeString:{attribute:!1},time:{formatter:_(0),onChange(e){this.setAdjustedTime(),this.setTimeString(),this.query.playbackControls.time=e,this.dispatchEvent(new CustomEvent("icattimeupdate",{bubbles:!0,composed:!0,detail:this.time}))}},timeString:{attribute:!1},uiVisibility:{onChange(e){this.query.contentSidebar.uiVisibility=e,this.query.playbackControls.uiVisibility=e,e&&(!0===e.layoutTabs?(this.query.layoutBtnTile.style.removeProperty("display"),this.query.layoutBtnSplit.style.removeProperty("display")):!1===e.layoutTabs&&(this.query.layoutBtnTile.style.display="none",this.query.layoutBtnSplit.style.display="none"),!0===e.appSettingsBtn?this.query.appSettingsBtn.style.removeProperty("display"):!1===e.appSettingsBtn&&(this.query.appSettingsBtn.style.display="none"),!0===e.helpButton?this.query.helpBtn.style.removeProperty("display"):!1===e.helpButton&&(this.query.helpBtn.style.display="none"))}},viewportWidth:{formatter:_(0),attribute:!1},viewportHeight:{formatter:_(0),attribute:!1},mediaThumbnails:{onChange(e){this.query.playbackControls.mediaThumbnails=e}},isembed:{formatter:$,onChange(e){this.query.topBar.isEmbed=e}},emptySet:{formatter:$}};function W(e=""){return e.split(/\\|\//).pop()||""}class Y{buffer;bitSize=0;bitPointer=0;bytePointer=0;offset=0;view;littleEndian=!1;constructor(e,t={offset:0,littleEndian:!0}){this.buffer=e,this.bitSize=8*e.byteLength,this.offset=void 0===t.offset?0:t.offset,this.littleEndian=void 0===t||void 0===t.littleEndian||t.littleEndian,this.view=new DataView(this.buffer,t.offset)}shrinkWrap(){let e=this.bytePointer+(this.bitPointer>0?1:0),t=new Uint8Array(new ArrayBuffer(e));for(let i=0;i<e;i++)t[i]=this.view.getUint8(i);this.bitSize=8*e,this.buffer=t.buffer}consume(e,t){for(let i=0;i<t;i++)this.writeUint8(e.readUint8())}copyArray(e,t=0,i=e.length){for(let n=0;n<i;n++)this.writeUint8(e[t+n])}copy(e,t=0,i=e.buffer.byteLength){for(let n=0;n<i;n++)this.setUint8(t+n,e.getUint8(n))}byteAlign(){this.bitPointer>0&&(this.bitPointer=0,this.bytePointer++)}remainingBits(){return this.bitSize-(8*this.bytePointer+this.bitPointer)}readBits(e,t=!1){let i=0,n=e,a=this.bytePointer,o=this.bitPointer,s=this.remainingBits();n>s&&(n=s);let r=o+n,l=Math.min(r-1,7);for(i=Y.bits(this.view.getUint8(a,this.littleEndian),l,o),n-=l-o+1,o=r,r>7&&(o=0,a++);n>8;)i|=this.view.getUint8(a,this.littleEndian)<<e-n,a++,n-=8;return n>0&&(i|=(this.view.getUint8(a,this.littleEndian)&(1<<n)-1)<<e-n,o+=n),t||(this.bytePointer=a,this.bitPointer=o),i}seek(e,t=0){this.bytePointer=e,this.bitPointer=t}skip(e=1,t=0){this.bitPointer+=8*e+t,this.bytePointer+=Math.floor(this.bitPointer/8),this.bitPointer%=8}static bits(e,t,i){return(e&(1<<t+1)-1)>>i}static halfBytes2Float32(e){var t=32768&e?-1:1,i=(e>>10&31)-15,n=1023&e;if(16==i)return t*(n?Number.NaN:Number.POSITIVE_INFINITY);if(-16==i){if(0==n)return 0*t;i=-16,n/=1<<22}else n=(1024|n)/1024;return t*n*Math.pow(2,i)}static floatBytes2Float32(e){var t=2147483648&e?-1:1,i=(e>>23&255)-127,n=8388607&e;if(128==i)return t*(n?Number.NaN:Number.POSITIVE_INFINITY);if(-127==i){if(0==n)return 0*t;i=-126,n/=1<<22}else n=(n|1<<23)/(1<<23);return t*n*Math.pow(2,i)}peekUint8(e=this.bytePointer){return this.view.getUint8(e)}readUint8(){return this.view.getUint8(this.bytePointer++)}writeUint8(e){this.view.setUint8(this.bytePointer++,e)}getUint8(e){return this.view.getUint8(e)}setUint8(e,t){this.view.setUint8(e,t)}getInt8(e){return this.view.getInt8(e)}peekUint16(e=this.bytePointer){return this.view.getUint16(e,this.littleEndian)}readUint16(){let e=this.view.getUint16(this.bytePointer,this.littleEndian);return this.bytePointer+=2,e}writeUint16(e){this.view.setUint16(this.bytePointer,e,this.littleEndian),this.bytePointer+=2}getUint16(e){return this.view.getUint16(e,this.littleEndian)}setUint16(e,t){this.view.setUint16(e,t,this.littleEndian)}readUint32(){let e=this.view.getUint32(this.bytePointer,this.littleEndian);return this.bytePointer+=4,e}writeUint32(e){this.view.setUint32(this.bytePointer,e,this.littleEndian),this.bytePointer+=4}writeInt32(e){this.view.setInt32(this.bytePointer,e,this.littleEndian),this.bytePointer+=4}readInt32(){let e=this.view.getInt32(this.bytePointer,this.littleEndian);return this.bytePointer+=4,e}getUint32(e){return this.view.getUint32(e,this.littleEndian)}setUint32(e,t){this.view.setUint32(e,t,this.littleEndian)}readUint64(){let e=this.view.getBigUint64(this.bytePointer,this.littleEndian);return this.bytePointer+=8,e}readFloat32(){let e=this.view.getFloat32(this.bytePointer,this.littleEndian);return this.bytePointer+=4,e}writeFloat32(e){this.view.setFloat32(this.bytePointer,e,this.littleEndian),this.bytePointer+=4}getFloat32(e){return this.view.getFloat32(e,this.littleEndian)}setFloat32(e,t){this.view.setFloat32(e,t,this.littleEndian)}readFloat16(e=this.bytePointer){let t=Y.halfBytes2Float32(this.view.getUint16(e,this.littleEndian));return this.bytePointer+=2,t}getFloat16(e){let t=this.view.getUint16(e,this.littleEndian);return Y.halfBytes2Float32(t)}readString(){let e=this.readUint8(),t="";for(;0!=e;)t+=String.fromCharCode(e),e=this.readUint8();return t}writeString(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t))}readLine(){let e=String.fromCharCode(this.readUint8()),t="";for(;"\n"!=e&&"\r"!=e;)t+=e,e=String.fromCharCode(this.readUint8());return t}}const X=10,j=1024,Z=[257,1,4],K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],te=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];class ie{bSuccess=!0;buffer;outputBuffer;attributes={};offsetTable=[];scanLinesPerChunk=1;pixelSize=0;channelOffsets=[];dimensions={w:0,h:0};huffman={tableSizes:new Array(3).fill(0),lengthCodes:new Array(457).fill(0),tables:[]};constructor(e){this.buffer=new Y(e);let t=this.buffer;for(t.readInt32(),t.readInt32();0!=t.peekUint8();){let e=this.readAttribute();this.attributes[e.name]=e}t.skip();let i=this.attributes.dataWindow.values,n=i.yMax-i.yMin+1,a=this.attributes.compression.value;if(0!==a&&3!==a)return console.warn("EXR compression method not implemented!"),void(this.bSuccess=!1);3===a&&(this.scanLinesPerChunk=16),0!==a&&(n=Math.floor(n/this.scanLinesPerChunk)+(n%this.scanLinesPerChunk>0?1:0));for(let e=0;e<n;e++){let i=t.readUint64();this.offsetTable.push({offset:i}),e>0&&(this.offsetTable[e-1].size=i-this.offsetTable[e-1].offset)}n>1&&(this.offsetTable[n-1].size=(t.bitSize>>3)-Number(this.offsetTable[n-1].offset));for(let e=0;e<this.attributes.channels.values.length;e++){let t=this.attributes.channels.values[e];switch(this.channelOffsets.push(this.pixelSize),t.pixelType){case 0:case 2:default:this.pixelSize+=4;break;case 1:this.pixelSize+=2}}let o=this.attributes.dataWindow.values;this.dimensions.w=o.xMax-o.xMin+1,this.dimensions.h=o.yMax-o.yMin+1;let s=this.dimensions.w*this.dimensions.h*this.pixelSize;this.outputBuffer=new Y(new ArrayBuffer(s));let r=this.attributes.channels.values;if(0!=a)if(3!==a);else{for(let e=0;e<3;e++)this.huffman.tables.push({codeSize:new Array(288).fill(0),lookUp:new Array(j).fill(0),tree:new Array(576).fill(0)});for(let e=0;e<n;e++){t.seek(Number(this.offsetTable[e].offset)),t.readUint32(),t.readUint32();const i={};let n=t.readUint8(),a=t.readUint8();i.cmf={},i.cmf.cm=Y.bits(n,3,0),i.cmf.info=Y.bits(n,7,4),i.flg={},i.flg.fcheck=Y.bits(a,4,0),i.flg.fdict=Y.bits(a,5,5),i.flg.flevel=Y.bits(a,7,6),i.dictId=1==i.flg.fdict?t.readUint32():void 0;let o=!1;do{o=1==t.readBits(1);let e=t.readBits(2);if(0==e){t.byteAlign();let e=t.readBits(8)|t.readBits(8)<<8;e!=(65535^(t.readBits(8)|t.readBits(8)<<8))&&console.warn("ERROR: Raw block header LEN/NLEN mismatch!"),this.outputBuffer.consume(t,e);continue}3==e&&console.warn("ERROR: Reserved block type (3)");let i=0;if(1==e||2==e){for(let e=0;e<3;e++)this.huffman.tables[e].codeSize.fill(0),this.huffman.tables[e].lookUp.fill(0),this.huffman.tables[e].tree.fill(0);if(1==e)console.warn("TODO: handle blocks compressed with fixed Huffman codes");else{this.huffman.tableSizes=[t.readBits(5)+Z[0],t.readBits(5)+Z[1],t.readBits(4)+Z[2]];for(let e=0;e<this.huffman.tableSizes[2];e++)this.huffman.tables[2].codeSize[K[e]]=t.readBits(3);this.huffman.tableSizes[2]=19}let n=new Array(17),a=new Array(16);for(let o=e;o>=0;o--){let e=this.huffman.tables[o];a.fill(0);for(let t=0;t<this.huffman.tableSizes[o];t++)a[e.codeSize[t]]++;let s=0,r=0;n[0]=0,n[1]=0;for(let e=1;e<=15;e++)r+=a[e],s=s+a[e]<<1,n[e+1]=s;65536!=s&&r>1&&console.warn("ERROR: Huffman table generation (1)");let l=-1;for(let t=0;t<this.huffman.tableSizes[o];t++){let i=e.codeSize[t];if(0==i)continue;let a=n[i]++,o=0;for(let e=i;e>0;e--)o=o<<1|1&a,a>>=1;if(i<=X){let n=i<<9|t;for(;o<j;)e.lookUp[o]=n,o+=1<<i;continue}let s=e.lookUp[1023&o];0==s&&(e.lookUp[1023&o]=l,s=l,l-=2),o>>=9;for(let t=i;t>11;t--)s-=1&(o>>=1),e.tree[-s-1]?s=e.tree[-s-1]:(e.tree[-s-1]=l,s=l,l-=2);s-=1&(o>>=1),e.tree[-s-1]=t}if(2==o){let e=0;for(i=0;i<this.huffman.tableSizes[0]+this.huffman.tableSizes[1];){if(e=this.huffmanDecode(t,2),e<16){this.huffman.lengthCodes[i++]=e;continue}16!=e||i||console.warn("ERROR: Huffman table generation (2)");let n=[2,3,7][e-16],a=t.readBits(n);a+=[3,3,11][e-16];for(let t=0;t<a;t++)this.huffman.lengthCodes[i+t]=16==e?this.huffman.lengthCodes[i-1]:0;i+=a}this.huffman.tableSizes[0]+this.huffman.tableSizes[1]!=i&&console.warn("ERROR: Huffman table generation (3)"),this.huffman.tables[0].codeSize=this.huffman.lengthCodes.slice(0,this.huffman.tableSizes[0]),this.huffman.tables[1].codeSize=this.huffman.lengthCodes.slice(this.huffman.tableSizes[0],this.huffman.tableSizes[0]+this.huffman.tableSizes[1])}}}for(;;){for(;;)if(t.remainingBits()<32||this.outputBuffer.remainingBits()<16){if(i=this.huffmanDecode(t,0),i>=256)break;this.outputBuffer.bytePointer>=this.outputBuffer.buffer.byteLength&&console.warn("Attempting to write outside output buffer!"),this.outputBuffer.writeUint8(i)}else{let e=this.huffmanDecode(t,0,!0);if(i=e,256&i)break;if(e=this.huffmanDecode(t,0,!0),this.outputBuffer.writeUint8(255&i),256&e){i=e;break}this.outputBuffer.writeUint8(255&e)}if(256==(i&=511))break;let e=Q[i-257];if(i=J[i-257],e){i+=t.readBits(e)}let n=this.huffmanDecode(t,1);if(e=te[n],n=ee[n],e>0){n+=t.readBits(e)}let a=this.outputBuffer.bytePointer,o=a-n;if(Math.max(this.outputBuffer.bytePointer,o)>this.outputBuffer.buffer.byteLength-1)for(;i--;)this.outputBuffer.writeUint8(this.outputBuffer.peekUint8(a-n)),a++;else{t.remainingBits();do{this.outputBuffer.writeUint8(this.outputBuffer.peekUint8(o+0)),this.outputBuffer.writeUint8(this.outputBuffer.peekUint8(o+1)),this.outputBuffer.writeUint8(this.outputBuffer.peekUint8(o+2)),o+=3}while((i-=3)>2);i>0&&(this.outputBuffer.writeUint8(this.outputBuffer.peekUint8(o)),i>1&&this.outputBuffer.writeUint8(this.outputBuffer.peekUint8(o+1)))}}}while(!o)}let e=Math.round(this.dimensions.h/this.scanLinesPerChunk),i=this.dimensions.h%this.scanLinesPerChunk*this.dimensions.w*this.pixelSize,a=this.scanLinesPerChunk*this.dimensions.w*this.pixelSize,o=new Y(new ArrayBuffer(a));for(let t=0;t<e;t++){let n=t*a,s=t==e-1&&i>0?i:a,r=Math.floor((s+1)/2);for(let e=n+1;e<n+s;e++){let t=this.outputBuffer.getUint8(e-1)+this.outputBuffer.getUint8(e)-128;this.outputBuffer.setUint8(e,t)}let l=n;for(let e=0;e<s;e+=2){let t=this.outputBuffer.getUint8(l),i=this.outputBuffer.getUint8(l+r);o.setUint8(e,t),o.setUint8(e+1,i),l++}this.outputBuffer.copy(o,n,s)}}else for(let e=0;e<n;e++){t.seek(Number(this.offsetTable[e].offset)),t.readUint32(),t.readUint32();for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<this.dimensions.w;e++)(0==i.pixelType||2==i.pixelType||1==i.pixelType)&&this.outputBuffer.writeUint16(t.readUint16())}}}huffmanDecode(e,t,i=!1){let n=this.huffman.tables[t],a=0;e.remainingBits();let o=e.readBits(X,!0),s=n.lookUp[o];if(s>=0)a=s>>9,i||(s&=511);else{a=X,o=e.readBits(15,!0);do{s=n.tree[~s+(o>>a++&1)]}while(s<0)}let r=s;return e.skip(0,a),r}readAttribute(){let e=this.buffer;const t={name:e.readString(),type:e.readString(),size:e.readInt32()};if("box2i"==t.type&&(t.values={xMin:e.readInt32(),yMin:e.readInt32(),xMax:e.readInt32(),yMax:e.readInt32()}),"box2f"==t.type&&(t.values={xMin:e.readFloat32(),yMin:e.readFloat32(),xMax:e.readFloat32(),yMax:e.readFloat32()}),"chlist"==t.type){for(t.values=[];0!=e.peekUint8();){let i=e.readString(),n=e.readInt32(),a=e.readUint8();e.skip(3);let o={name:i,pixelType:n,pLinear:a,xSampling:e.readInt32(),ySampling:e.readInt32()};t.values.push(o)}e.skip()}if("chromaticities"==t.type&&(t.values={redX:e.readFloat32(),redY:e.readFloat32(),greenX:e.readFloat32(),greenY:e.readFloat32(),blueX:e.readFloat32(),blueY:e.readFloat32(),whiteX:e.readFloat32(),whiteY:e.readFloat32()}),"compression"==t.type&&(t.value=e.readUint8()),t.type,t.type,"float"==t.type&&(t.value=e.readFloat32()),"int"==t.type&&(t.value=e.readUint32()),t.type,"lineOrder"==t.type&&(t.value=e.readUint8()),t.type,"m44f"==t.type){t.values=[];for(let i=0;i<4;i++)for(let i=0;i<4;i++)t.values.push(e.readFloat32())}return t.type,t.type,t.type,t.type,t.type,t.type,"v2i"==t.type&&(t.values={x:e.readInt32(),y:e.readInt32()}),"v2f"==t.type&&(t.values={x:e.readFloat32(),y:e.readFloat32()}),t.type,t.type,t}toFloatArray(){let e=new Float32Array(new ArrayBuffer(this.dimensions.w*this.dimensions.h*4*4));const t={R:0,G:1,B:2,A:3};let i=this.attributes.channels.values;for(let n=0;n<this.dimensions.h;n++)for(let a=0;a<this.dimensions.w;a++){let o=4*(n*this.dimensions.w+a);for(let s=0;s<i.length;s++){let r=i[s];const l=r.name;let d=this.channelOffsets[s],c=1==r.pixelType?2:4,h=(n*this.pixelSize+d)*this.dimensions.w+a*c,u=0;u=0==r.pixelType?this.outputBuffer.getUint32():1==r.pixelType?this.outputBuffer.getFloat16(h):this.outputBuffer.getFloat32(h),e[o+t[`${l}`]]=u}e[o+t.A]=1}return e}}class ne{buffer;data;type;dimensions={w:0,h:0};scaleEndianess;littleEndian;constructor(e){this.buffer=new Y(e),this.type=this.buffer.readLine();const t=this.buffer.readLine().split(" ");this.dimensions={w:parseInt(t[0],10),h:parseInt(t[1],10)},this.scaleEndianess=parseFloat(this.buffer.readLine()),this.littleEndian=this.scaleEndianess<0,this.buffer.littleEndian=this.littleEndian;if(this.data=new Float32Array(new ArrayBuffer(this.dimensions.w*this.dimensions.h*4*4)),"PF"==this.type)for(let e=0;e<this.dimensions.h;e++)for(let t=0;t<this.dimensions.w;t++){let i=4*((this.dimensions.h-e-1)*this.dimensions.w+t);this.data[i+0]=this.buffer.readFloat32(),this.data[i+1]=this.buffer.readFloat32(),this.data[i+2]=this.buffer.readFloat32(),this.data[i+3]=1}else if("PF4"==this.type)for(let e=0;e<this.dimensions.h;e++)for(let t=0;t<this.dimensions.w;t++){let i=4*((this.dimensions.h-e-1)*this.dimensions.w+t);this.data[i+0]=this.buffer.readFloat32(),this.data[i+1]=this.buffer.readFloat32(),this.data[i+2]=this.buffer.readFloat32(),this.data[i+3]=this.buffer.readFloat32()}else for(let e=0;e<this.dimensions.h;e++)for(let t=0;t<this.dimensions.w;t++){let i=4*((this.dimensions.h-e-1)*this.dimensions.w+t),n=this.buffer.readFloat32();this.data[i+0]=n,this.data[i+1]=n,this.data[i+2]=n,this.data[i+3]=1}}toFloatArray(){return this.data}}function ae(e,t=""){return!t||"pfm"!==t&&"exr"!==t?Promise.reject("Error reading file"):"string"==typeof e?fetch(e).then((async i=>{if(!i.ok)throw new Error(`Error getting media ${e}`);const n=await i.arrayBuffer();if("pfm"===t)return new ne(n);if("exr"===t)return new ie(n);throw new Error(`Invalid media: ${e}`)})):new Promise(((i,n)=>{const a=new FileReader;a.onload=()=>{return e=a.result,void i("pfm"===t?new ne(e):new ie(e));var e},a.onerror=()=>n("Error reading file"),a.readAsArrayBuffer(e)}))}const oe=15,se=100;function re(e,t){if(!e||!t)return t;t.width=e.dimensions.w,t.height=e.dimensions.h;const i=t.getContext("2d"),n=i.getImageData(0,0,t.width,t.height);return((e,t)=>{let i=e.byteLength>>2;for(var n=0;n<i;n+=1)t[n]=255*e[n]})(e.toFloatArray(),n.data),i.putImageData(n,0,0),t}function le(e,t,i,n,a,o){let s=!1;return(async()=>{if(!t)return o();const r="pfm"===n||"exr"===n;let l,d,c=document.createElement("canvas").getContext("2d"),h=B.getUrl(t,t);const u=()=>{d&&(d.onerror=null,d.src="",d=null),URL.revokeObjectURL(h),h=null,c=null,l=null,B.clearCache()};if(r&&(l=await ae(t,n)),s)return o();if("video"!==i){let t=await async function(e,t,i){return e&&t?i?(re(i,t.canvas),Promise.resolve(t.canvas.toDataURL("image/png"))):new Promise((i=>{let n=new Image;n.onload=()=>{if(!n)return i("");const e=n.height*(se/n.width);t.canvas.width=se,t.canvas.height=e,t.drawImage(n,0,0,se,e),requestAnimationFrame((()=>{i(t.canvas.toDataURL("image/png")),n&&(n.src=""),n=null}))},n.src=e})):Promise.reject()}(h,c,l);return B.isElectron&&(t=B.pathToElectronUrl(await window.NvCompareApi.createFile(`${e}_thumb_0.png`,t))),a(new Array(oe).fill(t)),o(),u()}d=document.createElement("video"),d.muted=!0,d.onerror=u;const m=function(e,t,i,n,a,o){let s=!1;const r=[];let l=0;return(()=>{let d=!1;const c=async()=>{if(s)return;d=!0;const i=(t.videoHeight||t.height)*(se/(t.videoWidth||t.width)),h=t.duration/oe;n.canvas.width=se,n.canvas.height=i,n.drawImage(t,0,0,se,i);let u=n.canvas.toDataURL("image/png");if(B.isElectron&&(u=B.pathToElectronUrl(await window.NvCompareApi.createFile(`${e}_thumb_${l}.png`,u))),r.push(u),a(r.slice()),l+=1,t.onseeked=c,l<oe&&""!==t.src)return requestAnimationFrame((()=>{""!==t.src&&(t.currentTime=h*l)}));t.onseeked=null,o()},h=()=>{if(!d&&!s)return 4===t.readyState&&t.videoHeight&&t.videoWidth?c():requestAnimationFrame(h)};t.playsInline=!0,t.preload="auto",t.src=i,t.currentTime=1e-4,h()})(),()=>{s=!0}}(e,d,h,c,(e=>{if(s)return m(),o();a(e)}),(()=>{o(),u()}))})(),()=>{s=!0}}function de(...e){const t=arguments,i=t.length;return function(e){let n=i,a=e;for(;n;)a="function"!=typeof t[i-n]?a:t[i-n](a),n-=1;return a}}function ce(e,t){if(!e||!t)return!1;const i=t.composedPath()[0];if(!i)return!1;if(e===i||e.contains(i)||e.shadowRoot&&e.shadowRoot.contains(i))return!0;const n=i.getRootNode();if(!n)return!1;const a=n.host;return!!a&&(e===a||e.contains(a)||e.shadowRoot&&e.shadowRoot.contains(a))}var he='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6"/></svg>';const ue=["in","out"],me=["video"],pe=["image","cog","wand","cards","close","speaker","speaker-off","speaker-medium","speaker-mute","eye","eye-off","layout-detail","help-circle","plus","minus","export","floppy","folder-open","eyedropper","magnifying-glass","play","pause","first-frame","last-frame","next-frame","previous-frame","loop","chevron-up","chevron-down","chevron-down-select","chevron-right","chevron-left","mirror","sticker","shader"],ge={circle:{formatter:H},widecircle:{formatter:H},type:{onChange(){this.setSvg()}}},be=x(ge),fe=w('<div id="icon-element-container" bind-attr-type="data-type" bind-attr-widecircle="data-wide-circle" bind-attr-circle="data-circle"></div>',"#icon-element-container{align-items:center;box-sizing:border-box;display:flex;height:1em;justify-content:center;transition:color .2s;width:1em}#icon-element-container svg{fill:currentColor;height:100%;width:100%}#icon-element-container[data-circle=true]{border-radius:50%;box-shadow:inset 0 0 0 1px;height:1.5em;padding:.33em;width:1.5em}#icon-element-container[data-wide-circle=true]{border-radius:50%;box-shadow:inset 0 0 0 1px;height:1.75em;padding:.5em;width:1.75em}#icon-element-container[data-type=crosshair]{font-size:110%}#icon-element-container[data-type=play][data-circle=true] svg,#icon-element-container[data-type=play][data-wide-circle=true] svg{left:.1em;position:relative}#icon-element-container[data-type=check]{width:1.2em}#icon-element-container[data-type=loop]{height:1.15em;width:1.15em}#icon-element-container[data-type=loop][data-circle=true]{height:1.65em;width:1.65em}#icon-element-container[data-type=loop][data-wide-circle=true]{height:1.9em;width:1.9em}#icon-element-container[stroke-icon=true] svg{fill:none;stroke:currentColor;stroke-width:1px}#icon-element-container[stroke-icon=true] svg path{stroke:currentColor}#icon-element-container[fill-icon=true] svg,#icon-element-container[no-style-icon=true] svg{fill:unset;stroke:unset;stroke-width:unset}#icon-element-container[fill-icon=true] svg path{fill:currentColor}");E("icon-element",class extends v{static get observedAttributes(){return be}_stateConfigs=ge;circle=!1;widecircle=!1;type="";constructor(){super(),C(this,fe)}container(){return this.shadowRoot.getElementById("icon-element-container")}#e(){this.container().setAttribute("stroke-icon",(pe.indexOf(this.type)>-1).toString()),this.container().setAttribute("no-style-icon",(ue.indexOf(this.type)>-1).toString()),this.container().setAttribute("fill-icon",(me.indexOf(this.type)>-1).toString())}setSvg(){var e;this.container().innerHTML=(e=this.type)?"nvidia"===e?'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 30 20" style="enable-background:new 0 0 30 20;" xml:space="preserve"><path d="M11.3,6V4.2c0.2,0,0.4,0,0.5,0C16.8,4,20,8.4,20,8.4s-3.5,4.9-7.3,4.9c-0.5,0-1-0.1-1.5-0.2V7.5c1.9,0.2,2.3,1.1,3.5,3\n\tl2.6-2.2c-1.2-1.5-3.1-2.4-5-2.5C11.9,5.9,11.6,5.9,11.3,6 M11.3,0v2.7c0.2,0,0.4,0,0.5,0c6.9-0.2,11.3,5.6,11.3,5.6\n\ts-5.1,6.3-10.5,6.3c-0.5,0-0.9,0-1.4-0.1v1.7c0.4,0,0.8,0.1,1.2,0.1c5,0,8.6-2.5,12.1-5.6c0.6,0.5,2.9,1.6,3.4,2.1\n\tc-3.3,2.8-11.1,5-15.4,5c-0.4,0-0.8,0-1.2-0.1V20h18.9V0L11.3,0z M11.3,13v1.4c-4.6-0.8-5.9-5.6-5.9-5.6C7,7.2,9,6.2,11.3,6v1.6h0\n\tc-1.3,0-2.6,0.6-3.4,1.6C7.8,9.1,8.7,12.1,11.3,13 M3.1,8.6c2-2.6,5-4.2,8.2-4.4V2.7C5.2,3.2,0,8.3,0,8.3s3,8.6,11.3,9.4v-1.6\n\tC5.2,15.3,3.1,8.6,3.1,8.6L3.1,8.6z"/></svg>':"layout-detail"===e?'<svg width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 0.5V6M4.5 6V11.5M4.5 6H11.5M0.5 0.5H11.5V11.5H0.5V0.5Z"/></svg>':"cog"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.87309 4.36418L5.30059 5.04816C5.7245 4.66028 6.23225 4.36251 6.79349 4.18517L6.91489 2.60702C7.2657 2.53682 7.62856 2.5 8.00002 2.5C8.3715 2.5 8.73438 2.53683 9.0852 2.60703L9.2066 4.1852C9.76782 4.36254 10.2755 4.66031 10.6994 5.04818L12.127 4.36419C12.6048 4.90622 12.9776 5.54313 13.2134 6.24304L11.9068 7.13765C11.9678 7.41538 12 7.70394 12 8C12 8.29606 11.9678 8.58461 11.9068 8.86234L13.2134 9.75695C12.9776 10.4569 12.6049 11.0938 12.127 11.6358L10.6994 10.9518C10.2755 11.3397 9.76782 11.6375 9.2066 11.8148L9.0852 13.393C8.73438 13.4632 8.3715 13.5 8.00002 13.5C7.62856 13.5 7.2657 13.4632 6.91489 13.393L6.79349 11.8148C6.23224 11.6375 5.72449 11.3397 5.30058 10.9518L3.87308 11.6358C3.39519 11.0938 3.02241 10.4569 2.78662 9.75697L4.0932 8.86238C4.03217 8.58464 4 8.29607 4 8C4 7.70392 4.03217 7.41535 4.0932 7.1376L2.78663 6.24302C3.02242 5.54311 3.3952 4.9062 3.87309 4.36418ZM8.00002 9.5C8.82844 9.5 9.50002 8.82843 9.50002 8C9.50002 7.17157 8.82844 6.5 8.00002 6.5C7.17159 6.5 6.50002 7.17157 6.50002 8C6.50002 8.82843 7.17159 9.5 8.00002 9.5Z"/></svg>':"help-circle"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 11V12M6.5 6C6.5 5.17157 7.17157 4.5 8 4.5C8.82843 4.5 9.5 5.17157 9.5 6C9.5 7.5 8 7.5 8 8.5V10M14.5 8C14.5 11.5899 11.5899 14.5 8 14.5C4.41015 14.5 1.5 11.5899 1.5 8C1.5 4.41015 4.41015 1.5 8 1.5C11.5899 1.5 14.5 4.41015 14.5 8Z"/></svg>':"plus"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 12.5V3.5M12.5 8H3.5"/></svg>':"minus"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12.5 8H3.5"/></svg>':"export"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5 5.5H3.5V12.5H12.5V5.5H11M8 2V9"/><path d="M6 4L8 2L10 4"/></svg>':"floppy"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.5 13.5L11.5 8.5H4.5V13.5M5.5 2.5V6.5H10.5V2.5M2.5 2.5V13.5H13.5V4.5L11.75 2.5H2.5Z"/></svg>':"folder-open"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1.49878 12.5L1.501 12.4945M1.501 12.4945L3.5 7.5H12.5M1.501 12.4945L1.501 12.5H12.4988L14.5 7.5H12.5M1.501 12.4945L1.5 3.5L5.49999 3.5L6.03589 5.5L12.5 5.5V7.5"/></svg>':"eyedropper"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.75 6.75L5.5 12L3.5 13L3 12.5L4 10.5L9.25 5.25M8 4L12 8M9 5L10.5 3.5C11.0523 2.94771 11.9477 2.94771 12.5 3.5C13.0523 4.05228 13.0523 4.94771 12.5 5.5L11 7L9 5Z"/></svg>':"magnifying-glass"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.0001 14.0001L9.32849 9.32842M10.5 6.5C10.5 8.70914 8.70914 10.5 6.5 10.5C4.29086 10.5 2.5 8.70914 2.5 6.5C2.5 4.29086 4.29086 2.5 6.5 2.5C8.70914 2.5 10.5 4.29086 10.5 6.5Z"/></svg>':"play"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.5 8L5.5 11.5V4.5L11.5 8Z"/></svg>':"pause"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 4V12M10.5 4V12"/></svg>':"first-frame"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 3.5V12.5M5.5 8L11.5 11.5V4.5L5.5 8Z"/></svg>':"previous-frame"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12.5 3.5V12.5M3.5 8L9.5 11.5V4.5L3.5 8Z"/></svg>':"next-frame"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 3.5V12.5M12.5 8L6.5 11.5V4.5L12.5 8Z"/></svg>':"last-frame"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.5 3.5V12.5M4.5 11.5V4.5L10.5 8L4.5 11.5Z"/></svg>':"loop"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 11.5H5C3.067 11.5 1.5 9.933 1.5 8C1.5 6.067 3.067 4.5 5 4.5H11C12.933 4.5 14.5 6.067 14.5 8C14.5 9.933 12.933 11.5 11 11.5"/><path d="M6.5 13.5L8.5 11.5L6.5 9.5"/></svg>':"chevron-up"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M12 10L8 6L4 10"/></svg>':"chevron-down"===e||"chevron-down-select"===e?he:"mirror"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 2V14M10 8L13.5 4.5V11.5L10 8ZM6 8L2.5 4.5V11.5L6 8Z"/></svg>':"chevron-right"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4"/></svg>':"chevron-left"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10 4L6 8L10 12"/></svg>':"sticker"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 2.5H13.5V13.5H6.5L2.5 9.5V2.5Z"/><path d="M6.5 13.5V9.5H2.5"/></svg>':"shader"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13.5 8C13.5 11.0376 11.0376 13.5 8 13.5C4.96243 13.5 2.5 11.0376 2.5 8C2.5 4.96243 4.96243 2.5 8 2.5C11.0376 2.5 13.5 4.96243 13.5 8Z"/><path d="M7.99986 10V11.5M7.99986 10C7.25964 10 6.61335 9.59788 6.26752 9.00017M7.99986 10C8.74007 10 9.38636 9.59788 9.73219 9.00017M7.99986 6V4.5M7.99986 6C7.25964 6 6.61335 6.40212 6.26752 6.99983M7.99986 6C8.74007 6 9.38636 6.40212 9.73219 6.99983M4.96826 6.24971L6.26752 6.99983M6.26752 6.99983C6.09729 7.29404 5.99986 7.63564 5.99986 8C5.99986 8.36436 6.09729 8.70596 6.26752 9.00017M6.26752 9.00017L4.96826 9.75029M9.73219 9.00017C9.90242 8.70596 9.99986 8.36436 9.99986 8C9.99986 7.63564 9.90242 7.29404 9.73219 6.99983M9.73219 9.00017L11.0314 9.75029M9.73219 6.99983L11.0314 6.24971"/></svg>':"in"===e?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g filter="url(#filter0_d_1401_46522)"><path d="M15.7133 2.00098L4 2V18H20.0002L15.7133 2.00098Z" fill="#2B2B2B"/><path d="M18.0453 16.5H5.5V3.50013L14.5622 3.50088L18.0453 16.5Z" stroke="#76B900" stroke-width="3"/></g><defs><filter id="filter0_d_1401_46522" x="0" y="0" width="24.0002" height="24" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.4 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1401_46522"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1401_46522" result="shape"/></filter></defs></svg>':"out"===e?'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g filter="url(#filter0_d_1401_46521)"><path d="M8.28693 2.00098L20.0002 2V18H4L8.28693 2.00098Z" fill="#2B2B2B"/><path d="M5.95484 16.5L9.43794 3.50088L18.5002 3.50013V16.5H5.95484Z" stroke="#76B900" stroke-width="3"/></g><defs><filter id="filter0_d_1401_46521" x="0" y="0" width="24.0002" height="24" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/><feOffset dy="2"/><feGaussianBlur stdDeviation="2"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.4 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1401_46521"/><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1401_46521" result="shape"/></filter></defs></svg>':"close"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M3 3L13 13M13 3L3 13"/></svg>':"eye"===e?'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 8C9.5 8.82843 8.82843 9.5 8 9.5C7.17157 9.5 6.5 8.82843 6.5 8C6.5 7.17157 7.17157 6.5 8 6.5C8.82843 6.5 9.5 7.17157 9.5 8Z" stroke="black"/><path d="M14.5 8C13.9348 9 11.1216 11.5 8 11.5C4.87839 11.5 2.06522 9 1.5 8C2.06522 7 4.87839 4.5 8 4.5C11.1216 4.5 13.9348 7 14.5 8Z" stroke="black"/></svg>':"eye-off"===e?'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="mask0_2_2047" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="16" height="16"><path d="M2.8284 0L16 13.1716V0H2.8284Z" fill="#FF0000"/><path d="M16 16L0 2.89679e-05V16H16Z" fill="#FF0000"/></mask><g mask="url(#mask0_2_2047)"><path d="M9.5 8C9.5 8.82843 8.82843 9.5 8 9.5C7.17157 9.5 6.5 8.82843 6.5 8C6.5 7.17157 7.17157 6.5 8 6.5C8.82843 6.5 9.5 7.17157 9.5 8Z" stroke="black"/><path d="M14.5 8C13.9348 9 11.1216 11.5 8 11.5C4.87839 11.5 2.06522 9 1.5 8C2.06522 7 4.87839 4.5 8 4.5C11.1216 4.5 13.9348 7 14.5 8Z" stroke="black"/></g><path d="M2 2L14 14" stroke="black" stroke-miterlimit="2.16568" stroke-linejoin="round"/></svg>':"speaker"===e?'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 6.5L10.5 3.5V12.5L7 9.5H5.5V6.5H7Z" stroke="black"/></svg>':"speaker-off"===e?'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="mask0_2_1973" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="16" height="16"><path d="M2.8284 0L16 13.1716V0H2.8284Z" fill="#FF0000"/><path d="M16 16L0 2.89679e-05V16H16Z" fill="#FF0000"/></mask><g mask="url(#mask0_2_1973)"><path d="M6 6.5L9.5 3.5V12.5L6 9.5H4.5V6.5H6Z" stroke="black"/></g><path d="M2 2L14 14" stroke="black" stroke-miterlimit="2.16568" stroke-linejoin="round"/></svg>':"speaker-medium"===e?'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 6V10M12.5 5V11M8.5 3.5L5 6.5H3.5V9.5H5L8.5 12.5V3.5Z" stroke="black"/></svg>':"speaker-mute"===e?'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 6.5L13.5 10.5M9.5 10.5L13.5 6.5M7.5 3.5L4 6.5H2.5V9.5H4L7.5 12.5V3.5Z" stroke="black"/></svg>':"wand"===e?'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.75 6.75L2 12.5L3.5 14L9.25 8.25M7.75 6.75L10 4.5L11.5 6L9.25 8.25M7.75 6.75L9.25 8.25M4.68604 4.5761L6.61836 5.0939M8.57596 0.686066L9.09375 2.61839M13.8891 2.11086L12.4748 3.52508M15.3138 7.4239L13.3815 6.90614M11.4237 11.3139L10.906 9.38154" stroke="black"/></svg>':"cards"===e?'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.49996 11.5H6.99996M5.49996 11.5L4.05111 11.8882L2.23938 5.12676L5.49996 4.25309M5.49996 11.5V4.25309M6.99996 11.5L8.44885 11.8882L11.8316 12.7946L14.161 4.10131L9.32933 2.80667L9.14355 3.50001M6.99996 11.5L9.14355 3.50001M9.14355 3.50001H5.49996V4.25309" stroke="black"/></svg>':"video"===e?'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 1V14H3V1H2ZM4 1V14H5V1H4ZM4.5 2H2.5V3H4.5V2ZM4.5 6H2.5V7H4.5V6ZM4.5 8H2.5V9H4.5V8ZM4.5 12H2.5V13H4.5V12ZM11 1V14H12V1H11ZM13 1V14H14V1H13ZM13.5 2H11.5V3H13.5V2ZM13.5 12H11.5V13H13.5V12ZM13.5 6H11.5V7H13.5V6ZM13.5 8H11.5V9H13.5V8ZM13.5 4H2.5V5H13.5V4ZM13.5 10H2.5V11H13.5V10Z" fill="black"/></svg>':"image"===e?'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.5 10.8236L10.0168 8.81711L6.53361 10.8236L2.5 8.5M2.5 2.5H13.5V13.5H2.5V2.5ZM7.5 6.5C7.5 7.05228 7.05228 7.5 6.5 7.5C5.94772 7.5 5.5 7.05228 5.5 6.5C5.5 5.94772 5.94772 5.5 6.5 5.5C7.05228 5.5 7.5 5.94772 7.5 6.5Z" stroke="black"/></svg>':"close-thin"===e?'<svg id="Close_thin" data-name="Close thin" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 499.03 499.03"><defs><style>.cls-1{fill-rule:evenodd;}</style></defs><polygon class="cls-1" points="499.02 49.75 449.28 0 249.51 199.76 49.75 0 0 49.75 199.76 249.51 0 449.28 49.75 499.02 249.51 299.26 449.28 499.02 499.02 449.28 299.26 249.51 499.02 49.75"/></svg>':"speed"===e?'<svg id="Speed" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 491 431.87"><path d="M286.89,226l.11,0L179,76l27,176,.05,0A44,44,0,1,0,286.89,226Z" transform="translate(-5 -5)"/><path d="M495.87,243h0c0-.24,0-.47,0-.71,0-.65-.05-1.3-.07-1.94s0-1.2-.07-1.8l0-.58c0-.62-.08-1.23-.11-1.86s-.07-1-.1-1.52c0-.13,0-.26,0-.39,0-.5-.06-1-.1-1.51l-.06-.93c0-.61-.11-1.2-.16-1.8l-.06-.78v-.08c-.05-.51-.09-1-.14-1.52,0-.24,0-.47-.06-.7,0-.43-.07-.87-.11-1.3-.1-.92-.21-1.84-.32-2.76-.06-.54-.11-1.08-.18-1.62v-.08c-.06-.56-.12-1.11-.19-1.66-.12-1-.26-1.89-.39-2.83-.15-1.09-.29-2.18-.46-3.26s-.31-1.9-.46-2.85-.34-2.12-.53-3.18-.36-1.92-.55-2.88-.38-2.07-.59-3.1-.42-1.94-.63-2.91-.42-2-.65-3-.47-2-.71-2.92-.47-2-.72-2.95-.52-2-.78-2.93-.51-1.93-.78-2.89-.57-2-.86-2.94l0-.11,0-.1c-.26-.87-.51-1.74-.78-2.61s-.59-1.83-.88-2.74c-.06-.18-.12-.36-.17-.54-.27-.81-.52-1.62-.79-2.42s-.57-1.63-.85-2.45l-.36-1c-.25-.71-.5-1.43-.76-2.14s-.54-1.45-.81-2.17c-.2-.52-.39-1-.59-1.57s-.46-1.22-.7-1.83l-.76-1.89c-.25-.64-.51-1.28-.77-1.91-.14-.34-.27-.68-.41-1l-.3-.69c-.22-.55-.46-1.09-.69-1.63-.3-.71-.6-1.42-.91-2.12s-.53-1.19-.8-1.78l-.58-1.29c-.36-.78-.71-1.56-1.08-2.34s-.63-1.34-.95-2l-.39-.81c-.41-.85-.82-1.7-1.24-2.55l-1.11-2.18-.17-.33a.75.75,0,0,0-.07-.12c-.45-.9-.91-1.79-1.38-2.68s-.95-1.76-1.43-2.64l-1.43-2.62c-.5-.88-1-1.76-1.52-2.63s-1-1.72-1.49-2.57-1.06-1.75-1.6-2.63-1-1.68-1.54-2.51-1.12-1.75-1.68-2.63-1.05-1.64-1.59-2.45-1.19-1.76-1.79-2.63-1.08-1.6-1.63-2.39-1.25-1.75-1.88-2.63-1.11-1.55-1.68-2.32-1.32-1.76-2-2.64-1.13-1.5-1.71-2.25-1.41-1.77-2.11-2.65l-1.72-2.16-.83-1-.22-.26-1.2-1.44c-.58-.68-1.14-1.37-1.72-2-.2-.24-.41-.47-.61-.7L435.4,89l-1-1.15-.21-.24c-.19-.21-.37-.43-.56-.65l-.07-.06-.82-.93-.39-.43-1.72-1.85h0l-.9-1-.35-.37c-.3-.31-.58-.63-.88-.95l-.19-.19-.75-.78a10.73,10.73,0,0,0-.79-.86l-2.65-2.66h0L420,72.83a14.53,14.53,0,0,0-1.33-1.16h0l-.52-.48c-.47-.45-1-.89-1.43-1.33l-1.31-1.21-.43-.4c-.46-.42-.93-.82-1.39-1.23l-1.15-1-.3-.26-1.13-1c-.23-.21-.46-.42-.7-.62L408.93,63l-.59-.5-.08-.06-1.17-1c-.17-.15-.34-.3-.52-.44l-1-.84c-.72-.59-1.45-1.15-2.18-1.73l-1.27-1-.07,0-1.31-1c-.75-.58-1.51-1.15-2.27-1.72s-1.75-1.33-2.63-2-1.57-1.13-2.36-1.7-1.73-1.25-2.6-1.86-1.63-1.11-2.45-1.67-1.72-1.18-2.59-1.76-1.67-1.08-2.51-1.62-1.72-1.12-2.59-1.66-1.71-1.05-2.56-1.57l-2.6-1.58c-.87-.52-1.75-1-2.62-1.51s-1.73-1-2.6-1.5-1.79-1-2.69-1.46l-.1-.06-.09,0-2.39-1.3L362.53,32l-.51-.27-2.26-1.14c-.78-.39-1.56-.76-2.34-1.14l-1-.47c-.68-.33-1.36-.67-2.05-1l-2.11-1-1.52-.69-1.8-.8-1.87-.8-1.9-.81-1-.42-.7-.28-1.64-.66-2.15-.85-1.81-.7-1.33-.5-2.41-.9-2.09-.74-.85-.29-2.68-.93-2.33-.75-.35-.11-.13-.05c-1-.3-1.91-.62-2.87-.91L320,15c-1-.29-1.91-.57-2.88-.84s-1.95-.53-2.93-.8l-2.86-.76-3-.73-2.86-.68c-1-.24-2-.45-3.05-.67l-2.87-.61c-1-.21-2.07-.4-3.11-.6l-2.85-.53c-1.06-.19-2.13-.36-3.19-.53s-1.88-.32-2.82-.46l-3.27-.46-2.8-.38c-1.12-.14-2.24-.26-3.36-.39-.92-.1-1.83-.21-2.75-.3l-1.29-.12-.35,0-1.87-.16c-.88-.08-1.76-.17-2.64-.24l-.93-.06-1.24-.07-1.55-.1-.3,0-.85-.06h-.1L263,5.32l-.58,0-2.53-.09-1.33-.06h-.5l-1.3,0h-1.35C255,5,254.65,5,254.26,5h-9.52a12.79,12.79,0,0,0-1.76.13h0l-.71,0-1.95.07-1.79.07-.58,0-1.85.11-1.53.1-.39,0-1.51.1-.93.06c-.61,0-1.2.11-1.8.16l-.78.06h-.08l-1.52.14c-.24,0-.47,0-.7.06l-1.3.11-2.76.32-1.62.18h-.08L219.43,7c-1,.12-1.89.26-2.83.39-1.09.15-2.18.29-3.26.46s-1.9.31-2.85.46-2.12.34-3.18.53-1.92.36-2.88.55-2.07.38-3.1.59-1.94.42-2.91.63-2,.42-3,.65l-2.92.71c-1,.23-2,.47-2.95.72s-2,.52-2.93.78-1.93.51-2.89.78l-2.94.86-.11,0-.1,0L178,15.9l-2.74.88-.54.17-2.42.79-2.45.85-1,.36-2.14.76c-.73.26-1.45.54-2.17.81l-1.57.59-1.83.7-1.89.76-1.91.77-1,.41-.69.3c-.55.22-1.09.46-1.63.69l-2.12.91-1.78.8-1.29.58c-.78.36-1.56.71-2.34,1.08l-2,.95-.81.39L141,30.69l-2.18,1.11-.33.17-.12.07c-.9.45-1.79.91-2.68,1.38l-2.64,1.43-2.62,1.43-2.63,1.52c-.86.49-1.72,1-2.57,1.49s-1.75,1.06-2.62,1.59-1.69,1-2.52,1.55-1.75,1.12-2.62,1.68-1.65,1-2.46,1.6-1.75,1.18-2.62,1.77-1.61,1.09-2.4,1.64-1.75,1.25-2.62,1.88-1.56,1.11-2.33,1.68-1.76,1.32-2.63,2-1.51,1.13-2.26,1.71-1.76,1.4-2.65,2.11L95.37,60.2l-1,.83-.26.22-1.43,1.19-2,1.73-.7.61c-.32.27-.62.55-.93.82l-1.14,1-.25.22-.65.56-.06.07-.93.82-.43.39L83.7,70.39h0l-1,.9-.37.35c-.31.3-.63.58-.95.88l-.19.19-.78.75a10.73,10.73,0,0,0-.86.79L72.83,81a14.53,14.53,0,0,0-1.16,1.33l-.48.53c-.45.47-.89,1-1.33,1.43l-1.21,1.31c-.14.14-.27.28-.4.43-.42.46-.82.93-1.23,1.39l-1,1.15-.26.3-1,1.13c-.21.23-.42.46-.62.7L63,92.07c-.17.19-.33.39-.5.59l-.06.08-1,1.17c-.15.17-.3.34-.44.52l-.84,1c-.59.72-1.15,1.45-1.73,2.18l-1,1.27,0,.07c-.34.43-.7.87-1,1.31-.58.75-1.15,1.51-1.72,2.27s-1.33,1.75-2,2.63-1.13,1.57-1.7,2.36-1.25,1.73-1.86,2.6-1.11,1.63-1.67,2.45-1.18,1.72-1.76,2.59-1.08,1.67-1.62,2.51-1.12,1.72-1.66,2.59-1.05,1.71-1.57,2.56-1.06,1.73-1.58,2.6-1,1.75-1.51,2.62-1,1.73-1.5,2.6-1,1.79-1.46,2.69l-.06.1,0,.09-1.3,2.39L32,138.47l-.27.51c-.38.76-.77,1.51-1.14,2.26s-.76,1.56-1.14,2.34c-.16.33-.32.66-.47,1-.33.68-.67,1.36-1,2.05l-1,2.11-.69,1.52c-.26.6-.54,1.2-.8,1.8s-.53,1.24-.8,1.87l-.81,1.9c-.13.33-.28.66-.42,1s-.19.46-.28.7l-.66,1.64c-.29.71-.57,1.43-.85,2.15s-.47,1.2-.7,1.81c-.17.44-.33.89-.5,1.33l-.9,2.41L18.88,169c-.09.28-.19.57-.29.85l-.93,2.68-.75,2.33a3.58,3.58,0,0,0-.11.35s0,.09-.05.13c-.3,1-.62,1.91-.91,2.87s-.57,1.91-.85,2.87-.57,1.91-.84,2.88-.53,2-.8,2.93-.51,1.9-.76,2.86-.49,2-.73,3-.46,1.9-.68,2.86-.45,2-.67,3.05-.41,1.91-.61,2.87-.4,2.07-.6,3.11-.36,1.9-.53,2.85-.36,2.13-.53,3.19-.32,1.88-.46,2.82c-.16,1.09-.31,2.18-.46,3.27-.12.93-.26,1.86-.38,2.8-.14,1.12-.26,2.24-.39,3.36-.1.92-.21,1.83-.3,2.75,0,.43-.08.86-.12,1.29l0,.35c-.06.62-.11,1.24-.16,1.87-.08.88-.17,1.76-.24,2.64l-.06.93c0,.41,0,.83-.07,1.24s-.07,1-.1,1.55c0,.1,0,.2,0,.3l-.06.85v.1c0,.41,0,.82-.07,1.23l0,.58c0,.85-.06,1.69-.09,2.53,0,.45,0,.89-.06,1.33,0,.17,0,.34,0,.5,0,.44,0,.87,0,1.3a2.17,2.17,0,0,1,0,.26c0,.37,0,.73,0,1.09s-.06.78-.06,1.17v9.52A12.79,12.79,0,0,0,5.13,258h0c0,.24,0,.47,0,.71,0,.65,0,1.3.07,1.94s0,1.25.08,1.87c0,.79.09,1.58.13,2.37,0,.53.07,1.06.1,1.6v0c0,.63.07,1.26.12,1.89.06.88.13,1.75.21,2.62l.06.78.12,1.28c0,.38.06.76.1,1.15.17,1.74.36,3.47.56,5.2,0,.19,0,.38.07.57q.33,2.81.74,5.6a.78.78,0,0,0,0,.14,241.92,241.92,0,0,0,7.55,34.52,1.8,1.8,0,0,1,.05.19c.53,1.77,1.07,3.54,1.64,5.29.07.22.14.45.22.67q.77,2.39,1.59,4.74l.44,1.26.26.72c.06.18.13.37.19.56.34.94.69,1.87,1,2.81.21.57.43,1.14.65,1.71l.48,1.26c.3.78.61,1.55.92,2.32s.51,1.28.77,1.91l.63,1.53.77,1.8c.3.71.6,1.42.91,2.12s.53,1.19.8,1.78l.58,1.29c.36.78.71,1.56,1.08,2.34s.63,1.34.95,2l.39.81c.41.85.82,1.7,1.24,2.55l1.11,2.18.17.33.07.12c.45.9.91,1.79,1.38,2.68s.95,1.76,1.43,2.64l1.43,2.62c.5.88,1,1.75,1.52,2.63s1,1.72,1.49,2.57,1.06,1.75,1.59,2.62,1,1.69,1.55,2.52,1.12,1.75,1.68,2.62,1,1.65,1.6,2.46,1.18,1.75,1.77,2.62,1.09,1.61,1.64,2.4,1.25,1.75,1.88,2.62,1.11,1.56,1.68,2.33,1.32,1.76,2,2.63,1.13,1.51,1.71,2.26,1.4,1.76,2.11,2.65l1.72,2.16.83,1,.22.26c.39.48.8.95,1.19,1.43l1.73,2.05c.2.24.41.47.61.7s.55.62.82.93l1,1.14.57.65c.09.1.18.21.28.31l.82.93.39.43,1.72,1.85.12.13,1.13,1.22c.3.31.58.63.88,1l.19.19.75.78a10.73,10.73,0,0,0,.79.86l2.65,2.66h0L81,428.17a14.53,14.53,0,0,0,1.33,1.16l.53.48c.47.45,1,.89,1.43,1.33l1.31,1.21.43.4c.46.42.93.82,1.39,1.23l1.15,1,.3.26,1.13,1c.23.21.46.42.7.62.09.07,8-7.62,17.45-16.91a12.26,12.26,0,0,0,1-.89l6.59-6.6c12.36-12.14,24.64-24.27,24.64-24.27a13.63,13.63,0,0,0,1.65-2l8.54-8.53a10.72,10.72,0,0,0,0-15.15L124,335.93a10.72,10.72,0,0,0-15.15,0L85,359.78a198.37,198.37,0,0,1-17-31.56c-.1-.22-.19-.44-.28-.67-.38-.88-.74-1.77-1.1-2.66A198.56,198.56,0,0,1,54.41,280H89.29A10.72,10.72,0,0,0,100,269.29V231.71A10.72,10.72,0,0,0,89.29,221H54.4a199.3,199.3,0,0,1,12.07-44.61l.28-.67q.54-1.33,1.11-2.67a197.83,197.83,0,0,1,22.49-39.48l24,24a10.72,10.72,0,0,0,15.15,0L156.07,131a10.72,10.72,0,0,0,0-15.15L131.83,91.61A199.28,199.28,0,0,1,172.78,68l.66-.28c.89-.38,1.78-.74,2.68-1.11a198.67,198.67,0,0,1,43.88-12V87.29A10.72,10.72,0,0,0,230.71,98h37.58A10.72,10.72,0,0,0,279,87.29v-33a199.19,199.19,0,0,1,45.61,12.22l.67.28,2.67,1.1A198.47,198.47,0,0,1,368,90.77l-25.08,25.08a10.72,10.72,0,0,0,0,15.15l26.57,26.57a10.72,10.72,0,0,0,15.15,0l25.16-25.16A199,199,0,0,1,433,172.78c.1.22.19.44.28.67.38.88.74,1.77,1.1,2.66A198.56,198.56,0,0,1,446.59,221H412.71A10.72,10.72,0,0,0,402,231.71v37.58A10.72,10.72,0,0,0,412.71,280H446.6a198.11,198.11,0,0,1-29.33,78.05l-22.12-22.12a10.72,10.72,0,0,0-15.15,0L353.43,362.5a10.72,10.72,0,0,0,0,15.15l6.65,6.65a13.94,13.94,0,0,0,2,2.49s14.83,14.6,28.33,27.8l4.48,4.48a10.43,10.43,0,0,0,1,.88c8.86,8.64,16,15.55,16.13,15.45l1.14-1,.25-.22.7-.62.94-.83.43-.39,1.85-1.72h0l1.32-1.23,1-.9.19-.19.78-.75a10.73,10.73,0,0,0,.86-.79l2.66-2.65h0l4.07-4.07a14.53,14.53,0,0,0,1.16-1.33l.57-.62,1.16-1.25c.43-.47.87-.93,1.29-1.4.14-.14.27-.28.4-.43.46-.51.9-1,1.36-1.54l.76-.86.39-.44,1-1.13c.21-.23.42-.46.62-.7.45-.52.88-1.05,1.32-1.57l.17-.21.23-.28,1-1.17c.15-.17.3-.34.44-.52l.84-1c.59-.72,1.15-1.45,1.73-2.18l1-1.27,0-.07c.34-.43.7-.87,1-1.31.58-.75,1.15-1.51,1.72-2.27s1.33-1.75,2-2.63,1.13-1.57,1.7-2.36,1.25-1.73,1.86-2.6,1.11-1.63,1.67-2.45,1.18-1.72,1.76-2.59,1.08-1.67,1.62-2.51,1.12-1.72,1.66-2.59,1-1.71,1.57-2.57,1.06-1.72,1.58-2.59,1-1.75,1.52-2.62,1-1.73,1.49-2.6,1-1.79,1.46-2.69l.06-.1.05-.09,1.3-2.39,1.31-2.56.27-.51c.38-.76.77-1.51,1.14-2.26s.76-1.56,1.14-2.34l.48-1c.32-.68.66-1.36,1-2.05l1-2.11.69-1.53c.26-.59.54-1.19.8-1.78l.8-1.88c.3-.7.6-1.4.89-2.1.21-.5.42-1,.62-1.5l.66-1.64c.36-.89.71-1.78,1.06-2.68.15-.4.3-.79.46-1.19s.35-1,.53-1.42c.4-1.07.8-2.15,1.19-3.23.05-.16.11-.31.16-.46s.11-.32.17-.49l.41-1.17c.43-1.23.85-2.47,1.26-3.71.09-.27.18-.54.26-.82a1.72,1.72,0,0,0,.07-.21c.08-.22.15-.45.22-.67.43-1.33.85-2.67,1.26-4,.07-.26.15-.51.23-.77l.15-.51a1.8,1.8,0,0,1,.05-.19c.43-1.43.84-2.86,1.24-4.3.06-.24.13-.48.19-.72q.69-2.55,1.34-5.11c.05-.22.11-.44.16-.67q.65-2.6,1.23-5.21c.05-.2.09-.4.13-.6.39-1.77.77-3.55,1.12-5.33,0-.19.07-.37.11-.55q.52-2.71,1-5.44c0-.16.05-.32.08-.48q.47-2.76.88-5.55c0-.14,0-.28.06-.42s0-.09,0-.14a.78.78,0,0,0,0-.14q.39-2.68.72-5.38l0-.26.06-.53c.2-1.73.39-3.46.56-5.2,0-.39.07-.77.1-1.15.14-1.56.28-3.12.39-4.68.05-.63.08-1.26.12-1.89l.09-1.36.06-.85v-.1c0-.56.07-1.13.09-1.7.05-.88.07-1.76.1-2.64,0-.45.05-.89.06-1.33,0-.17,0-.34,0-.5,0-.5,0-1,.05-1.5s0-.77,0-1.15.06-.78.06-1.17v-9.52A12.79,12.79,0,0,0,495.87,243Z" transform="translate(-5 -5)"/></svg>':"restore"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="M3 5v9h9V5H3zm8 8H4V6h7v7z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M5 5h1V4h7v7h-1v1h2V3H5v2z"/></svg>':"minimize"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="M14 8v1H3V8h11z"/></svg>':"maximize"===e?'<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="M3 3v10h10V3H3zm9 9H4V4h8v8z"/></svg>':"mouse"===e?'<svg width="14" height="18" viewBox="0 0 14 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0.75 0.25V11.5C0.75 14.9518 3.54822 17.75 7 17.75C10.4518 17.75 13.25 14.9518 13.25 11.5V0.25H0.75ZM6.375 1.5H2V5.875H6.375V1.5ZM7.625 1.5V5.875H12V1.5H7.625ZM2 11.5V7.125H12V11.5C12 14.2614 9.76142 16.5 7 16.5C4.23858 16.5 2 14.2614 2 11.5Z" fill="white"/></svg>':"":"",this.#e()}});const ve=["down","up"],ye=["left","right"],we=e=>{let t=e;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){}return Array.isArray(t)?t.reduce(((e,t)=>{let i=t;return"string"==typeof i&&(i={value:i,label:i}),i&&e.push(i),e}),[]):[]};const xe={alignment:{formatter:q(ye,ye[0])},closeOnClick:{formatter:$},direction:{formatter:q(ve,ve[0]),onChange(e){this.internalDirection=e}},internalDirection:{attribute:!1,formatter:q(ve,ve[0])},directionUpPaddingEm:{onChange(e){const t=this.shadowRoot.getElementById("direction-up-padding"),i=`.drop-down-container[data-direction="up"] #drop-down-options-container{bottom:${e}em;}`;t?t.textContent=i:this.shadowRoot.appendChild(y({tag:"style",properties:{textContent:i}}))}},directionDownPaddingEm:{onChange(e){const t=this.shadowRoot.getElementById("direction-down-padding"),i=`.drop-down-container[data-direction="down"][data-flyout="true"] #drop-down-options-container{top:${e}em;}`;t?t.textContent=i:this.shadowRoot.appendChild(y({tag:"style",properties:{textContent:i}}))}},fullwidth:{formatter:H},minWidth:{},options:{formatter:we,onChange(){this.setOptions()}},value:{onChange(){this.setOptions(),this.setActive()}},visible:{formatter:H,onChange(e){if("function"==typeof this.docClick&&this.docClick(),e){const e=e=>{ce(this,e)&&!this.closeOnClick||(this.visible=!1)};window.addEventListener("click",e),this.docClick=()=>window.removeEventListener("click",e),this.setBoundingParent(),this.updateAlignment(),this.style.width="100%",this.style.minWidth=this.minWidth,this.style.removeProperty("overflow")}else this.style.width="0%",this.style.overflow="hidden";this.dispatchEvent(new CustomEvent("dropdownvisibility",{bubbles:!0,composed:!0,detail:e}))}},flyout:{formatter:H,reflect:!0},flyoutDirection:{formatter:q(ye,ye[0]),onChange(){this.setOptions()}}},Ee=x(xe),Se=w('<div class="drop-down-container" bind-attr-internaldirection="data-direction" bind-attr-alignment="data-align" bind-attr-fullwidth="data-fullwidth" bind-attr-visible="data-visible" bind-attr-flyout="data-flyout" bind-attr-flyoutdirection="data-flyout-direction"><div class="drop-down-container-inner"><div id="drop-down-options-container"><slot name="drop-down-option"></slot></div></div></div>',":host{display:block;height:0;position:relative;width:0}:host([flyout=true]){bottom:0;left:0;position:absolute}.drop-down-container{pointer-events:none;position:absolute;width:100%;z-index:999999}.drop-down-container .drop-down-container-inner{height:100%;position:relative;width:100%}.drop-down-container #drop-down-options-container{background:#424242;border-radius:4px;box-shadow:0 10px 30px -10px #000;opacity:0;position:absolute;transition:opacity .2s}.drop-down-container .drop-down-option{align-items:center;background-color:initial;cursor:pointer;display:flex;flex-wrap:nowrap;gap:1em;line-height:125%;padding:.75em;position:relative;transition:background-color .2s,opacity .3s,color .2s;white-space:nowrap}.drop-down-container .drop-down-option:first-of-type{border-radius:4px 4px 0 0}.drop-down-container .drop-down-option:last-of-type{border-radius:0 0 4px 4px}.drop-down-container .drop-down-option:only-child{border-radius:4px}.drop-down-container .drop-down-option:hover{background-color:#5c5c5c;color:#fff}.drop-down-container .drop-down-option[data-active=true],.drop-down-container .drop-down-option[data-active=true]:hover{background-color:#76b900;color:#fff}.drop-down-container .drop-down-option .drop-down-option-text{flex-grow:1;white-space:nowrap}.drop-down-container .drop-down-option .drop-down-option-value-text{margin-left:1em;opacity:.5;white-space:nowrap}.drop-down-container .drop-down-option icon-element+.drop-down-option-text{display:block;margin-top:.2em}.drop-down-container[data-direction=up]{top:0}.drop-down-container[data-direction=down],.drop-down-container[data-direction=up] #drop-down-options-container{bottom:0}.drop-down-container[data-direction=down] #drop-down-options-container{top:0}.drop-down-container[data-fullwidth=true] #drop-down-options-container{min-width:100%}.drop-down-container[data-align=left],.drop-down-container[data-align=left] #drop-down-options-container{left:0}.drop-down-container[data-align=left][data-flyout=true] #drop-down-options-container{-webkit-transform:translateX(-100%);transform:translateX(-100%)}.drop-down-container[data-align=right],.drop-down-container[data-align=right] #drop-down-options-container{right:0}.drop-down-container[data-align=right][data-flyout=true] #drop-down-options-container{-webkit-transform:translateX(100%);transform:translateX(100%)}.drop-down-container[data-visible=true]{pointer-events:all}.drop-down-container[data-visible=true] #drop-down-options-container{opacity:1}");E("drop-down",class extends v{static get observedAttributes(){return Ee}_stateConfigs=xe;docClick=()=>{};alignment=ye[0];closeOnClick=!0;direction=ve[0];internalDirection=ve[0];fullwidth=!1;minWidth="";value="";visible=!1;options=[];boundingParent;directionUpPaddingEm="2.25";directionDownPaddingEm="-2.25";flyout=!1;flyoutDirection=ye[0];optionClicked=!1;constructor(){super(),C(this,Se)}container(){return this.shadowRoot.getElementById("drop-down-options-container")}optionElements(){return Array.from(this.shadowRoot.querySelectorAll(".drop-down-option")).concat(Array.from(this.querySelectorAll('[slot="drop-down-option"]')))}setOptions(){const e=e=>void 0===e?"":e;k({container:this.container(),array:this.options,getElementsFn:()=>this.optionElements(),valueKeyFn:(e,t)=>t,elementValueKeyFn:e=>e.index,updateFn:(t,i,n)=>{const a=t.querySelector("icon-element"),o=t.querySelector(".drop-down-option-text"),s=e(i.label),r=t.querySelector("drop-down"),l=t.querySelector(".drop-down-option-value-text");if(t.setAttribute("data-active",(i.value===this.value).toString()),i.icon?i.icon&&!a&&t.insertBefore(y({tag:"icon-element",properties:{type:i.icon}}),o):a&&a.parentElement.removeChild(a),o&&o.textContent!==s&&(o.textContent=s),i.options&&i.options.length||!r){if(i.options&&i.options.length&&!r){if(i.displayLabelValue){const e=i.options.find((e=>e.value===i.value)),n=e?e.label:i.value;t.appendChild(y({tag:"span",attributes:{class:"drop-down-option-value-text"},properties:{textContent:n}}))}t.appendChild(y({tag:"drop-down",properties:{options:i.options,flyout:!0,flyoutDirection:this.flyoutDirection,value:i.value},events:{dropdownclick:e=>{e.preventDefault(),e.stopPropagation(),this.subOptionClick(i,n,e.detail.value)}}}))}else if(i.options&&i.options.length&&r){if(i.displayLabelValue&&l){const e=i.options.find((e=>e.value===i.value)),t=e?e.label:i.value;l.textContent=t}r.options=i.options,r.flyoutDirection=this.flyoutDirection,r.value=i.value}}else r.parentElement.removeChild(r),l&&l.parentElement.removeChild(l)},createFn:(t,i)=>{const n=[];if(t.icon&&n.push(y({tag:"icon-element",attributes:{type:t.icon,style:`font-size:${t.iconsize}`}})),n.push(y({tag:"span",attributes:{class:"drop-down-option-text"},properties:{textContent:e(t.label)}})),t.options&&t.options.length){if(t.displayLabelValue){const e=t.options.find((e=>e.value===t.value)),i=e?e.label:t.value;n.push(y({tag:"span",attributes:{class:"drop-down-option-value-text"},properties:{textContent:i}}))}n.push(y({tag:"icon-element",attributes:{class:"drop-down-option-options-arrow",type:"chevron-right"}})),n.push(y({tag:"drop-down",properties:{options:t.options,flyout:!0,flyoutDirection:this.flyoutDirection,value:t.value},events:{dropdownclick:e=>{e.preventDefault(),e.stopPropagation(),this.subOptionClick(t,i,e.detail.value)}}}))}return y({tag:"div",attributes:{class:"drop-down-option","data-active":(t.value===this.value).toString()},properties:{value:t.value},events:{click:e=>this.optionClick(e,t,i)},children:n})}}),this.updateAlignment()}subOptionClick(e,t,i){this.closeOnClick&&(this.visible=!1),e.onclick&&this.dispatchEvent(new CustomEvent(e.onclick,{bubbles:!0,composed:!0,detail:{value:i,option:e,index:t}}))}optionClick(e,t,i){e.preventDefault(),e.stopPropagation(),this.optionClicked=!0;const n=this.optionElements();if(n.forEach((e=>{const t=e.querySelector("drop-down");t&&(t.visible=!1)})),t.options&&t.options.length){const e=n[Number(i)];if(e){const t=e.querySelector("drop-down");if(t)return t.visible=!0,void(this.optionClicked=!1)}}this.closeOnClick&&(this.visible=!1),t.onclick&&this.dispatchEvent(new CustomEvent(t.onclick,{bubbles:!0,composed:!0,detail:{value:t.value,label:t.label,index:i}})),this.dispatchEvent(new CustomEvent("dropdownclick",{bubbles:!0,composed:!0,detail:{value:t.value,label:t.label,index:i}})),this.optionClicked=!1}updateAlignment(){this.boundingParent||this.setBoundingParent();const e=this.flyout;e&&(this.directionUpPaddingEm="0"),this.alignment=e?this.flyoutDirection:"left",this.internalDirection=this.direction;const t=this.container();t.style.removeProperty("max-height"),t.style.removeProperty("overflow");const i=this.boundingParent.getBoundingClientRect();let n=t.getBoundingClientRect();const a=n.x-i.x+n.width>i.width,o=n.x<0;if(e||(a?this.alignment="right":o&&(this.alignment="left")),n.y+n.height>i.height){const e=n.y-i.y,a=i.height-e;this.internalDirection=e>a?"up":"down",n=t.getBoundingClientRect(),n.y<i.y?(t.style.maxHeight=`${n.y-(i.y+10)+n.height}px`,t.style.overflow="auto"):"down"===this.internalDirection&&a<n.height?(t.style.maxHeight=`${a}px`,t.style.overflow="auto"):"up"===this.internalDirection&&e<n.height&&(t.style.maxHeight=`${e}px`,t.style.overflow="auto")}else n.y<i.y&&(t.style.maxHeight=`${n.y-(i.y+10)+n.height}px`,t.style.overflow="auto")}setBoundingParent(){this.boundingParent=function(e,t=!0){let i=getComputedStyle(e);const n=t?/(auto|scroll|hidden)/:/(auto|scroll)/;let a,o=e.parentElement||e.getRootNode().host;if("fixed"===i.position||e.parentElement===window)return document.body;for(;!a&&o&&o!==document.body;)if(i=getComputedStyle(o),"absolute"===i.position&&"static"===i.position)o=o.parentElement||o.getRootNode().host;else{if(n.test(i.overflow+i.overflowY+i.overflowX))return a=!0,o;o=o.parentElement||o.getRootNode().host}return document.body}(this)}setActive=()=>{const e=this.value;this.optionElements().forEach((t=>{const i=t.value===e||t.getAttribute("value")===e;try{t.setAttribute("data-active",i.toString())}catch(e){}}))};attached(){this.setBoundingParent();const t=this.shadowRoot.querySelector('slot[name="drop-down-option"]');e(this,"slotchange",this.setActive,t)}detached(){"function"==typeof this.docClick&&this.docClick(),this.boundingParent=null}});const Te=[1,2,3,4,5,6],Ce=[0,1,2,3,4],Ie=["primary","secondary","danger","link","circle","outline","active-underline"],ke=["center","left","right"],Re={flyoutDirection:{formatter:q(ye,ye[0]),onChange(e){this.dropdown().flyoutDirection=e}},fullwidth:{formatter:H},icon:{onChange(e){if(e){Array.from(this.querySelectorAll('[slot="icon"]')).forEach((e=>this.removeChild(e)));const t=y({tag:"icon-element",attributes:{slot:"icon",type:e,circle:this.iconCircle.toString()}});t.style.fontSize=this.iconsize,this.appendChild(t)}}},iconsize:{onChange(e){const t=this.querySelector('[slot="icon"]');t&&(t.style.fontSize=e)}},dropdownsize:{onChange(e){const t=this.shadowRoot.getElementById("drop-down");t&&(t.style.fontSize=e)}},iconCircle:{onChange(e){const t=this.querySelector('[slot="icon"]');t&&t.setAttribute("circle",e.toString())}},options:{onChange(e){this.dropdown().options=e}},size:{formatter:de(_(3),q(Te,Te[2]))},dim:{formatter:de(_(1),q(Ce,Ce[1]))},slim:{formatter:H},text:{onChange(e){e&&(Array.from(this.querySelectorAll('[slot="text"]')).forEach((e=>this.removeChild(e))),this.appendChild(y({tag:"span",attributes:{slot:"text"},properties:{textContent:e}})))}},type:{formatter:q(Ie,Ie[0])},value:{matchType:!1},active:{formatter:H,onChange(e){this.shadowRoot.querySelector(".button-element").setAttribute("data-active",e.toString())}},nodropdownicon:{formatter:H},customStyles:{onChange(e){const t=this.shadowRoot.querySelector(".button-element");t&&(t.setAttribute("style",""),Object.keys(e||{}).forEach((i=>{t.style[`${i}`]=e[`${i}`]})))}},customStylesDropdown:{formatter:e=>{if(e&&"string"==typeof e){let t;try{t=JSON.parse(e)}catch(e){}return t}return e},onChange(e){const t=this.dropdown();t&&(t.setAttribute("style",""),Object.keys(e||{}).forEach((i=>{t.style[`${i}`]=e[`${i}`]})))}},alignment:{formatter:q(ke,ke[0])},hoversecondary:{formatter:H}},Le=x(Re),Me=w('<button class="button-element" bind-attr-fullwidth="data-fullwidth" bind-attr-size="data-size" bind-attr-type="data-type" bind-attr-options="data-option-count:length" bind-attr-dim="data-dim" bind-attr-slim="data-slim" type="button" bind-attr-nodropdownicon="data-hide-drop-down-icon" bind-attr-alignment="data-alignment" bind-attr-hoversecondary="data-hover-secondary"><div class="button-element-content"><div id="button-text-icon"><slot name="icon"></slot><slot name="text"></slot></div><div class="drop-down-arrow"><icon-element type="chevron-down"></icon-element></div><drop-down id="drop-down" bind-prop-fullwidth="fullwidth" bind-prop-value="value" bind-attr-flyoutdirection="flyoutDirection"></drop-down></div><div class="active-indicator"></div></button>',':host(button-element[fullwidth=true]){width:100%}:host(button-element){align-items:center;display:flex}button{background-color:#76b900;border:none;border-radius:2px;box-shadow:none;color:#fff;cursor:pointer;display:block;font-family:inherit;font-size:inherit;font-weight:400;line-height:100%;outline:none!important;padding:.75em 1em;position:relative;text-align:left;transition:background-color .2s,color .2s}button:after{border-radius:2px;box-shadow:inset 0 0 .01em .1em #a3ff05;content:"";height:100%;left:0;opacity:.25;position:absolute;top:0;transition:opacity .2s,color .2s;width:100%}button:active,button:hover{background-color:#5d9300;color:#fff}button:active:after,button:hover:after{opacity:.2}button #button-text-icon,button .button-element-content{align-items:center;display:flex}button #button-text-icon{gap:.62em;transition:opacity .2s}button .button-element-content{gap:.38em}button[data-type=active-underline][data-dim="0"],button[data-type=active-underline][data-dim="0"][data-option-count]:not([data-option-count="0"]),button[data-type=active-underline][data-dim="0"][data-option-count]:not([data-option-count="0"]) #button-text-icon,button[data-type=link][data-dim="0"],button[data-type=link][data-dim="0"][data-option-count]:not([data-option-count="0"]),button[data-type=link][data-dim="0"][data-option-count]:not([data-option-count="0"]) #button-text-icon{opacity:1}button[data-type=active-underline][data-dim="1"],button[data-type=link][data-dim="1"]{opacity:.75}button[data-type=active-underline][data-dim="1"][data-option-count]:not([data-option-count="0"]),button[data-type=link][data-dim="1"][data-option-count]:not([data-option-count="0"]){opacity:1}button[data-type=active-underline][data-dim="1"][data-option-count]:not([data-option-count="0"]) #button-text-icon,button[data-type=link][data-dim="1"][data-option-count]:not([data-option-count="0"]) #button-text-icon{opacity:.75}button[data-type=active-underline][data-dim="1"][data-option-count]:not([data-option-count="0"]).active #button-text-icon,button[data-type=active-underline][data-dim="1"][data-option-count]:not([data-option-count="0"]):active #button-text-icon,button[data-type=active-underline][data-dim="1"][data-option-count]:not([data-option-count="0"]):hover #button-text-icon,button[data-type=link][data-dim="1"][data-option-count]:not([data-option-count="0"]).active #button-text-icon,button[data-type=link][data-dim="1"][data-option-count]:not([data-option-count="0"]):active #button-text-icon,button[data-type=link][data-dim="1"][data-option-count]:not([data-option-count="0"]):hover #button-text-icon{opacity:1}button[data-type=active-underline][data-dim="2"],button[data-type=link][data-dim="2"]{opacity:.56}button[data-type=active-underline][data-dim="2"][data-option-count]:not([data-option-count="0"]),button[data-type=link][data-dim="2"][data-option-count]:not([data-option-count="0"]){opacity:1}button[data-type=active-underline][data-dim="2"][data-option-count]:not([data-option-count="0"]) #button-text-icon,button[data-type=link][data-dim="2"][data-option-count]:not([data-option-count="0"]) #button-text-icon{opacity:.56}button[data-type=active-underline][data-dim="2"][data-option-count]:not([data-option-count="0"]).active #button-text-icon,button[data-type=active-underline][data-dim="2"][data-option-count]:not([data-option-count="0"]):active #button-text-icon,button[data-type=active-underline][data-dim="2"][data-option-count]:not([data-option-count="0"]):hover #button-text-icon,button[data-type=link][data-dim="2"][data-option-count]:not([data-option-count="0"]).active #button-text-icon,button[data-type=link][data-dim="2"][data-option-count]:not([data-option-count="0"]):active #button-text-icon,button[data-type=link][data-dim="2"][data-option-count]:not([data-option-count="0"]):hover #button-text-icon{opacity:1}button[data-type=active-underline][data-dim="3"],button[data-type=link][data-dim="3"]{opacity:.28}button[data-type=active-underline][data-dim="3"][data-option-count]:not([data-option-count="0"]),button[data-type=link][data-dim="3"][data-option-count]:not([data-option-count="0"]){opacity:1}button[data-type=active-underline][data-dim="3"][data-option-count]:not([data-option-count="0"]) #button-text-icon,button[data-type=link][data-dim="3"][data-option-count]:not([data-option-count="0"]) #button-text-icon{opacity:.28}button[data-type=active-underline][data-dim="3"][data-option-count]:not([data-option-count="0"]).active #button-text-icon,button[data-type=active-underline][data-dim="3"][data-option-count]:not([data-option-count="0"]):active #button-text-icon,button[data-type=active-underline][data-dim="3"][data-option-count]:not([data-option-count="0"]):hover #button-text-icon,button[data-type=link][data-dim="3"][data-option-count]:not([data-option-count="0"]).active #button-text-icon,button[data-type=link][data-dim="3"][data-option-count]:not([data-option-count="0"]):active #button-text-icon,button[data-type=link][data-dim="3"][data-option-count]:not([data-option-count="0"]):hover #button-text-icon{opacity:1}button[data-type=active-underline][data-dim="4"],button[data-type=link][data-dim="4"]{opacity:0}button[data-type=active-underline][data-dim="4"][data-option-count]:not([data-option-count="0"]),button[data-type=link][data-dim="4"][data-option-count]:not([data-option-count="0"]){opacity:1}button[data-type=active-underline][data-dim="4"][data-option-count]:not([data-option-count="0"]) #button-text-icon,button[data-type=link][data-dim="4"][data-option-count]:not([data-option-count="0"]) #button-text-icon{opacity:0}button[data-type=active-underline][data-dim="4"][data-option-count]:not([data-option-count="0"]).active #button-text-icon,button[data-type=active-underline][data-dim="4"][data-option-count]:not([data-option-count="0"]):active #button-text-icon,button[data-type=active-underline][data-dim="4"][data-option-count]:not([data-option-count="0"]):hover #button-text-icon,button[data-type=link][data-dim="4"][data-option-count]:not([data-option-count="0"]).active #button-text-icon,button[data-type=link][data-dim="4"][data-option-count]:not([data-option-count="0"]):active #button-text-icon,button[data-type=link][data-dim="4"][data-option-count]:not([data-option-count="0"]):hover #button-text-icon{opacity:1}button[data-type=secondary]{background-color:#757575;color:#fafafa}button[data-type=secondary]:after{box-shadow:inset 0 0 .01em .1em #9f9f9f}button[data-type=secondary]:active,button[data-type=secondary]:hover{background-color:#858585;box-shadow:inset 0 0 .01em .1em #9f9f9f;color:#fff}button[data-type=link][data-hover-secondary=true]:active,button[data-type=link][data-hover-secondary=true]:hover,button[data-type=outline][data-hover-secondary=true]:active,button[data-type=outline][data-hover-secondary=true]:hover{background-color:hsla(0,0%,46%,.5);color:#fff}button[data-type=danger]{background-color:#a10005;color:#ffecec}button[data-type=danger]:after{box-shadow:inset 0 0 .01em .1em #ff0d15}button[data-type=danger]:active,button[data-type=danger]:hover{background-color:#d90007;box-shadow:inset 0 0 .01em .1em #ff0d15;color:#fff}button[data-type=outline]{background-color:initial;color:#eee}button[data-type=outline]:after{box-shadow:inset 0 0 0 1px;color:#616161;opacity:1}button[data-type=outline]:active,button[data-type=outline]:hover{background-color:initial;color:#fff}button[data-type=outline]:active:after,button[data-type=outline]:hover:after{box-shadow:inset 0 0 0 1px;color:#828282;opacity:1}button[data-type=active-underline],button[data-type=active-underline]:active,button[data-type=active-underline]:hover,button[data-type=link],button[data-type=link]:active,button[data-type=link]:hover{background-color:initial;box-shadow:none;padding:.5em;text-transform:unset;transition:opacity .2s}button[data-type=active-underline]:active:after,button[data-type=active-underline]:after,button[data-type=active-underline]:hover:after,button[data-type=link]:active:after,button[data-type=link]:after,button[data-type=link]:hover:after{display:none}button[data-type=active-underline]:active,button[data-type=active-underline]:active:active,button[data-type=active-underline]:active:hover,button[data-type=active-underline]:hover,button[data-type=active-underline]:hover:active,button[data-type=active-underline]:hover:hover,button[data-type=link]:active,button[data-type=link]:active:active,button[data-type=link]:active:hover,button[data-type=link]:hover,button[data-type=link]:hover:active,button[data-type=link]:hover:hover{opacity:1}button[data-type=active-underline][data-active=true],button[data-type=active-underline][data-active=true]:active,button[data-type=active-underline][data-active=true]:hover{color:#76b900;opacity:1}button[data-type=active-underline]{border-radius:0;padding:.875em .5em;transition:opacity .2s,color .2s,box-shadow .2s}button[data-type=active-underline][data-active=false]:active .active-indicator,button[data-type=active-underline][data-active=false]:hover .active-indicator,button[data-type=active-underline][data-active=true] .active-indicator{color:currentColor}button[data-type=active-underline][data-active=true] .active-indicator{opacity:1}button[data-type=active-underline] .active-indicator{color:transparent;display:block}button[data-type=circle],button[data-type=circle]:active,button[data-type=circle]:hover{background-color:initial;padding:.5em}button[data-type=circle] #button-text-icon,button[data-type=circle] .button-element-content,button[data-type=circle]:active #button-text-icon,button[data-type=circle]:active .button-element-content,button[data-type=circle]:hover #button-text-icon,button[data-type=circle]:hover .button-element-content{align-items:center;display:flex;justify-content:center}button[data-type=circle]:active:after,button[data-type=circle]:after,button[data-type=circle]:hover:after{border-radius:50%;box-shadow:inset 0 0 0 1px}button[data-size="1"]{font-size:.62em}button[data-size="2"]{font-size:.75em}button[data-size="3"]{font-size:.88em}button[data-size="4"]{font-size:1em}button[data-size="5"]{font-size:1.2em}button[data-size="6"]{font-size:1.5em}button[data-fullwidth=true],button[data-fullwidth=true] button{width:100%}button[data-fullwidth=true] #button-text-icon,button[data-fullwidth=true] .button-element-content,button[data-fullwidth=true] button #button-text-icon,button[data-fullwidth=true] button .button-element-content{align-items:center;display:flex;justify-content:center;width:100%}button[data-fullwidth=true] button[data-alignment=left] #button-text-icon,button[data-fullwidth=true] button[data-alignment=left] .button-element-content,button[data-fullwidth=true][data-alignment=left] #button-text-icon,button[data-fullwidth=true][data-alignment=left] .button-element-content{justify-content:left}button[data-fullwidth=true] button[data-alignment=right] #button-text-icon,button[data-fullwidth=true] button[data-alignment=right] .button-element-content,button[data-fullwidth=true][data-alignment=right] #button-text-icon,button[data-fullwidth=true][data-alignment=right] .button-element-content{justify-content:right}button[data-slim=true],button[data-slim=true]:active,button[data-slim=true]:hover{padding:.25em}button drop-down{bottom:0;display:none;left:0;position:absolute}button .drop-down-arrow{display:none}button[data-option-count]:not([data-option-count="0"]) .drop-down-arrow,button[data-option-count]:not([data-option-count="0"]) drop-down{display:block}button[data-option-count]:not([data-option-count="0"])[data-hide-drop-down-icon=true] .drop-down-arrow{display:none}button .drop-down-option{align-items:center;background-color:initial;cursor:pointer;display:flex;flex-wrap:nowrap;gap:.75em;line-height:125%;padding:.5em .75em;transition:background-color .2s,opacity .3s,color .2s;white-space:nowrap}button .drop-down-option:first-of-type{border-radius:4px 4px 0 0}button .drop-down-option:last-of-type{border-radius:0 0 4px 4px}button .drop-down-option:only-child{border-radius:4px}button .drop-down-option:hover{background-color:#5c5c5c;color:#fff}button .drop-down-option[data-active=true],button .drop-down-option[data-active=true]:hover{background-color:#76b900;color:#fff}button .drop-down-option .drop-down-option-text{font-size:inherit}.active-indicator{color:transparent;display:none;height:0;opacity:.25;pointer-events:none;position:relative;transition:color .2s,opacity .2s;width:100%}.active-indicator:after{background:currentColor;bottom:-.85em;content:"";display:block;height:.15em;left:0;pointer-events:none;position:absolute;width:100%}');E("button-element",class extends v{static get observedAttributes(){return Le}_stateConfigs=Re;active=!1;alignment=ke[0];fullwidth=!1;icon="";iconCircle=!1;options=[];size=Te[2];text="";type=Ie[0];value="";iconsize="";dropdownsize="";dim=1;slim=!1;nodropdownicon=!1;customStyles={};customStylesDropdown={};flyoutDirection="left";hoversecondary=!1;constructor(){super(),C(this,Me)}dropdown(){return this.shadowRoot.getElementById("drop-down")}attached(){const e=this.shadowRoot.querySelector(".button-element"),t=this.dropdown();e?e.onclick=()=>{const e=t.visible;e||requestAnimationFrame((()=>{this.options&&this.options.length&&(t.visible=!e)}))}:console.warn("Could not find button",this)}});const Ae={activeSet:{onChange(){this.updateSetOptions()}},sets:{onChange(e){this.updateSetOptions(),this.setAttribute("has-sets",(e.length>1).toString())}},size:{formatter:_(3)},options:{},text:{},active:{formatter:H}},Oe=x(Ae),Be=w('<div id="set-select-container" bind-attr-active="data-active"><input-element id="set-select-button" noinnerborders="true" nobackground="true" nomargin="true" nominheight="true" type="select" bind-prop-options="options" bind-prop-activeset="value"></input-element></div>',":host(set-select[has-sets=false]){display:none}input-element{font-size:95%}#set-select-container{opacity:.56;transition:opacity .2s}#set-select-container[data-active=true]{opacity:1}");E("set-select",class extends v{static get observedAttributes(){return Oe}_stateConfigs=Ae;activeSet="";sets=[];size=3;options=[];text="";active=!1;constructor(){super(),C(this,Be)}updateSetOptions(){const e=this.sets.find((e=>e.id===this.activeSet));this.text=e?e.label:"Sets",this.options=this.sets.map((e=>({label:e.label,onclick:"setselected",value:e.id})))}attached(){e(this,"setselected",(e=>{e.preventDefault(),e.stopPropagation(),this.dispatchEvent(new CustomEvent("loadset",{bubbles:!0,composed:!0,detail:e.detail.value}))})),e(this,"inputfocus",(e=>{e.preventDefault(),e.stopPropagation(),this.active=!0})),e(this,"inputblur",(e=>{e.preventDefault(),e.stopPropagation(),this.active=!1}))}});const Ne={message:{onChange(){this.updateVisible()}},visible:{formatter:H,onChange(i){const n=this.container();n&&(i?(e(this,"keydown",(e=>{if(!this.visible)return t(this,"keydown",n);e.path&&"INPUT"===e.path[0].tagName||"Escape"===e.key&&this.visible&&(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),this.close(),t(this,"keydown",n),this.dispatchEvent(new CustomEvent("appfocus",{bubbles:!0,composed:!0})))}),n),n.focus()):(n.blur(),t(this,"keydown",n),this.dispatchEvent(new CustomEvent("messageoverlayhidden",{bubbles:!0,composed:!0,detail:this}))))}}},Pe=x(Ne),Fe=w('<div id="message-container" bind-attr-visible="data-shown" tabindex="0"><div class="message-inner"><div class="message-background"></div><div class="message-box-outer"><div class="message-box"><div id="message-content"><span bind-prop-message="textContent"></span><slot name="content"></slot></div><div id="message-close"><button-element id="close-button" icon="close" bind-events="click:close" slim="true" size="6" type="link"></button-element></div></div></div></div></div>',":host{height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%;z-index:99999}#message-container{height:100%;left:0;opacity:0;outline:none!important;pointer-events:none;position:absolute;top:0;width:100%;z-index:-1}#message-container[data-shown=true]{opacity:1;z-index:99999}#message-container[data-shown=true] .message-inner .message-background,#message-container[data-shown=true] .message-inner .message-box,#message-container[data-shown=true] .message-inner .message-box-outer{pointer-events:all}#message-container .message-inner{align-items:center;color:inherit;display:flex;height:100%;justify-content:center;position:relative;width:100%}#message-container .message-inner .message-background{background-color:#000;height:100%;opacity:.8;position:absolute;width:100%}#message-container .message-inner .message-box-outer{align-items:center;display:inline-flex;justify-content:center;max-height:90%;max-width:90%;pointer-events:none;position:relative;width:auto}#message-container .message-inner .message-box{align-items:flex-start;background:#424242;border-radius:1px;box-shadow:0 0 0 1px #000,0 10px 20px -10px #000,0 10px 40px #000;box-sizing:border-box;display:flex;flex-wrap:nowrap;overflow:auto;padding:1em}#message-container .message-inner .message-box #message-content{flex-grow:1}#message-container .message-inner .message-box #message-content>span{text-align:center;white-space:pre-wrap}#message-container #message-close{align-items:center;display:flex;height:3.5em;justify-content:center;margin:-1em -1em -1em 1em;width:3.5em}#message-container #message-close:hover{background-color:#4f4f4f}#message-container #message-close button-element{font-size:88.9%}");E("message-overlay",class extends v{static get observedAttributes(){return Pe}_stateConfigs=Ne;message="";visible=!1;constructor(){super(),C(this,Fe)}container(){return this.shadowRoot.getElementById("message-container")}close=()=>{this.message="",this.innerHTML="",this.visible=!1};updateVisible(){const e=!!this.message,t=this.children.length>0;this.visible=e||t}focus(){try{this.container().focus()}catch(e){}}childrenCallback(){this.updateVisible()}});const De="0.4.4";const Ve={appVersion:{attribute:!1}},Ue=x(Ve).concat(["webgl"]),ze=w('<div class="shortcuts"><p class="title">Shortcuts</p><section class="shortcut-details"><div class="common-section"><div class="key-section"><p class="key-text">Play/Pause</p><p class="key"><span class="key-btn">Space</span></p></div><div class="key-section"><p class="key-text">Change playback speed</p><p class="key"><span class="key-btn">[</span> <span class="key-label">/</span> <span class="key-btn">]</span></p></div><div class="key-section"><p class="key-text">Reset playback speed</p><p class="key"><span class="key-btn">P</span></p></div><div class="key-section"><p class="key-text">Frame advance</p><p class="key"><span class="key-btn">&#8592;</span> <span class="key-label">/</span> <span class="key-btn">&#8594;</span></p></div><div class="key-section"><p class="key-text">Jump to start</p><p class="key"><span class="key-btn">0</span></p></div></div><div class="common-section"><div class="key-section"><p class="key-text">Pan view</p><p class="key"><icon-element type="mouse"></icon-element><span class="key-label">Mouse drag</span></p></div><div class="key-section"><p class="key-text">Zoom view</p><p class="key"><icon-element type="mouse"></icon-element><span class="key-label">Mouse scroll wheel</span></p></div><div class="key-section"><p class="key-text">Split screen mode</p><p class="key"><span class="key-btn">1</span></p></div><div class="key-section"><p class="key-text">Side-by-side mode</p><p class="key"><span class="key-btn">2</span></p></div><div class="key-section"><p class="key-text">Toggle fullscreen</p><p class="key"><span class="key-btn">CTRL + f</span></p></div></div></section><section class="shortcut-details bottom-section"><div class="common-section full-width"><div class="key-section"><p class="key-text">Version</p><p class="key gap"><span bind-prop-appversion="textContent"></span><a href="https://www.nvidia.com/en-us/geforce/technologies/icat/release-notes/">View release notes</a></p></div></div></section><section id="electron-app-content" class="shortcut-details bottom-section" data-is-electron="false"><div class="common-section full-width"><div class="key-section"><p class="key-text">Error logs path</p><p class="key" id="error-logs-path"></p></div><div class="key-section hidden-option"><p class="key-text">Hardware acceleration</p><p class="key gap"><span id="hw-status" class="status-text">ON</span><button-element text="Disable" id="toggle-hardware-acceleration-btn"></button-element><span>Changing hardware acceleration requires the app to restart so be sure to save your project.</span></p></div><div class="key-section hidden-option"><p class="key-text">WebGL</p><p class="key gap"><span id="webgl-status" class="status-text">ON</span><button-element text="Disable" id="toggle-webgl-btn"></button-element></p></div></div></section></div>',":host{display:block;max-width:100%;width:38em}.shortcuts{display:flex;flex-direction:column;padding:0 0 0 1em}.shortcuts .title{font-weight:700;margin-top:0}.shortcuts .shortcut-details{border-bottom:1px solid #616161;border-top:1px solid #616161;display:flex;padding:.5em 0}.shortcuts .shortcut-details.bottom-section{border:none;padding-bottom:0}.shortcut-details .common-section{display:flex;flex-direction:column;width:50%}.shortcut-details .common-section.full-width{width:100%}.shortcut-details .common-section.full-width .key-text{width:25%}.shortcut-details .common-section.full-width .key{width:75%}.key-section{align-items:center;color:#e0e0e0;display:flex;font-size:12px;font-weight:400;line-height:18px}.key-section .key,.key-section .key-text{align-items:center;display:flex;margin:.5rem 0;width:50%}.key-section .key icon-element,.key-section .key-text icon-element{font-size:1.62em}.key-section .key a,.key-section .key-text a{color:#76b900!important;display:block;text-decoration:none}.key-section .key-text.column,.key-section .key.column{align-items:flex-start;flex-direction:column}.key-section .key-btn{border:1px solid #fff;border-radius:2px;box-sizing:border-box;padding:2px 6px}.key-section .key-label{margin:0 .5rem}.key-section .gap{gap:1em}#electron-app-content{display:none}#electron-app-content[data-is-electron=true]{display:flex}.status-text{min-width:2em;width:2em}.hidden-option{display:none}");E("help-content",class extends v{static get observedAttributes(){return Ue}_stateConfigs=Ve;appVersion=De;#t=!0;get webgl(){return this.#t}set webgl(e){}constructor(){super(),C(this,ze)}#i(){return this.shadowRoot.getElementById("electron-app-content")}attached(){const e=B.isElectron;if(this.#i().setAttribute("data-is-electron",e.toString()),!e)return;const t=window.NvCompareApi;this.shadowRoot.getElementById("error-logs-path").textContent=t.getErrorLogsPath()}});const He=(e="",t="")=>new Promise(((i,n)=>{(e=>fetch(e).then((e=>e.blob())))(e).then((e=>{const a=new FileReader;a.onload=()=>i("pfm"===t?new ne(a.result):new ie(a.result)),a.onerror=()=>n("Could not read media"),a.readAsArrayBuffer(e)})).catch((()=>n("Could not read media")))}));async function $e(e="",t="",i="",n=0){return new Promise(((o,s)=>{const r=function(e=""){const t=((e="")=>e.split(".").pop()||"")(e);if("mp4"===t)return"video";if(["jpeg","jpg","png","svg"].indexOf(t)>-1)return"image";const i=e.slice(0,10);return"data:image"===i?"image":"data:video"===i||"data:video"===i?"video":void 0}(e)||t;if(!r)return void s("Invalid source type");let l,d=!1;const c="pfm"===i||"exr"===i,h="data:"===e.slice(0,5),u=a();function m(){return l.removeEventListener("error",m),d=!0,s(l&&l.error?l.error.message?l.error.message:l.error:"Could not load source")}function p(){if(d=!0,"IMG"===l.tagName&&l.removeEventListener("load",p),"VIDEO"===l.tagName){const e=l;l.removeEventListener("canplaythrough",p),l.removeEventListener("seeked",p),e.currentTime=n}return l.removeEventListener("error",m),o(l)}if(c&&!h){const t=document.createElement("canvas");return t.id=u,void((e,t,i)=>new Promise(((n,a)=>{He(t,i).then((a=>(e.fileData=a,e.ext=i,e.src=t,re(a,e),n(e)))).catch(a)})))(t,e,i).then((e=>o(e))).catch((e=>s(e)))}if("image"===r)return l=new Image,l.id=u,l.addEventListener("load",p),l.addEventListener("error",m),void(l.src=e);l=document.createElement("video"),l.id=u,l.muted=!0;const g=()=>{if(d)return;const e=l,t=e.videoWidth||e.width,i=e.videoHeight||e.height;return 4===e.readyState&&t&&i?p():requestAnimationFrame(g)};l.addEventListener("canplaythrough",p),l.addEventListener("error",m),l.playsInline=!0,l.preload="auto",l.src=e;try{l.load()}catch(e){}g()}))}const _e=e=>({width:e.videoWidth||e.naturalWidth||e.width,height:e.videoHeight||e.naturalHeight||e.height});function qe(e,t,i,n){const a=t.fileData;a&&e.getExtension("OES_texture_float_linear");const{width:o,height:s}=_e(t),r=a?a.toFloatArray():t;let l,d=e.createTexture();e.bindTexture(e.TEXTURE_2D,d),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),o&&s&&(a?e.texImage2D(e.TEXTURE_2D,0,e.RGBA32F,o,s,0,e.RGBA,e.FLOAT,null):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,o,s,0,e.RGBA,e.UNSIGNED_BYTE,null)),e.bindTexture(e.TEXTURE_2D,d),a?e.texImage2D(e.TEXTURE_2D,0,e.RGBA32F,o,s,0,e.RGBA,e.FLOAT,r):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);const c={width:o,height:s,use(){const l=_e(t);c.width=l.width,c.height=l.height,e.useProgram(n),e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,d),a?e.texImage2D(e.TEXTURE_2D,0,e.RGBA32F,o,s,0,e.RGBA,e.FLOAT,r):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r);const h=e.getUniformLocation(n,`uTexture${i}`);return h&&e.uniform1i(h,i),c.draw(),c},draw(){if(l=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,l),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,d,0),e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE)return e.viewport(0,0,c.width,c.height),e.bindFramebuffer(e.FRAMEBUFFER,null),c},dispose(){e.deleteTexture(d),l&&e.deleteFramebuffer(l),d=null}};return c}function Ge(e,t){const i=(t,i)=>{const n=e.createShader(t);if(e.shaderSource(n,i),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error(`Shader compile: ${e.getShaderInfoLog(n)}`);return n};let n=()=>{},a=0,o=0,s=0;const r=Date.now();let l=null,d=null,c=null,h=null,u=e.createProgram();if(e.attachShader(u,i(e.VERTEX_SHADER,"#version 300 es\nprecision highp float;\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\nout vec2 vTextureCoord;\nvoid main()\n{\n    gl_Position = vec4(aVertexPosition, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}")),e.attachShader(u,i(e.FRAGMENT_SHADER,t)),e.linkProgram(u),!e.getProgramParameter(u,e.LINK_STATUS))throw new Error(`Shader program: ${e.getProgramInfoLog(u)}`);const m=e.getUniformLocation(u,"uDimensions"),p=e.getUniformLocation(u,"uTime"),g=e.getUniformLocation(u,"uMouse"),b=()=>{s=1},f=()=>{s=0},v=t=>{const i=e.canvas.getBoundingClientRect();a=t.clientX-i.left,o=t.clientY-i.top};g&&(n=()=>{e.canvas.removeEventListener("mousedown",b),e.canvas.removeEventListener("mouseup",f),e.canvas.removeEventListener("mouseleave",f),e.canvas.removeEventListener("mousemove",v)},e.canvas.addEventListener("mousedown",b),e.canvas.addEventListener("mouseup",f),e.canvas.addEventListener("mouseleave",f),e.canvas.addEventListener("mousemove",v));const y={width:0,height:0,constantRender:!!g||!!p,program:u,draw(){u&&(null==l&&(l=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),e.STATIC_DRAW),null==d&&(d=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,d),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),e.STATIC_DRAW)),null==c&&(c=e.getAttribLocation(u,"aVertexPosition"),e.enableVertexAttribArray(c)),null==h&&(h=e.getAttribLocation(u,"aTextureCoord"),e.enableVertexAttribArray(h)),e.useProgram(u),e.bindBuffer(e.ARRAY_BUFFER,l),e.vertexAttribPointer(c,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,d),e.vertexAttribPointer(h,2,e.FLOAT,!1,0,0),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.drawArrays(e.TRIANGLE_STRIP,0,4))},setUniforms(t={}){if(!u)return;e.useProgram(u);const i=e.getUniformLocation(u,"uTonemapper");if(!t.exposure&&!t.gamma||1===t.exposure.value&&1===t.gamma.value)e.uniform1i(i,-1);else{if(e.uniform1i(i,0),t.gamma){const i=e.getUniformLocation(u,"uGamma");e.uniform1f(i,t.gamma.value)}if(t.exposure){const i=e.getUniformLocation(u,"uExposure");e.uniform1f(i,t.exposure.value)}}return m&&e.uniform2f(m,y.width,y.height),g&&e.uniform4f(g,a,o,s,0),p&&e.uniform1f(p,(Date.now()-r)/1e3),Object.keys(t).forEach((i=>{if("exposure"===i||"game"===i)return;const n=t[`${i}`],a=n.type,o=n.value,s=e.getUniformLocation(u,i);"bool"===a&&e.uniform1i(s,o?1:0),"int"===a&&e.uniform1i(s,o),"float"===a&&e.uniform1f(s,o),"dropdown"===a&&e.uniform1i(s,o)})),y},dispose(){e.deleteProgram(u),u=null,n()}};return y}class We{id="";gl;canvas;isWebGl=!0;mediaElements=[];inputCount=1;shader;shaderSettings={};hasAllInputs=!1;textures=[];drawListeners=[];rendering=!1;queued=!1;disposed=!1;switchCanvasCallbacks=[];width=0;height=0;renderOnPlay=!1;timer;#n={canvasdraw:{},onplaying:{},onplay:{},onpause:{},onended:{}};constructor(e,t=!0,i="",n=!1){this.canvas=e,this.isWebGl=t,this.id=i,this.renderOnPlay=n,t?(this.gl=e.getContext("webgl2",{preserveDrawingBuffer:!0,alpha:!0,antialias:!1}),this.gl?(this.gl.getExtension("EXT_color_buffer_float"),this.gl.getExtension("EXT_float_blend"),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0)):this.create2D()):this.create2D();try{e.addEventListener("webglcontextlost",(()=>{if(!this.disposed){try{B.logError("webglcontextlost")}catch(e){}this.create2D()}}))}catch(e){}try{e.addEventListener("contextlost",(()=>{try{B.logError("contextlost")}catch(e){}}))}catch(e){}}updateWebGl(e){this.isWebGl!==e&&(e?this.createWebGl():this.create2D())}on(e,t){const i=a();return this.#n[`${e}`]&&(this.#n[`${e}`][`${i}`]=t),()=>{const t=this.#n[`${e}`];t&&t[`${i}`]&&delete this.#n[`${e}`][`${i}`]}}#a(e){const t=this.#n[`${e}`];t&&Object.keys(t).forEach((e=>"function"!=typeof t[`${e}`]?void 0:t[`${e}`](this)))}setUniforms(e){this.shaderSettings=e,this.render()}render=()=>{if(this.rendering)this.queued=!0;else if(this.hasAllInputs&&(!this.isWebGl||this.shader&&this.textures.length===this.inputCount)){if(this.rendering=!0,this.setDimensions(this.mediaElements),this.isWebGl)this.textures.forEach((e=>{e.use(),this.shader.setUniforms(this.shaderSettings).draw()}));else{const e=this.gl;if(e.imageSmoothingEnabled=!1,e.drawImage(this.mediaElements[0],0,0),this.shaderSettings.gamma||this.shaderSettings.exposure){const t=this.shaderSettings.gamma.value,i=this.shaderSettings.exposure.value;if(1!==t||1!==i){const n=e.getImageData(0,0,e.canvas.width,e.canvas.height),a=n.data,o=1/(t||1),s=e=>{a[Number(e)]=i*(255*(a[Number(e)]/255)**o)},r=e=>{for(let t=0;t<3;t+=1)s(e+t)};for(let e=0;e<a.length;e+=4)r(e);e.putImageData(n,0,0)}}}this.canvas.dispatchEvent(new CustomEvent("canvasdraw",{bubbles:!0,composed:!0,detail:this.canvas})),this.#a("canvasdraw"),this.rendering=!1,(this.queued||this.shader&&this.shader.constantRender)&&requestAnimationFrame((()=>{this.queued=!1,this.render()}))}};setDimensions(e){let t=0,i=0;if(e.forEach((e=>{e&&(t=Math.max(e.naturalWidth||e.videoWidth||e.width,t),i=Math.max(e.naturalHeight||e.videoHeight||e.height,i))})),t!==this.width||i!==this.height){if(this.width=t,this.height=i,this.isWebGl){this.shader.width=t,this.shader.height=i;this.gl.viewport(0,0,t,i)}this.canvas.width=t,this.canvas.height=i,this.canvas.style.width=`${t}px`,this.canvas.style.height=`${i}px`}}loadMedia(e){this.mediaElements=e;let t=e.length===this.inputCount;this.drawListeners.forEach((e=>e())),this.textures.forEach((e=>e.dispose())),this.textures=[],e.forEach(((e,i)=>{if(!e)return void(t=!1);if(this.isWebGl)try{const t=qe(this.gl,e,i,this.shader.program);this.textures.push(t)}catch(e){this.create2D()}e.addEventListener("canvasdraw",this.render),this.drawListeners.push((()=>e.removeEventListener("canvasdraw",this.render)));const n=e;this.renderOnPlay&&"function"==typeof n.play&&(n.onplay=()=>{if(this.#a("onplay"),"requestVideoFrameCallback"in HTMLVideoElement.prototype){const e=()=>{this.render(),n.paused||n.requestVideoFrameCallback(e)};n.requestVideoFrameCallback(e)}else{const e=()=>{cancelAnimationFrame(this.timer),this.render(),n.paused||(this.timer=requestAnimationFrame(e))};this.timer=requestAnimationFrame(e)}},n.onpause=()=>{this.#a("onpause")},n.onplaying=()=>this.#a("onplaying"),n.onended=()=>this.#a("onended"),n.onseeked=()=>this.render())})),this.setDimensions(this.mediaElements),this.hasAllInputs=t,this.render()}loadShader(e="#version 300 es\nprecision highp float;\nin vec2 vTextureCoord;\nuniform sampler2D uTexture0;\nuniform int uTonemapper;\nuniform float uGamma;\nuniform float uExposure;\nout vec4 color;\n\nvoid main()\n{\n      color = texture(uTexture0, vTextureCoord);\n\n      if (uTonemapper == 0) {\n         float invGamma = 1.0 / uGamma;\n         float exposure = uExposure;\n         color.r = exposure * pow(color.r, invGamma);\n         color.g = exposure * pow(color.g, invGamma);\n         color.b = exposure * pow(color.b, invGamma);\n      }\n}",t=1,i={}){this.isWebGl&&(this.shaderSettings=i,this.inputCount=t,this.shader=Ge(this.gl,e))}switchCanvas=()=>{if(!this.canvas||!this.canvas.parentNode)return null;const e=this.canvas.cloneNode(!1);return this.canvas.parentNode.replaceChild(e,this.canvas),e.id=a(),e.className="canvas",this.disposed||this.switchCanvasCallbacks.forEach((e=>e())),e};onSwitchCanvas(e){this.switchCanvasCallbacks.push(e)}createWebGl(){this.isWebGl=!0,this.canvas=this.switchCanvas(),this.gl=this.canvas.getContext("webgl2",{preserveDrawingBuffer:!0,alpha:!0,antialias:!1}),this.gl?(this.gl.getExtension("EXT_color_buffer_float"),this.gl.getExtension("EXT_float_blend"),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.loadShader(),this.loadMedia(this.mediaElements)):this.create2D()}create2D(){this.disposeGL(),this.isWebGl=!1,this.canvas=this.switchCanvas(),this.canvas&&(this.gl=this.canvas.getContext("2d",{alpha:!0,preserveDrawingBuffer:!0,antialias:!1,imageSmoothingEnabled:!1}),this.gl.imageSmoothingEnabled=!1,this.render())}disposeGL(){if(!this.isWebGl||!this.gl)return;const e=this.gl;e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),this.textures.forEach((e=>e.dispose())),this.shader&&this.shader.dispose()}dispose(){this.disposed=!0,this.drawListeners.forEach((e=>e())),Object.keys(this.#n).forEach((e=>{this.#n[`${e}`]={}})),this.disposeGL(),this.switchCanvas()}}const Ye={grid:{onChange(e){const t=4*e;this.styleString=e?`background-size:${t}em ${t}em, ${t}em ${t}em;`:"display:none;"}},styleString:{}},Xe=x(Ye),je=w('<div class="grid" bind-attr-stylestring="style"></div>',':host(grid-overlay){height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.grid{background-image:linear-gradient(180deg,hsla(0,0%,88%,.4) .05rem,transparent 0),linear-gradient(90deg,hsla(0,0%,88%,.4) .05rem,transparent 0);background-repeat:round;content:"";height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}');E("grid-overlay",class extends v{static get observedAttributes(){return Xe}_stateConfigs=Ye;grid=0;styleString="";constructor(){super(),C(this,je)}});const Ze={visible:{formatter:$},scrim:{formatter:H},message:{onChange(e){this.clearText(),this.appendChild(y({tag:"span",properties:{textContent:e}}))}}},Ke=x(Ze);E("spinner-element",class extends v{static get observedAttributes(){return Ke}_stateConfigs=Ze;visible=!0;scrim=!1;message="";constructor(){super(),C(this,w('<div class="spinner" bind-attr-visible="data-show" bind-attr-scrim="data-scrim"><span class="text"><slot></slot></span></div>','@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}:host{height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.spinner{align-items:center;color:#76b900;display:none;height:100%;justify-content:center;left:0;pointer-events:none;position:absolute;top:0;width:100%}.spinner[data-show=true]{display:flex;pointer-events:all}.spinner[data-show=true][data-scrim=true]{background-color:hsla(0,0%,7%,.9)}.spinner:after,.spinner:before{border:.25em solid;border-radius:50%;content:"";height:5em;left:2.75em;min-height:5em;min-width:5em;position:relative;width:5em}.spinner:before{opacity:.25}.spinner:after{-webkit-animation:spin 1s linear infinite;animation:spin 1s linear infinite;border-bottom-color:transparent;border-left-color:transparent;border-right-color:transparent;left:-2.75em}.spinner .text{color:#fff;position:absolute;top:calc(50% + 5em)}'))}clearText(){this.innerHTML=""}});const Je={antiAlias:{formatter:H,onChange(e){const t=this.canvas();t&&(e?t.style.imageRendering="auto":t.style.removeProperty("image-rendering"),this.renderer&&this.renderer.render())}},boomerang:{formatter:H},exposure:{formatter:_(1),onChange(e){this.renderer&&(this.renderer.shaderSettings={...this.renderer.shaderSettings,exposure:{name:"exposure",value:e,type:"float"}},this.renderer.render())}},extension:{},fps:{formatter:_(0)},gamma:{formatter:_(1),onChange(e){this.renderer&&(this.renderer.shaderSettings={...this.renderer.shaderSettings,gamma:{name:"gamma",value:e,type:"float"}},this.renderer.render())}},grid:{formatter:_(0)},index:{formatter:_(0)},loading:{formatter:$},errored:{formatter:H},position:{onChange(){this.resize()}},mediaPosition:{onChange(){this.resize()}},quickTimeUpdate:{formatter:H},speed:{formatter:_(1),onChange(e){this.mediaElement&&this.mediaElement instanceof HTMLVideoElement&&(this.mediaElement.playbackRate=e)}},mute:{formatter:$,onChange(e){this.mediaElement&&this.mediaElement instanceof HTMLVideoElement&&(this.mediaElement.muted=e)}},time:{formatter:_(0)},type:{},layout:{onChange(){this.setViewport()}},viewportWidth:{onChange(){this.setViewport()}}},Qe=x(Je).concat(["webgl"]),et=w('<div id="media-player" bind-events="pointerdown:handleDrag" bind-attr-layout="data-layout" bind-attr-index="data-index"><div class="media-player-canvas-container"><spinner-element bind-prop-loading="visible"></spinner-element><div class="media-error" bind-attr-errored="data-show">Media load error</div><div id="canvas-container" bind-attr-showalpha="data-show-alpha"><canvas class="canvas"></canvas></div><div id="media-element-container"></div><grid-overlay bind-prop-grid="grid"></grid-overlay></div></div>',':host(media-player){cursor:-webkit-grab;cursor:grab;display:block;height:100%;position:relative;width:100%}#media-player{cursor:-webkit-grab;cursor:grab;height:100%;overflow:hidden;pointer-events:all;position:absolute;width:100%}#media-player .media-error{align-items:center;color:#a10005;display:none;height:100%;justify-content:center;left:0;position:absolute;text-transform:uppercase;top:0;width:100%}#media-player .media-error[data-show=true]{display:flex}#media-player #canvas-container{-ms-interpolation-mode:nearest-neighbor;background-color:#000;display:inline-block;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:pixelated;-webkit-transform-origin:0 0;transform-origin:0 0}#media-player #canvas-container[data-show-alpha=true]:before{background:repeating-conic-gradient(#000 0 25%,#eee 0 50%) 50%/60px 60px;content:"";height:100%;left:0;opacity:.2;position:absolute;top:0;width:100%}#media-player #canvas-container .canvas{-ms-interpolation-mode:nearest-neighbor;display:block;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:pixelated;position:relative}#media-player #canvas-container #pixel-grid{background-image:linear-gradient(90deg,#fff .065px,transparent 0),linear-gradient(180deg,#fff .065px,transparent 0);background-position:0 0;background-size:1px 1px;height:100%;left:0;opacity:0;pointer-events:none;position:absolute;top:0;transition:opacity .2s;width:100%}#media-player #canvas-container #pixel-grid[data-show=true]{opacity:.33}#media-player[data-layout=split]{overflow:hidden;position:absolute;width:0}#media-player[data-layout=split][data-index="0"],#media-player[data-layout=split][data-index="1"]{width:100%}#media-player[data-layout=split][data-index="0"]{left:0}#media-player[data-layout=split][data-index="1"]{right:0}#media-element-container{pointer-events:none}#media-element-container img,#media-element-container video{height:1px;left:0;pointer-events:none;position:absolute;top:0;width:1px}'),tt=e=>!!e&&"VIDEO"===e.tagName;E("media-player",class extends v{static get observedAttributes(){return Qe}_stateConfigs=Je;renderer=null;ready=!1;antiAlias=!1;boomerang=!1;boomerangDirection=1;errored=!1;exposure=1;extension="";fps=0;gamma=1;grid=0;index=0;layout="";loading=!0;mediaElement;mediaPosition={x:0,y:0,z:100};position={x:0,y:0,z:100};quickTimeUpdate=!1;mute=!0;speed=1;time=0;type="";viewportWidth=0;#t=!0;get webgl(){return this.renderer?this.renderer.isWebGl:this.#t}set webgl(e){const t=$(e);this.#t!==t&&(this.#t=t,this.renderer&&this.renderer.updateWebGl(t))}#o=!1;get showSourceElement(){return this.#o}set showSourceElement(e){const t=H(e);if(this.#o===t)return;this.#o=t;const i=this.shadowRoot.getElementById("media-element-container");if(t)try{i.style.display="block",i.appendChild(this.mediaElement)}catch(e){}else i.style.display="none"}useCanvas=!0;timer;playing=!1;#s=[];constructor(){super(),C(this,et)}canvasContainer(){return this.shadowRoot.getElementById("canvas-container")}canvas(){return this.shadowRoot.querySelector(".canvas")}root(){return this.shadowRoot.getElementById("media-player")}resize=()=>{if(!this.mediaElement||!this.mediaPosition||!this.position)return;const e=this.canvasContainer();if(!e)return;const t=this.position.z/100*(this.mediaPosition.z/100);e.style.transform=`scale(${t},${t}) translate(${(this.position.x+this.mediaPosition.x)/t}px, ${(this.position.y+this.mediaPosition.y)/t}px)`};loadSrc=async(e="",t="")=>{const i=this.type;if(!i)return Promise.resolve();if(this.ready=!1,this.mediaElement){if(e===this.mediaElement.src)return this.ready=!0,Promise.resolve()}else if(i)try{this.loading=!0,this.mediaElement=await $e(e,i,t||this.extension),this.loading=!1,this.shadowRoot.getElementById("media-element-container").appendChild(this.mediaElement),tt(this.mediaElement)&&(this.mediaElement.playbackRate=this.speed)}catch(e){this.loading=!1,this.errored=!0,this.dispatchEvent(new CustomEvent("mediaerror",{bubbles:!0,composed:!0,detail:{id:this.id,error:e}}))}else console.warn("No media element",i,e);!this.renderer&&this.mediaElement&&this.initRender(),this.resize(),this.renderReady()};getSrc(){return!this.renderer&&this.useCanvas?"":this.mediaElement?this.mediaElement.src:""}play=async()=>"video"!==this.type?Promise.resolve():new Promise((e=>{if(!tt(this.mediaElement))return void e(void 0);const t=this.mediaElement;if(t&&"video"===this.type&&(t.playbackRate=this.speed),!t.paused)return void e(void 0);t.onplaying=()=>{t.onplaying=null,e(void 0)},this.playing=!0,t.play();const i=()=>{clearTimeout(this.timer),cancelAnimationFrame(this.timer),this.boomerang&&-1===this.boomerangDirection&&(t.currentTime=t.currentTime-.05),this.renderer?this.renderer.render():this.useCanvas||this.mediaElement.dispatchEvent(new CustomEvent("canvasdraw",{bubbles:!0,composed:!0,detail:this.mediaElement})),this.boomerang&&-1===this.boomerangDirection?this.timer=setTimeout(i,30):this.playing&&(this.timer=requestAnimationFrame(i))};this.timer=requestAnimationFrame(i)}));pause=async()=>"video"!==this.type?Promise.resolve():new Promise((e=>{const t=()=>e(void 0);if(!tt(this.mediaElement))return void t();const i=this.mediaElement;i.paused?t():(clearTimeout(this.timer),cancelAnimationFrame(this.timer),this.playing=!1,i.pause(),this.internalSeek(i.currentTime).then(t))}));internalSeek(e){return new Promise((t=>{const i=this.mediaElement,n=()=>{o(),t(void 0)},a=()=>{this.renderer&&this.renderer.render(),n()},o=()=>{i&&i.removeEventListener("seeked",a)};if(!tt(this.mediaElement))return void n();i.addEventListener("seeked",a);const s=L(this.fps),r=Math.round(e/s);i.currentTime=r*s,i.seeking||n()}))}seek=async e=>tt(this.mediaElement)?(await this.pause(),this.internalSeek(e)):Promise.resolve();currentTime(){if(!tt(this.mediaElement))return 0;const e=L(this.fps),t=this.mediaElement;return Math.round(t.currentTime/e)*e}onTime(e){if(!this.renderer&&this.useCanvas)return()=>{};let t;if(this.quickTimeUpdate){let i=!1;const n=this.mediaElement,a=()=>{const t=()=>{i||requestAnimationFrame((()=>{e(this.currentTime(),n.ended),t()}))};t()};n.addEventListener("play",a),t=()=>{i=!0,n.removeEventListener("play",a)}}else t=this.addVideoEvent("timeupdate",e);const i=this.addVideoEvent("ended",e);return()=>{t(),i()}}addVideoEvent(e,t){if(!tt(this.mediaElement)||"function"!=typeof t)return()=>{};const i=this.mediaElement,n=()=>t(this.currentTime(),i.ended);return i.addEventListener(e,n),()=>i.removeEventListener(e,n)}screenshot(){return this.canvas().toDataURL("image/png")}handleDrag=e=>{e.preventDefault(),this.dispatchEvent(new CustomEvent("dragstartcanvas",{bubbles:!0,composed:!0,detail:{clientX:e.clientX,clientY:e.clientY}}))};initRender=()=>{if(!this.useCanvas){const e=this.mediaElement;e.muted=this.mute,e.className="canvas";const t=this.canvas();return void(t!==e&&t.parentElement.replaceChild(e,t))}const e=this.canvas();this.renderer=new We(e,this.webgl),this.renderer.onSwitchCanvas((()=>{this.resize()})),this.renderer.loadShader(),this.renderer.loadMedia([this.mediaElement]),this.renderer.shaderSettings={exposure:{name:"exposure",value:1,type:"float"},gamma:{name:"gamma",value:1,type:"float"}};this.mediaElement.muted=this.mute};renderReady=()=>{this.ready=!0,this.dispatchEvent(new CustomEvent("rendererready",{bubbles:!0,composed:!0,detail:this}));const e=this.mediaElement,t=()=>this.dispatchEvent(new CustomEvent("icat-player-playing",{bubbles:!0,composed:!0,detail:this})),i=()=>this.dispatchEvent(new CustomEvent("icat-player-paused",{bubbles:!0,composed:!0,detail:this})),n=()=>{try{B.logError("The media player has stalled")}catch(e){}},a=()=>{try{B.logError("The media player has been emptied")}catch(e){}};e.addEventListener("play",t),this.#s.push((()=>e.removeEventListener("play",t))),e.addEventListener("pause",i),this.#s.push((()=>e.removeEventListener("pause",i))),e.addEventListener("stalled",n),this.#s.push((()=>e.removeEventListener("stalled",n))),e.addEventListener("emptied",a),this.#s.push((()=>e.removeEventListener("emptied",a)))};setViewport=()=>{this.root().style.width="split"===this.layout?`${this.viewportWidth}px`:"100%"};attached(){try{this.webgl=JSON.parse(this.getAttribute("webgl"))}catch(e){}try{this.showSourceElement=JSON.parse(this.getAttribute("showSourceElement"))}catch(e){}this.setViewport()}detached(){this.#s.forEach((e=>{try{e()}catch(e){}})),this.renderer&&(this.renderer.dispose(),this.renderer=null),B.deleteMediaElement(this.mediaElement);const e=this._state.src;e&&e.complete(),delete this._state.src}});const it=(e,t=100)=>{let i=null;return(...n)=>{null===i&&(i=setTimeout((()=>{e(...n),i=null}),t))}};const nt={isDragging:{attribute:!1,formatter:H},split:{formatter:_(.5),onChange(e){this.container().style.left=`calc(${100*e}% - 5px)`}}},at=x(nt),ot=w('<div id="split-screen-handle" bind-events="pointerdown:handleDragStart" bind-attr-isdragging="data-dragging"><div id="split-screen-handle-content"><div class="split-screen-handle-box"></div><div class="split-screen-handle-line"></div></div></div>','#split-screen-handle{align-items:center;cursor:-webkit-grab;cursor:grab;height:100%;justify-content:center;position:absolute;top:0;width:10px}#split-screen-handle #split-screen-handle-content{align-items:center;display:flex;height:100%;justify-content:center;position:relative;width:100%}#split-screen-handle #split-screen-handle-content .split-screen-handle-line{background-color:#bbb;height:100%;position:absolute;transition:background-color .2s;width:1px}#split-screen-handle #split-screen-handle-content .split-screen-handle-box{background-color:#bbb;border-radius:50%;box-shadow:0 10px 20px -10px #000,inset 0 0 0 1px #eee;height:2.25em;left:0;min-width:2.25em;position:relative;-webkit-transform:scale(.95);transform:scale(.95);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;transition:background-color .2s,-webkit-transform .2s;transition:transform .2s,background-color .2s;transition:transform .2s,background-color .2s,-webkit-transform .2s;width:2.25em}#split-screen-handle #split-screen-handle-content .split-screen-handle-box:after,#split-screen-handle #split-screen-handle-content .split-screen-handle-box:before{border-bottom-style:solid;border-bottom-width:0;border-left-style:solid;border-left-width:0;border-right:.125em solid #000;border-top:.125em solid #000;content:"";height:.5em;position:absolute;top:calc(50% - .3em);transition:-webkit-transform .2s;transition:transform .2s;transition:transform .2s,-webkit-transform .2s;width:.5em}#split-screen-handle #split-screen-handle-content .split-screen-handle-box:before{left:1.1em;-webkit-transform:rotate(45deg) scale(.87);transform:rotate(45deg) scale(.87)}#split-screen-handle #split-screen-handle-content .split-screen-handle-box:after{left:.5em;-webkit-transform:rotate(-135deg) scale(.87);transform:rotate(-135deg) scale(.87)}#split-screen-handle #split-screen-handle-content:hover .split-screen-handle-box,#split-screen-handle #split-screen-handle-content:hover .split-screen-handle-line,#split-screen-handle #split-screen-handle-content[data-dragging=true] .split-screen-handle-box,#split-screen-handle #split-screen-handle-content[data-dragging=true] .split-screen-handle-line{background-color:#fff}#split-screen-handle #split-screen-handle-content:hover .split-screen-handle-box,#split-screen-handle #split-screen-handle-content[data-dragging=true] .split-screen-handle-box{-webkit-transform:scale(1.1);transform:scale(1.1)}');function st(e){return e<0?"-":e>0?"+":""}E("split-handle",class extends v{static get observedAttributes(){return at}_stateConfigs=nt;isDragging=!1;split=.5;constructor(){super(),C(this,ot)}container(){return this.shadowRoot.getElementById("split-screen-handle")}handleDragStart=e=>{const t=it((e=>{e.preventDefault();const t=this.getBoundingClientRect();this.dispatchEvent(new CustomEvent("splitupdate",{bubbles:!0,composed:!0,detail:Math.min(.99,Math.max(.01,(e.clientX-t.left)/t.width))}))}),10),i=e=>{e.preventDefault(),document.body.style.removeProperty("user-select"),this.isDragging=!1,window.removeEventListener("pointermove",t),document.removeEventListener("pointerup",i),document.removeEventListener("pointerleave",i)};e.preventDefault(),document.body.style.userSelect="none",this.isDragging=!0,window.addEventListener("pointermove",t),document.addEventListener("pointerup",i),document.addEventListener("pointerleave",i)}});const rt=["row","column",""],lt=(e,t)=>{const i=(e=>`input-element-${e}-container`)(e);return-1===t.indexOf(i)&&t.push(i),t.join(" ")},dt=e=>{if(void 0===e)return null;if(!Number.isNaN(e)&&"string"!=typeof e)return e;const t=parseFloat(e);return Number.isNaN(t)?null:t},ct=(e,t,i)=>{e&&e[null==i||!1===i?"removeAttribute":"setAttribute"](t,i)},ht=e=>Array.isArray(e)?e:"string"==typeof e?(e||"").split(" ").map((e=>e.trim())).filter((e=>!!e)):[],ut={classes:{formatter:ht,onChange(e){this.classString=e.join(" ")}},classString:{attribute:!1},computedValue:{matchType:!1,attribute:!1},disabled:{formatter:H,onChange(){this.updateDisabledText()}},disabledText:{onChange(){this.updateDisabledText()}},disabledTextShow:{formatter:H},dropdownAlign:{formatter:q(ye,ye[0])},dropdownDirection:{formatter:q(ve,ve[0])},dropdownFullwidth:{formatter:H},hasOptions:{formatter:H},help:{},isBool:{formatter:H},isRange:{formatter:H},label:{},labelposition:{formatter:q(rt,rt[0])},max:{matchType:!1,formatter:dt,onChange(){this.setMax()}},min:{matchType:!1,formatter:dt,onChange(){this.setMax()}},noInput:{formatter:H},options:{formatter:we,onChange(e){this.setComputedValue(),this.hasOptions=e&&e.length>0,this.setDropdownOptions()}},prefixText:{},prefixIcon:{},prefixIconSize:{onChange(e){this.shadowRoot.getElementById("prefix-icon").style.fontSize=e}},prefixClass:{formatter:ht,onChange(e){this.prefixClassString=lt("prefix",e)}},prefixClassString:{attribute:!1},readOnly:{formatter:H,onChange(){this.setReadOnly()}},smallLabel:{formatter:H},step:{matchType:!1,formatter:dt,onChange(){this.setStep()}},suffixText:{},suffixIcon:{},suffixClass:{formatter:ht,onChange(e){this.suffixClassString=lt("suffix",e)}},suffixClassString:{attribute:!1},trimValue:{formatter:_(0),onChange(){this.setComputedValue()}},type:{onChange(){this.setMax(),this.setMin(),this.setStep(),this.setSelectSuffixIcon(),this.setIsBool(),this.setDropdownClick()}},value:{matchType:!1,onChange(e){this.userValue=e,this.setComputedValue(),this.inputElement().value=e,this.dirty=!1}},nomargin:{formatter:H},nominheight:{formatter:H},slimpadding:{formatter:H},noinnerborders:{formatter:H},tighticons:{formatter:H},liveInput:{formatter:$},inlineEdit:{formatter:H},editing:{formatter:H},nobackground:{formatter:H}},mt=x(ut),pt=w('<div id="input-element-container" bind-attr-inlineedit="data-inline-edit" bind-attr-editing="data-editing" bind-attr-type="data-type" bind-attr-classstring="class" bind-attr-hasoptions="data-has-options" bind-attr-isrange="data-is-range" bind-attr-disabled="data-disabled" bind-attr-disabledtextshow="data-show-disabled-text" bind-attr-noinnerborders="data-no-inner-borders" bind-attr-slimpadding="data-slim-padding" bind-attr-nomargin="data-no-margin" bind-attr-nominheight="data-no-min-height" bind-attr-nobackground="data-no-background" bind-attr-tighticons="data-tight-icons"><div class="input-element-label-section" bind-attr-smalllabel="data-small" bind-events="click:toggleValue"><slot name="label"></slot><span bind-prop-label="textContent"></span> <span class="help-content" bind-attr-help="data-help-length:length"><slot name="help"></slot><span bind-prop-help="textContent"></span></span></div><div class="input-element-input-section" bind-attr-noinput="no-input"><div bind-attr-prefixclassstring="class" bind-attr-prefixicon="data-icon" bind-attr-prefixtext="data-text"><icon-element bind-prop-prefixicon="type" id="prefix-icon"></icon-element><span class="prefix-text" bind-prop-prefixtext="textContent"></span></div><span class="range" bind-events="pointerdown:handleRangeDrag"><span class="range-bar"></span> <span id="range-progress-bar"></span> <span id="range-handle"></span> </span><input bind-attr-type="type" bind-attr-computedvalue="value" id="input"> <span bind-prop-computedvalue="textContent" id="display-value"></span> <span class="disabled-text" bind-prop-disabledtext="textContent"></span> <span class="slider" bind-attr-computedvalue="data-value" bind-events="click:toggleValue"></span> <span class="checkbox-input" bind-attr-computedvalue="data-value" bind-events="click:toggleValue"></span> <span class="select-value" bind-prop-computedvalue="textContent"></span><div bind-attr-suffixclassstring="class" bind-attr-suffixicon="data-icon" bind-attr-suffixtext="data-text"><icon-element bind-prop-suffixicon="type"></icon-element><span class="suffix-text" bind-prop-suffixtext="textContent"></span></div><div class="input-buttons"><slot name="input-button"></slot></div></div><drop-down bind-prop-dropdownfullwidth="fullwidth" bind-prop-dropdownalign="alignment" bind-prop-dropdowndirection="direction" bind-prop-value="value" id="dropdown"></drop-down></div>',':host(input-element){display:block;max-width:25em;width:100%}#input-element-container{color:#eee;margin:0;min-width:100%;position:relative;width:auto}#input-element-container[data-is-ios=true] input{font-size:16px;padding:.125em .38em}#input-element-container[data-disabled=true]{opacity:.38;pointer-events:none}#input-element-container[data-disabled=true][data-show-disabled-text=true]{opacity:1;pointer-events:all}#input-element-container[data-disabled=true][data-show-disabled-text=true] .input-element-input-section{background-color:initial;box-shadow:none;min-height:0}#input-element-container[data-disabled=true][data-show-disabled-text=true] .input-element-input-section #input{display:none}#input-element-container[data-disabled=true][data-show-disabled-text=true] .input-element-input-section .disabled-text,#input-element-container[data-inline-edit=true] #display-value{display:block}#input-element-container[data-inline-edit=true] #input{background-color:initial;display:none}#input-element-container[data-inline-edit=true][data-editing=false] .input-element-input-section{background-color:initial;box-shadow:none}#input-element-container[data-inline-edit=true][data-editing=true] #display-value{display:none}#input-element-container[data-inline-edit=true][data-editing=true] #input{display:block}#input-element-container[data-inline-edit=true][data-editing=true] .input-element-input-section{background-color:#111}#input-element-container[data-no-background=true] .input-element-input-section{background-color:initial;box-shadow:none}#input-element-container[data-no-background=true] .select-value{background-color:initial}#input-element-container[data-no-background=true][data-type=select] .input-element-suffix-container[data-icon=chevron-down-select] icon-element{margin:0}#input-element-container #display-value{box-sizing:border-box;display:none;max-width:100%;overflow:hidden;padding:.0625em .25em;text-overflow:ellipsis;white-space:nowrap}#input-element-container .drop-down-option{padding:.25em 1em}#input-element-container .drop-down-option input-element{max-width:unset}#input-element-container .drop-down-option:first-of-type{border-radius:4px 4px 0 0}#input-element-container .drop-down-option:last-of-type{border-radius:0 0 4px 4px}#input-element-container .drop-down-option:only-child{border-radius:4px}#input-element-container .disabled-text{display:none;font-style:italic;line-height:100%;opacity:.38}#input-element-container .select-value{background-color:#424242;color:inherit;display:none;flex-grow:1;font-family:inherit;font-size:inherit;line-height:calc(100% + 2px);max-width:100%;overflow:hidden;padding:.5em;white-space:nowrap}#input-element-container .checkbox-input,#input-element-container .range,#input-element-container .slider{display:none}#input-element-container .input-element-label-section{line-height:120%;opacity:.75;text-align:left}#input-element-container .input-element-label-section[data-small=true]{font-size:75%}#input-element-container .help-content{position:relative;top:-.125em;vertical-align:middle}#input-element-container[data-type=select]{cursor:pointer}#input-element-container[data-type=select] input{display:none}#input-element-container[data-type=select] .select-value{display:flex}#input-element-container[data-type=checkbox],#input-element-container[data-type=toggle]{align-items:center;display:flex;margin:0 -.25em;width:calc(100% - .5em)}#input-element-container[data-type=checkbox] .input-element-input-section,#input-element-container[data-type=checkbox] .input-element-label-section,#input-element-container[data-type=toggle] .input-element-input-section,#input-element-container[data-type=toggle] .input-element-label-section{margin:.25em}#input-element-container[data-type=checkbox] .input-element-label-section,#input-element-container[data-type=toggle] .input-element-label-section{cursor:pointer;max-width:calc(100% - 4em);overflow:hidden;padding-bottom:0;padding-top:.25em;text-overflow:ellipsis;white-space:nowrap}#input-element-container[data-type=checkbox] .input-element-input-section,#input-element-container[data-type=toggle] .input-element-input-section{border-radius:1em;min-height:1.5em;position:relative}#input-element-container[data-type=checkbox] .input-element-input-section input,#input-element-container[data-type=toggle] .input-element-input-section input{height:0;opacity:0;padding:0;position:absolute;width:0;z-index:-1}#input-element-container[data-type=toggle]{justify-content:space-between}#input-element-container[data-type=toggle] .input-element-label-section{flex-grow:1}#input-element-container[data-type=toggle] .input-element-input-section .slider{align-self:stretch;background-color:#424242;border-radius:1em;cursor:pointer;display:inline-block;position:relative;transition:background-color .3s;width:2.75em}#input-element-container[data-type=toggle] .input-element-input-section .slider:after{background-color:#a2a2a2;border-radius:50%;box-shadow:inset 0 0 0 1px #bbb,1px 1px 3px #111;content:"";display:block;height:calc(100% - .35em);left:.25em;position:absolute;top:.175em;transition:left .2s;width:1.125em}#input-element-container[data-type=toggle] .input-element-input-section .slider[data-value=true]{background-color:#76b900}#input-element-container[data-type=toggle] .input-element-input-section .slider[data-value=true]:after,#input-element-container[data-type=toggle] .input-element-input-section .slider[data-value=true]:hover:after{background-color:#424242;box-shadow:0 0 0 1px #2b2b2b;left:1.35em}#input-element-container[data-type=checkbox]{margin-bottom:-.5em}#input-element-container[data-type=checkbox] .input-element-input-section{background-color:initial;box-shadow:none}#input-element-container[data-type=checkbox] .input-element-input-section .checkbox-input{cursor:pointer;display:block;height:1em;position:relative;width:1em}#input-element-container[data-type=checkbox] .input-element-input-section .checkbox-input:after,#input-element-container[data-type=checkbox] .input-element-input-section .checkbox-input:before{border-radius:2px;content:"";display:block;pointer-events:none;position:absolute;transition:opacity .2s}#input-element-container[data-type=checkbox] .input-element-input-section .checkbox-input:before{background-color:#bbb;box-shadow:inset 0 0 0 1px #eee;height:100%;left:0;top:0;width:100%}#input-element-container[data-type=checkbox] .input-element-input-section .checkbox-input:after{border-bottom:.2em solid #fff;border-left:.2em solid #fff;box-sizing:border-box;height:.35em;left:.2em;opacity:0;top:.25em;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);width:.62em}#input-element-container[data-type=checkbox] .input-element-input-section .checkbox-input[data-value=true]:before{background-color:#76b900;box-shadow:inset 0 0 0 1px #84d100}#input-element-container[data-type=checkbox] .input-element-input-section .checkbox-input[data-value=true]:after{opacity:1}#input-element-container[data-has-options=true] input[readonly=true]{cursor:pointer}#input-element-container[data-is-range=true] .input-element-input-section input{background:rgba(43,43,43,.38);border-radius:4px;flex-grow:0;margin-left:.25em;max-width:5em;min-width:5em;text-align:right;width:5em}#input-element-container[data-is-range=true] .input-element-input-section .range{box-sizing:border-box;cursor:-webkit-grab;cursor:grab;display:block;flex-grow:1;margin:0 .5em;padding:.5em;position:relative;width:100%}#input-element-container[data-is-range=true] .input-element-input-section .range .range-bar{background-color:#bbb;display:block;height:1px;left:0;position:absolute;top:calc(50% - 1px);width:100%}#input-element-container[data-is-range=true] .input-element-input-section .range #range-progress-bar{background-color:#76b900;display:block;height:4px;left:0;position:absolute;top:calc(50% - 2px);width:0}#input-element-container[data-is-range=true] .input-element-input-section .range #range-handle{background-color:#eee;border-radius:50%;display:block;height:1em;left:0;position:absolute;top:calc(50% - .5em);width:1em}#input-element-container[data-no-min-height=true] .input-element-input-section{min-height:0}#input-element-container[data-no-margin=true] .input-element-input-section{margin:0}#input-element-container[data-slim-padding=true] .input-element-input-section input{padding:.25em}#input-element-container[data-slim-padding=true] .select-value{line-height:100%}#input-element-container[data-no-inner-borders=true] .input-element-prefix-container,#input-element-container[data-no-inner-borders=true] .input-element-suffix-container{box-shadow:none}#input-element-container[data-tight-icons=true] .input-element-prefix-container icon-element:not([type=""]){margin-right:0}#input-element-container[data-tight-icons=true] .input-element-prefix-container[data-icon=speed] icon-element{margin-right:.25em}#input-element-container[data-tight-icons=true] .input-element-suffix-container icon-element:not([type=""]){margin-left:0;margin-right:.25em}#input-element-container .input-element-input-section{align-items:center;background-color:#424242;border-radius:2px;box-shadow:0 0 0 1px #616161;display:flex;margin:.25em 0;min-height:2.5em}#input-element-container .input-element-input-section[no-input=true] input{display:none}#input-element-container .input-element-prefix-container,#input-element-container .input-element-suffix-container{align-items:center;align-self:stretch;box-shadow:inset -1px 0 0 0 #616161;cursor:pointer;display:flex;line-height:100%;padding-top:.5px}#input-element-container .input-element-prefix-container .icon-container,#input-element-container .input-element-suffix-container .icon-container{font-size:.75em}#input-element-container .input-element-prefix-container .icon-container,#input-element-container .input-element-prefix-container .input-element-prefix-text,#input-element-container .input-element-prefix-container .input-element-suffix-text,#input-element-container .input-element-suffix-container .icon-container,#input-element-container .input-element-suffix-container .input-element-prefix-text,#input-element-container .input-element-suffix-container .input-element-suffix-text{line-height:100%;padding:.5em}#input-element-container .input-element-prefix-container icon-element,#input-element-container .input-element-suffix-container icon-element{margin-right:.5em}#input-element-container .input-element-prefix-container icon-element[type=""],#input-element-container .input-element-suffix-container icon-element[type=""]{display:none}#input-element-container .input-element-prefix-container icon-element:not([type=""]),#input-element-container .input-element-suffix-container icon-element:not([type=""]){margin-left:.38em}#input-element-container .input-element-prefix-container .prefix-text,#input-element-container .input-element-prefix-container .suffix-text,#input-element-container .input-element-suffix-container .prefix-text,#input-element-container .input-element-suffix-container .suffix-text{margin-left:.5em;margin-right:.5em}#input-element-container .input-element-prefix-container .prefix-text:empty,#input-element-container .input-element-prefix-container .suffix-text:empty,#input-element-container .input-element-suffix-container .prefix-text:empty,#input-element-container .input-element-suffix-container .suffix-text:empty{display:none}#input-element-container .input-element-prefix-container.dim,#input-element-container .input-element-suffix-container.dim{opacity:.5}#input-element-container .input-element-prefix-container.small-icon icon-element,#input-element-container .input-element-suffix-container.small-icon icon-element{font-size:.62em}#input-element-container .input-element-prefix-container.medium-icon icon-element,#input-element-container .input-element-suffix-container.medium-icon icon-element{font-size:1.125em}#input-element-container .input-element-prefix-container.large-icon icon-element,#input-element-container .input-element-suffix-container.large-icon icon-element{font-size:1.38em}#input-element-container .input-element-prefix-container[data-icon=""][data-text=""],#input-element-container .input-element-suffix-container[data-icon=""][data-text=""]{display:none}#input-element-container .input-element-prefix-container:not([data-icon=""]) .prefix-text,#input-element-container .input-element-prefix-container:not([data-icon=""]) .suffix-text,#input-element-container .input-element-suffix-container:not([data-icon=""]) .prefix-text,#input-element-container .input-element-suffix-container:not([data-icon=""]) .suffix-text{margin-left:.25em}#input-element-container .input-element-suffix-container{box-shadow:inset 1px 0 0 0 #616161;padding-left:1px}#input-element-container .input-element-suffix-container icon-element:not([type=""]){margin-left:.5em}#input-element-container .input-element-prefix-container+.input-element-suffix-container{box-shadow:none}#input-element-container input{background-color:#424242;border:none;box-sizing:border-box;color:inherit;display:block;flex-grow:1;font-family:inherit;font-size:inherit;line-height:150%;outline:none!important;padding:.5em;width:100%}#input-element-container input::-webkit-inner-spin-button,#input-element-container input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}#input-element-container input[type=number]{-moz-appearance:textfield}#input-element-container input.has-suffix{padding-right:0}#input-element-container.short-input input{max-width:4.5em}#input-element-container.medium-short-input input{max-width:3.5em}#input-element-container.very-short-input input{max-width:2.7em}#input-element-container .input-buttons{align-items:center;display:flex;justify-content:center}#input-element-container drop-down{position:absolute}.help-content{font-size:90%;font-style:italic;opacity:.75}');E("input-element",class extends v{static get observedAttributes(){return mt}_stateConfigs=ut;handleBox;dropdownClickEvent=()=>{};nobackground=!1;classes=[];classString="";computedValue="";disabled=!1;disabledText="";disabledTextShow=!1;dropdownAlign=ye[0];dropdownDirection=ve[0];dropdownFullwidth=!0;hasOptions=!1;help="";isBool=!1;isRange=!1;label="";labelposition=rt[0];max=null;min=null;noInput=!1;options=[];prefixText="";prefixIcon="";prefixIconSize="";prefixClass=[];prefixClassString="";readOnly=!1;smallLabel=!1;step=null;suffixText="";suffixIcon="";suffixClass=[];suffixClassString="";trimValue=0;type="";value="";nomargin=!1;nominheight=!1;slimpadding=!1;noinnerborders=!1;tighticons=!1;liveInput=!0;focused=!1;previousValue="";inlineEdit=!1;editing=!1;dirty=!1;userValue="";constructor(){super(),C(this,pt)}get isMultiSelect(){return"checkboxes-dropdown"===this.type||"toggles-dropdown"===this.type}inputElement(){return this.shadowRoot.getElementById("input")}container(){return this.shadowRoot.getElementById("input-element-container")}dropdown(){return this.shadowRoot.getElementById("dropdown")}setDropdownClick(){this.dropdown().closeOnClick=!this.isMultiSelect}setDropdownOptions(){const e=this.isMultiSelect,t=this.dropdown(),i=this.options;if(e){const e=i.reduce(((e,t)=>Math.max(e,(t.label||"").length)),0);t.minWidth=.5*e+6+"em",k({container:t,array:i,getElementsFn:()=>Array.from(t.querySelectorAll('[slot="drop-down-option"]')),valueKeyFn:e=>e.id,elementValueKeyFn:e=>e.id,updateFn:(e,t)=>{const i=e.querySelector("icon-element"),n=e.querySelector("input-element");t.icon?t.icon&&!i&&n&&e.insertBefore(y({tag:"icon-element",properties:{type:t.icon}}),n):i&&i.parentElement.removeChild(i),n&&(n.label=t.label,n.value=t.value)},createFn:e=>{const t=[];return e.icon&&t.push(y({tag:"icon-element",properties:{type:e.icon}})),t.push(y({tag:"input-element",properties:{type:"toggle",label:e.label,value:e.value,id:e.id}})),y({tag:"div",attributes:{class:"drop-down-option",id:e.id,slot:"drop-down-option"},children:t})}})}else t.options=this.options}setMax(){const e="number"===this.type?"max":"maxlength";ct(this.inputElement(),e,this.max),this.setIsRange()}setMin(){const e="number"===this.type?"min":"minlength";ct(this.inputElement(),e,this.min),this.setIsRange()}setStep(){ct(this.inputElement(),"step",this.step)}setReadOnly(){ct(this.inputElement(),"readonly",this.readOnly)}setComputedValue(){this.computedValue=((e,t,i=0)=>{let n=e;if(t&&t.length){-1===t.findIndex((e=>"number"!=typeof e.value))&&(n=Number(n));const e=t[t.findIndex((e=>e.value===n))];let a=void 0===n?"":n;return e&&(e.displayValue?a=e.value:void 0!==e.label&&(a=e.label)),i&&a.length>i?`${a.slice(0,i)}...`:a}return e})(this.userValue,this.options,this.trimValue),this.rangeStyles()}setSelectSuffixIcon(){let e=this.suffixIcon;"select"!==this.type||this.suffixIcon?"select"!==this.type&&"chevron-down-select"===this.suffixIcon&&(e=""):e="chevron-down-select",this.suffixIcon=e}setIsRange(){const e=e=>null!==e&&!Number.isNaN(e)&&"string"!=typeof e;this.isRange=e(this.max)&&e(this.min)&&"number"===this.type}setIsBool(){this.isBool="toggle"===this.type||"checkbox"===this.type}getValue(){const e=this.inputElement();if("number"===this.type){let t=e.value;return(Number.isNaN(e.value)||"string"==typeof t)&&(t=100*e.value/100),null!==this.step&&(t-=t%this.step),null!==this.max&&t>this.max&&(t=this.max),null!==this.min&&t<this.min&&(t=this.min),t}if(this.isBool)try{return JSON.parse(e.value)}catch(e){return!1}if(this.options.length){if(-1===this.options.findIndex((e=>"number"!=typeof e.value)))return Number(e.value)}return e.value}sendInputEvent(){this.dispatchEvent(new CustomEvent("input",{bubbles:!0,composed:!0,detail:this})),this.dispatchEvent(new CustomEvent("inputvalue",{bubbles:!0,composed:!0,detail:this}))}sendFocusEvent(){this.focused||(this.focused=!0,this.editing=!0,this.previousValue=this.getValue(),this.dispatchEvent(new CustomEvent("inputfocus",{bubbles:!0,composed:!0,detail:this})))}sendBlurEvent(){this.focused&&(this.focused=!1,this.editing=!1,requestAnimationFrame((()=>{const e=this.dropdown();e&&this.hasOptions&&e.visible&&(e.visible=!1),this.dispatchEvent(new CustomEvent("inputblur",{bubbles:!0,composed:!0,detail:this})),this.inlineEdit&&this.dirty&&this.sendInputEvent()})))}toggleValue=()=>{if(!this.isBool)return;this.inputElement().value=!this.userValue,this.sendInputEvent()};handleRangeDrag=e=>{e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),document.body.style.userSelect="none";const t=this.inputElement(),{width:i,left:n}=this.shadowRoot.querySelector(".range-bar").getBoundingClientRect();this.setHandleBox();const a=this.step,o=this.min,s=this.max;if(null===s||null===o)return;const r=it((e=>{const r=Math.min(1,Math.max(0,(e.clientX-n)/i)),l=(s-o)*r;t.value=a?l-l%a:l,this.sendInputEvent()}),100),l=e=>{e.preventDefault(),document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",r),document.removeEventListener("pointerup",l),document.removeEventListener("pointerleave",l)};r(e),window.addEventListener("pointermove",r),document.addEventListener("pointerup",l),document.addEventListener("pointerleave",l)};rangeStyles(){if(null===this.max||null===this.min)return{};this.handleBox||this.setHandleBox();const e=this.getRangePercent(),t=`calc(${e}% - ${this.handleBox.width/2}px)`,i=`${e}%`;this.shadowRoot.getElementById("range-handle").style.left=t,this.shadowRoot.getElementById("range-progress-bar").style.width=i}setHandleBox(){this.handleBox=this.shadowRoot.getElementById("range-handle").getBoundingClientRect()}getRangePercent(){if(null===this.max||null===this.min)return;const e=this.max-this.min;return(Number.isNaN(this.userValue)||"string"==typeof this.userValue?parseFloat(this.userValue):this.userValue)/e*100}updateDisabledText(){this.disabledTextShow=!!this.disabled&&!!this.disabledText}focus(){try{this.inputElement().focus()}catch(e){}this.sendFocusEvent()}attached(){try{this.dropdownClickEvent()}catch(e){}const t=this.inputElement(),i=this.container(),n=this.dropdown();i.setAttribute("data-is-ios",B.iOS.toString());const a=e=>{t.value=e.detail.value,this.sendInputEvent()};i?(i.onclick=e=>{if(this.inlineEdit)return;if("toggle"!==this.type)try{t.focus()}catch(e){}this.sendFocusEvent();const i=n.visible;ce(n,e)&&this.isMultiSelect&&i||requestAnimationFrame((()=>{this.options&&this.options.length&&("select"===this.type?n.visible=!i:n.visible=!0)}))},i.ondblclick=()=>{this.inlineEdit&&("toggle"!==this.type&&requestAnimationFrame((()=>{t.focus()})),this.sendFocusEvent())}):console.warn("Could not find container",this),t.oninput=e=>{this.dirty=!0,this.liveInput&&(this.userValue=e.target.value,this.sendInputEvent())},t.onblur=()=>{this.hasOptions||this.sendBlurEvent()},t.onkeydown=e=>{if(!this.liveInput)return"Enter"===e.key?(this.userValue=e.target.value,t.blur(),this.hasOptions&&this.sendBlurEvent(),this.sendInputEvent()):void("Escape"===e.key&&(this.userValue=this.previousValue,t.value=this.previousValue,t.blur(),this.hasOptions&&this.sendBlurEvent()))},this.dropdownClickEvent=()=>n.removeEventListener("dropdownclick",a),n.addEventListener("dropdownclick",a),e(this,"dropdownvisibility",(e=>{this.hasOptions&&(e.detail?this.sendFocusEvent():this.sendBlurEvent())}),n)}detached(){try{this.dropdownClickEvent()}catch(e){}}});var gt='<div class="media-meta-container" bind-attr-metadata="data-type:type" bind-attr-fullscreen="data-fullscreen" bind-attr-alignright="data-align-right" bind-attr-noselect="data-no-select"><div class="media-meta-container-inner"><div class="media-meta-labels"><span id="media-select"><input-element id="select-media-input" type="select" bind-prop-mediaid="value" bind-prop-options="options" dropdowndirection="up" bind-events="input:switchMedia" noinnerborders="true" nobackground="true" nomargin="true" nominheight="true"></input-element><span id="media-title" bind-prop-names="textContent:base"></span> </span><span class="mute-settings" bind-events="click:toggleMute" bind-attr-mute="data-muted"><icon-element bind-prop-audioicon="type"></icon-element></span><span class="optional-labels-container"><span class="optional-media-label" bind-attr-labels="data-show:duration" bind-prop-durationstring="textContent"></span> <span class="optional-media-label" bind-attr-labels="data-show:startTime" bind-prop-starttimestring="textContent"></span> <span class="optional-media-label" bind-attr-labels="data-show:fps" bind-prop-fpsstring="textContent"></span> <span class="optional-media-label" bind-attr-labels="data-show:dimensions" bind-prop-dimensionsstring="textContent"></span> <span class="optional-media-label" bind-attr-labels="data-show:codec" bind-prop-metadata="textContent:codec"></span> <span class="optional-media-label" bind-attr-labels="data-show:format" bind-prop-metadata="textContent:format"></span> <span class="optional-media-label" bind-attr-labels="data-show:bitrate" bind-prop-bitratestring="textContent"></span></span></div></div></div>',bt='.input-grid{align-items:flex-end;display:flex;flex-wrap:wrap;margin:0 -.5em}.input-grid .input-control{margin:.5em .5em 0}.input-grid .input-control:not(.btn-control){padding:0 0 .5em}.input-grid .btn-control{align-self:flex-end;margin-bottom:.75em}.input-grid.no-wrap{flex-wrap:nowrap}.short-input{max-width:6.18em}[slot=input-button]{font-size:85%;position:relative}[slot=input-button]:first-child:before{box-shadow:-1px 0 0 0;content:"";display:block;height:100%;opacity:.1;position:absolute;width:1px}:host{display:block;position:relative}.media-meta-container{max-width:100%;pointer-events:all;width:100%}.media-meta-container #select-media-input{font-size:1.071425em;margin-top:.35em;max-width:100%}.media-meta-container .media-meta-container-inner{position:relative;width:100%}.media-meta-container .media-meta-container-inner .media-meta-labels{align-items:flex-start;box-sizing:border-box;display:flex;flex-wrap:wrap;padding:.75em;width:100%}.media-meta-container .media-meta-container-inner .media-meta-labels .optional-labels-container{align-items:center;display:flex;flex-wrap:wrap;font-size:.75em;margin-top:.65em;opacity:.5}.media-meta-container .media-meta-container-inner .media-meta-labels .optional-labels-container>.optional-media-label{align-items:center;display:flex;flex-wrap:nowrap;margin-left:1em;white-space:nowrap}.media-meta-container .media-meta-container-inner .media-meta-labels .optional-labels-container>.optional-media-label:empty,.media-meta-container .media-meta-container-inner .media-meta-labels .optional-labels-container>.optional-media-label[data-show=false]{display:none}.media-meta-container[data-align-right=true] .media-meta-container-inner .media-meta-labels{justify-content:flex-end}.media-meta-container[data-fullscreen=true] .mute-settings,.media-meta-container[data-fullscreen=true] .optional-labels-container,.media-meta-container[data-type=image] .mute-settings{display:none}.media-meta-container[data-no-select=false] #select-media-input{display:block}.media-meta-container[data-no-select=false] #media-title,.media-meta-container[data-no-select=true] #select-media-input{display:none}.media-meta-container[data-no-select=true] #media-title{display:block}#media-select{align-self:center;margin-right:.25em}#media-title{padding-top:.55em}.mute-settings{align-items:center;border-radius:4px;color:#eee;cursor:pointer;display:flex;font-size:114%;justify-content:center;margin:.33em .25em 0;opacity:1;padding:.26em;transition:color .2s,background-color .2s}.mute-settings:hover{background-color:hsla(0,0%,46%,.5);color:#eee;opacity:1}.mute-settings[data-muted=false],.mute-settings[data-muted=false]:hover{opacity:1}.mute-settings icon-element{font-size:147%}';function ft(e){const t=()=>e.shadowRoot?e.shadowRoot:e.content;return{get mediaSelectInput(){return t().getElementById("select-media-input")},get labelsContainer(){return t().querySelector(".optional-labels-container")},get container(){return t().querySelector(".media-meta-container-inner")},get muteContainer(){return t().querySelector(".mute-settings")}}}const vt={alignRight:{formatter:H},bitrateString:{attribute:!1},dimensionsString:{attribute:!1},durationString:{attribute:!1},fpsString:{attribute:!1},fullscreen:{formatter:H},mediaindex:{formatter:_(0)},labels:{},mediaId:{},metadata:{onChange(){this.setMetadataStrings()}},mute:{formatter:$,onChange(e){this.audioIcon=e?"speaker-off":"speaker-medium"}},audioIcon:{},names:{},noSelect:{formatter:H},options:{},startTime:{formatter:_(0),onChange(){this.setStartTimeStrings()}},startTimeString:{attribute:!1}},yt=x(vt),wt=w(gt,bt);class xt extends v{static get observedAttributes(){return yt}_stateConfigs=vt;alignRight=!1;bitrateString="";dimensionsString="";durationString="";fpsString="";fullscreen=!1;mediaindex=0;audioIcon="speaker-off";labels={id:"",codec:!1,bitrate:!1,format:!1,dimensions:!1,fps:!1,variableFrameRate:!1,duration:!1,startTime:!1};mediaId="";metadata={id:"",codec:"",bitrate:0,format:"",width:0,height:0,type:"",fps:0,variableFrameRate:!1,duration:0,size:0,modified:0};mute=!0;names={id:"",path:"",name:"",base:"",extension:"",originalBase:""};noSelect=!1;options=[];startTime=0;startTimeString="";get query(){return ft(this)}constructor(){super(),C(this,wt)}switchMedia=e=>{const t=e.detail.getValue();this.dispatchEvent(new CustomEvent("switchmedia",{bubbles:!0,composed:!0,detail:{id:t,index:this.mediaindex}}))};setMetadataStrings(){const e=this.metadata;this.dimensionsString=`${e.width}x${e.height}`,"video"===e.type?(this.durationString=T(e.duration,e.fps),this.fpsString=`${e.fps}fps`,this.bitrateString=`${Math.round(e.bitrate/1024)}kbps`):(this.bitrateString="",this.fpsString="",this.durationString=""),this.setStartTimeStrings()}setStartTimeStrings(){"video"===this.metadata.type?this.startTimeString=`${st(this.startTime)}[${T(Math.abs(this.startTime),this.metadata.fps)}]`:this.startTimeString=""}toggleMute=()=>this.dispatchEvent(new CustomEvent("setmute",{bubbles:!0,composed:!0,detail:{id:this.mediaId,value:!this.mute}}))}E("media-info",xt);const Et={name:"Difference",source:'#version 300 es\n/*\n * SPDX-FileCopyrightText: Copyright (c) 2021 NVIDIA CORPORATION & AFFILIATES. All rights reserved.\n * SPDX-License-Identifier: BSD-3-Clause\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n * list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n * this list of conditions and the following disclaimer in the documentation\n * and/or other materials provided with the distribution.\n *\n * 3. Neither the name of the copyright holder nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nprecision highp float;\n\n#define DIFF_MODE_RGB           0\n#define DIFF_MODE_LAB_LENGTH    1\n#define DIFF_MODE_LUMINANCE     2\n\n//  common uniforms\nuniform vec2 uMouse;\nuniform float uTime;\nuniform float uFrame;\n\n//  shader-specific uniforms\nuniform bool uAbsolute;\nuniform bool uSignFlip;\nuniform bool uSquared;\nuniform bool uMarkInfNaN;\nuniform float uTolerance;\nuniform float uMultiplier;\nuniform int uMode;\nuniform int uColorMode;\nuniform int uShowColorMap;\n\n// Texture uniforms\nuniform sampler2D uTexture0;\nuniform sampler2D uTexture1;\n\n// Texture\nin vec2 vTextureCoord;\n\nout vec4 outColor;\n\n// mat3 transpose(in mat3 matrix)\n// {\n//     vec3 i0 = matrix[0];\n//     vec3 i1 = matrix[1];\n//     vec3 i2 = matrix[2];\n\n//     return mat3(vec3(i0.x, i1.x, i2.x), vec3(i0.y, i1.y, i2.y), vec3(i0.z, i1.z, i2.z));\n// }\n\nfloat RGBtoLuma(vec3 color)\n{\n    const float RED_COEFFICIENT = 0.212655;\n    const float GREEN_COEFFICIENT = 0.715158;\n    const float BLUE_COEFFICIENT = 0.072187;\n\n    return color.r * RED_COEFFICIENT + color.g * GREEN_COEFFICIENT + color.b * BLUE_COEFFICIENT;\n}\n\nvec3 XYZtoLAB(vec3 c)\n{\n    vec3 n = abs(c) / vec3(95.047, 100, 108.883);\n    vec3 v;\n    v.x = (n.x > 0.008856) ? pow(n.x, 1.0 / 3.0) : (7.787 * n.x) + (16.0 / 116.0);\n    v.y = (n.y > 0.008856) ? pow(n.y, 1.0 / 3.0) : (7.787 * n.y) + (16.0 / 116.0);\n    v.z = (n.z > 0.008856) ? pow(n.z, 1.0 / 3.0) : (7.787 * n.z) + (16.0 / 116.0);\n    return vec3((116.0 * v.y) - 16.0, 500.0 * (v.x - v.y), 200.0 * (v.y - v.z));\n}\n\nvec3 RGBtoXYZ(vec3 c)\n{\n    vec3 tmp;\n    c = abs(c);\n    tmp.x = (c.r > 0.04045) ? pow((c.r + 0.055) / 1.055, 2.4) : c.r / 12.92;\n    tmp.y = (c.g > 0.04045) ? pow((c.g + 0.055) / 1.055, 2.4) : c.g / 12.92,\n    tmp.z = (c.b > 0.04045) ? pow((c.b + 0.055) / 1.055, 2.4) : c.b / 12.92;\n    const mat3 mat = mat3(\n\t\t0.4124, 0.3576, 0.1805,\n        0.2126, 0.7152, 0.0722,\n        0.0193, 0.1192, 0.9505\n\t);\n\n    return 100.0 * (tmp * transpose(mat));\n}\n\nvec3 RGBtoLAB(vec3 c)\n{\n    vec3 lab = XYZtoLAB(RGBtoXYZ(c));\n    return vec3(lab.x / 100.0, 0.5 + 0.5 * (lab.y / 127.0), 0.5 + 0.5 * (lab.z / 127.0));\n}\n\nvec3 HSVtoRGB(vec3 hsv)\n{\n    float h = hsv.x;\n    float s = hsv.y;\n    float v = hsv.z;\n\n    const float PI = 3.14159265358979;\n    vec3 rgb = vec3(v, v, v);\n\n    if (s > 0.0)\n    {\n\t    h = mod(h + 2.0 * PI, 2.0 * PI);\n\t    h /= (PI / 3.0);\n\t    int i = int(floor(h));\n\t    float f = h - float(i);\n\t    float p = v * (1.0 - s);\n\t    float q = v * (1.0 - (s*f));\n\t    float t = v * (1.0 - (s*(1.0-f)));\n\n        if (i == 0)\n            rgb = vec3(v,t,p);\n        else if (i == 1)\n            rgb = vec3(q,v,p);\n        else if (i == 2)\n            rgb = vec3(p,v,t);\n        else if (i == 3)\n            rgb = vec3(p,q,v);\n        else if (i == 4)\n            rgb = vec3(t,p,v);\n        else\n            rgb = vec3(v,p,q);\n    }\n\n    return rgb;\n}\n\nvec3 heatMap(float value, float lb, float ub)\n{\n    float p = clamp((value - lb) / (ub - lb), 0.0, 1.0);\n\n    float r, g, b;\n    float h = 3.7 * (1.0 - p); // 3.7 is blue\n    float s = sqrt(p);\n    float v = sqrt(p);\n    return HSVtoRGB(vec3(h, s, v));\n}\n\nvec3 colorRamp(float value)\n{\n    vec3 color;\n\n    if (value < 0.25)\n        color.r = 0.0;\n    else if (value >= 0.57)\n        color.r = 1.0;\n    else\n       color.r = value * 3.215 - 0.78125;\n\n    if (value < 0.42)\n        color.g = 0.0;\n    else if (value >= 0.92)\n        color.g = 1.0;\n    else\n        color.g = 2.0 * value - 0.84;\n\n    if (value < 0.0)\n        color.b = 0.0;\n    else if (value > 1.0)\n        color.b = 1.0;\n    else if (value < 0.25)\n        color.b = 4.0 * value;\n    else if (value < 0.42)\n        color.b = 1.0;\n    else if (value < 0.92)\n        color.b = -2.0 * value + 1.84;\n    else\n        color.b = value * 12.5 - 11.5;\n\n    return color;\n}\n\nvec3 colorMap(float value, int mode)\n{\n    vec3 color;\n\n    if (mode == 0)\n    {\n        //  per-pixel difference (no action)\n    }\n    else if (mode == 1)\n    {\n        //  Jet\n        color = clamp(1.5 - abs(4.0 * clamp(value, 0.0, 1.0) - vec3(3.0, 2.0, 1.0)), 0.0, 1.0);\n    }\n    else if (mode == 2)\n    {\n        //  Heat map\n        color = heatMap(value, 0.0, 1.0);\n    }\n    else if (mode == 3)\n    {\n        //  grayscale\n        color = vec3(value, value, value);\n    }\n    else if (mode == 4)\n    {\n        //  black-blue-violet-yellow-white\n        color = colorRamp(value);\n    }\n    else\n    {\n        // binary\n        color = (value > 0.0 ? vec3(1.0, 1.0, 1.0) : vec3(0.0, 0.0, 0.0));\n    }\n\n    return color;\n}\n\nbool isNaN(float val)\n{\n  return !(val < 0.0 || 0.0 < val || val == 0.0);\n}\n\nbool isInf(float val)\n{\n  return (val != 0.0 && val * 2.0 == val);\n}\n\nfloat lerp(float a, float b, float v)\n{\n    v = clamp(v, 0.0, 1.0);\n    return a * (1.0 - v) + b * v;\n}\n\nvec3 lerp(vec3 a, vec3 b, float v)\n{\n    v = clamp(v, 0.0, 1.0);\n    return a * (1.0 - v) + b * v;\n}\n\nvoid main()\n{\n    vec3 value;\n\n    ivec2 dimensions = textureSize(uTexture0, 0);\n    //ivec2 loc2d = ivec2(vTextureCoord * vec2(dimensions));\n    vec2 loc2d = vTextureCoord * vec2(dimensions);\n\n    vec3 colorA = texture(uTexture0, vTextureCoord).rgb;\n    vec3 colorB = texture(uTexture1, vTextureCoord).rgb;\n\n    if (uMode == DIFF_MODE_RGB)\n    {\n        value = (uSignFlip ? colorB - colorA : colorA - colorB);\n    }\n    else if (uMode == DIFF_MODE_LAB_LENGTH)\n    {\n        float l = length(RGBtoLAB(colorA) - RGBtoLAB(colorB));\n        value = vec3(l, l, l);\n    }\n    else if (uMode == DIFF_MODE_LUMINANCE)\n    {\n        float l = abs(RGBtoLuma(colorA) - RGBtoLuma(colorB));\n        value = vec3(l, l, l);\n    }\n\n    value = (uSquared ? value * value : value);\n    value = (uAbsolute ? abs(value) : value);\n\n    value.r *= (value.r >= uTolerance ? 1.0 : 0.0);\n    value.g *= (value.g >= uTolerance ? 1.0 : 0.0);\n    value.b *= (value.b >= uTolerance ? 1.0 : 0.0);\n\n    value = value * uMultiplier;\n\n    float error = RGBtoLuma(value); // single error value per pixel\n\n    // A small legend color map\n    float fade = 0.0;\n    if (uShowColorMap != 0)\n    {\n        vec2 paletteCorner = vec2((uShowColorMap == 1 || uShowColorMap == 3) ? 0.0 : 1.0, (uShowColorMap == 1 || uShowColorMap == 2) ? 0.0 : 1.0);\n\n        float kPaletteEdgeWidth = 2.0;\n        float kPaletteLength = float(min(dimensions.x, dimensions.y)) * 0.1;\n        float kPaletteWidth = kPaletteLength / 5.0;\n        vec2 kPaletteCenter = abs(vec2(float(dimensions.x), float(dimensions.y)) * paletteCorner - vec2(kPaletteWidth * 5.0, kPaletteLength * 2.0));\n\n        vec2 paletteVec = vec2(loc2d) - vec2(float(kPaletteCenter.x), float(kPaletteCenter.y));\n        vec2 paletteDim = vec2(kPaletteWidth, kPaletteLength);\n        bool bInside = abs(paletteVec.x) < kPaletteWidth && abs(paletteVec.y) < kPaletteLength;\n        if (bInside)\n        {\n            value = vec3((1.0 - paletteVec.y) / kPaletteLength * 0.5 + 0.5);\n\n            if (uColorMode == 0)\n            {\n                if (paletteVec.x < -0.33 * kPaletteWidth)\n                    value.g = value.b = 0.0;\n                else if (paletteVec.x < 0.33 * kPaletteWidth)\n                    value.r = value.b = 0.0;\n                else\n                    value.r = value.g = 0.0;\n            }\n        }\n\n        vec2 distToEdge = clamp(1.0 - abs(vec2(kPaletteWidth, kPaletteLength) - abs(paletteVec)) / kPaletteEdgeWidth, 0.0, 1.0);\n        bool bInsideEdge = abs(paletteVec.x) < kPaletteWidth + kPaletteEdgeWidth && abs(paletteVec.y) < kPaletteLength + kPaletteEdgeWidth;\n        fade = max(distToEdge.x, distToEdge.y) * (bInsideEdge ? 1.0 : 0.0);\n    }\n\n    vec3 color = colorMap(RGBtoLuma(value.rgb), uColorMode);\n\n    if (uMarkInfNaN)\n    {\n        if (isNaN(value.r) || isNaN(value.g) || isNaN(value.b))\n        {\n            color = vec3(1.0, 0.0, 0.0);\n        }\n        else if (isInf(value.r) || isInf(value.g) || isInf(value.b))\n        {\n            color = vec3(0.0, 1.0, 0.0);\n        }\n    }\n    color = lerp(color, vec3(0.5, 0.5, 0.5), fade);\n\n    //outColor = vec4(color, error);\n    outColor = vec4(color, 1.0);  //  TODO: allow error metric to be supplied in alpha channel\n}\n',inputs:2,UI:{uAbsolute:{name:"Absolute",type:"bool",value:!0},uSignFlip:{name:"Sign flip",type:"bool",value:!1,condition:"!uAbsolute"},uSquared:{name:"Squared",type:"bool",value:!1},uMarkInfNaN:{name:"Mark Inf/NaN",type:"bool",value:!1},uTolerance:{name:"Tolerance",type:"float",value:0,min:0,max:1e4,step:.001,format:"%.03f"},uMultiplier:{name:"Multiplier",type:"float",value:1,min:1,max:100,step:1,format:"%.0f"},uMode:{name:"Mode",type:"dropdown",value:0,alternatives:["RGB difference","CIE-LAB difference","Luminance difference"]},uColorMode:{name:"Color mode",type:"dropdown",value:2,alternatives:["Per-channel differences","Jet","Heatmap","Grayscale","Black-blue-violet-yellow-white","Binary"]},uShowColorMap:{name:"Show Color Map Legend",type:"dropdown",value:1,alternatives:["None","Top Left","Top Right","Bottom Left","Bottom Right"]}}};const St={name:"Gaussian blur",source:'#version 300 es\n/*\n * SPDX-FileCopyrightText: Copyright (c) 2021 NVIDIA CORPORATION & AFFILIATES. All rights reserved.\n * SPDX-License-Identifier: BSD-3-Clause\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n * list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n * this list of conditions and the following disclaimer in the documentation\n * and/or other materials provided with the distribution.\n *\n * 3. Neither the name of the copyright holder nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nprecision highp float;\n\nuniform bool uSymmetric;\nuniform int uRadius;\nuniform int uRadiusX;\nuniform int uRadiusY;\nuniform bool uHalfRadiusSigma;\nuniform float uSigma;\nuniform float uSigmaX;\nuniform float uSigmaY;\nuniform float uAngle;\n\n// Texture uniforms\nuniform sampler2D uTexture0;\n\n// Texture\nin vec2 vTextureCoord;\n\nout vec4 outColor;\n\n\nvoid main()\n{\n    ivec2 dimensions = textureSize(uTexture0, 0);\n    ivec2 loc2d = ivec2(vTextureCoord * vec2(dimensions));\n\n    vec4 colorSum = vec4(0.0, 0.0, 0.0, 1.0);\n    float kernelSum = 0.0;\n\n    int radiusX = uRadiusX;\n    int radiusY = uRadiusY;\n    float sigmaX = uSigmaX;\n    float sigmaY = uSigmaY;\n\n    if (uSymmetric)\n    {\n        radiusX = uRadius;\n        radiusY = uRadius;\n        if (uHalfRadiusSigma)\n        {\n            sigmaX = float(radiusX) / 2.0;\n            sigmaY = float(radiusY) / 2.0;\n        }\n        else\n        {\n            sigmaX = uSigma;\n            sigmaY = uSigma;\n        }\n    }\n    \n    float invSX = 1.0 / (2.0 * sigmaX * sigmaX);\n    float invSY = 1.0 / (2.0 * sigmaY * sigmaY);\n\n    float theta = radians(uAngle);\n    float sinTheta = sin(theta);\n    float cosTheta = cos(theta);\n\n    for (int y = -radiusY; y <= radiusY; y++)\n    {\n        for (int x = -radiusX; x <= radiusX; x++)\n        {\n            float xp = float(x);\n            float yp = float(y);\n            if (!uSymmetric)\n            {\n                xp = xp * cosTheta - yp * sinTheta;\n                yp = xp * sinTheta + yp * cosTheta;\n            }\n\n            float weight = exp(-(xp * xp * invSX + yp * yp * invSY));\n\n            ivec2 tap = loc2d + ivec2(x, y);\n            if (tap.x >= 0 && tap.x < dimensions.x && tap.y >= 0 && tap.y < dimensions.y)\n            {\n                kernelSum += weight;\n                colorSum += texelFetch(uTexture0, tap, 0) * weight;\n            }\n        }\n    }\n\n    outColor = vec4(colorSum / kernelSum);\n}',inputs:1,UI:{uSymmetric:{name:"Symmetric",type:"bool",value:!0},uRadius:{name:"Radius",type:"int",value:3,min:0,max:32,step:.01,condition:"uSymmetric"},uRadiusX:{name:"X Radius",type:"int",value:1,min:0,max:32,condition:"!uSymmetric"},uRadiusY:{name:"Y Radius",type:"int",value:1,min:0,max:32,condition:"!uSymmetric"},uHalfRadiusSigma:{name:"Half radius sigma",type:"bool",value:!0},uSigma:{name:"Sigma",type:"float",value:1.5,min:0,max:16,step:.1,condition:"uSymmetric & !uHalfRadiusSigma"},uSigmaX:{name:"X Sigma",type:"float",value:1.5,min:0,max:16,step:.1,condition:"!uSymmetric & !uHalfRadiusSigma"},uSigmaY:{name:"Y Sigma",type:"float",value:1.5,min:0,max:16,step:.1,condition:"!uSymmetric & !uHalfRadiusSigma"},uAngle:{name:"Angle",type:"float",value:0,min:0,max:360,step:1,condition:"!uSymmetric"}}};const Tt={name:"Pixelization",source:'#version 300 es\n/*\n * SPDX-FileCopyrightText: Copyright (c) 2021 NVIDIA CORPORATION & AFFILIATES. All rights reserved.\n * SPDX-License-Identifier: BSD-3-Clause\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n * list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n * this list of conditions and the following disclaimer in the documentation\n * and/or other materials provided with the distribution.\n *\n * 3. Neither the name of the copyright holder nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nprecision highp float;\n\n//  common uniforms\nuniform vec4 uMouse;\n\n//  shader-specific uniforms\nuniform bool uFixed;\nuniform int uSize;\nuniform int uWidth;\nuniform int uHeight;\nuniform bool uAverage;\n\n// Texture uniforms\nuniform sampler2D uTexture0;\n\n// Texture\nin vec2 vTextureCoord;\n\nout vec4 outColor;\n\nvoid main()\n{\n    ivec2 dimensions = textureSize(uTexture0, 0);\n    ivec2 loc2d = ivec2(vTextureCoord * vec2(dimensions));\n\n    ivec2 size = ivec2(uSize, uSize);\n    if (!uFixed) {\n        size = ivec2(uWidth, uHeight);\n    }\n\n//    ivec2 tlPosition = ivec2((loc2d.x / size.x) * size.x, (loc2d.y / size.y) * size.y);\n    ivec2 tlPosition = (loc2d / size) * size;\n\n    if (!uAverage) {\n        outColor = texelFetch(uTexture0, tlPosition, 0);\n        return;\n    }\n\n    int numTerms = 0;\n    vec4 colorSum;\n    for (int y = 0; y < size.y; y++)\n    {\n        for (int x = 0; x < size.x; x++)\n        {\n            ivec2 pos = tlPosition + ivec2(x, y);\n            if (pos.x >=0 && pos.x < dimensions.x && pos.y >= 0 && pos.y < dimensions.y) {\n                colorSum += texelFetch(uTexture0, tlPosition + ivec2(x, y), 0);\n                numTerms++;\n            }\n        }\n    }\n\n    outColor = colorSum / float(numTerms);\n}\n',inputs:1,UI:{uFixed:{name:"Same width and height",type:"bool",value:!0},uSize:{name:"Size",type:"int",value:16,min:1,max:64,step:1,condition:"uFixed"},uWidth:{name:"Width",type:"int",value:16,min:1,max:64,condition:"!uFixed"},uHeight:{name:"Height",type:"int",value:16,min:1,max:64,condition:"!uFixed"},uAverage:{name:"Average colors (slower)",type:"bool",value:!1}}};const Ct={name:"Sharpness",source:'#version 300 es\n/*\n * SPDX-FileCopyrightText: Copyright (c) 2021 NVIDIA CORPORATION & AFFILIATES. All rights reserved.\n * SPDX-License-Identifier: BSD-3-Clause\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n * list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n * this list of conditions and the following disclaimer in the documentation\n * and/or other materials provided with the distribution.\n *\n * 3. Neither the name of the copyright holder nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nprecision highp float;\n\n//  common uniforms\nuniform vec2 uMouse;\nuniform float uTime;\nuniform float uFrame;\n\n//  shader-specific uniforms\nuniform int uType;\nuniform int uVarianceRadius;\nuniform float uMultiplier;\nuniform float uTolerance;\nuniform bool uOverlay;\n\n// Texture uniforms\nuniform sampler2D uTexture0;\nuniform sampler2D uTexture1;\n\n// Texture\nin vec2 vTextureCoord;\n\nout vec4 outColor;\n\n// from ssim.glsl\nfloat RGBtoLuma(vec3 color) {\n    const float RED_COEFFICIENT = 0.212655;\n    const float GREEN_COEFFICIENT = 0.715158;\n    const float BLUE_COEFFICIENT = 0.072187;\n\n    return color.r * RED_COEFFICIENT + color.g * GREEN_COEFFICIENT + color.b * BLUE_COEFFICIENT;\n}\n\n\nfloat sobel(sampler2D texture, ivec2 loc2d, ivec2 dimensions) {\n\n    const mat3 kGx = mat3(-1.0, 0.0, 1.0,\n        -2.0, 0.0, 2.0,\n        -1.0, 0.0, 1.0);\n    const mat3 kGy = mat3(-1.0, -2.0, -1.0,\n        0.0, 0.0, 0.0,\n        1.0, 2.0, 1.0);\n\n    vec3 G = vec3(0.0, 0.0, 0.0);\n    for (int y = -1; y <= 1; y++)\n    {\n        for (int x = -1; x <= 1; x++)\n        {\n            ivec2 pos = loc2d + ivec2(x, y);\n\n            if (pos.x < 0 || pos.x >= dimensions.x || pos.y < 0 || pos.y >= dimensions.y) {\n                continue;\n            }\n\n            vec3 c = texelFetch(texture, loc2d + ivec2(x, y), 0).rgb;\n            float luminance = (c.r + c.g + c.b) / 3.0;\n\n            G.x += luminance * kGx[y + 1][x + 1];\n            G.y += luminance * kGy[y + 1][x + 1];\n        }\n    }\n\n    return length(G);\n}\n\n\nfloat laplacian(sampler2D texture, ivec2 loc2d) {\n        float c0 = RGBtoLuma(texelFetch(texture, loc2d, 0).rgb);\n        float c1 = RGBtoLuma(texelFetch(texture, loc2d + ivec2(-1, 0), 0).rgb);\n        float c2 = RGBtoLuma(texelFetch(texture, loc2d + ivec2(+1, 0), 0).rgb);\n        float c3 = RGBtoLuma(texelFetch(texture, loc2d + ivec2(0, -1), 0).rgb);\n        float c4 = RGBtoLuma(texelFetch(texture, loc2d + ivec2(0, +1), 0).rgb);\n        return -4.0 * c0 + c1 + c2 + c3 + c4;\n}\n\nfloat laplacian2(sampler2D texture, ivec2 loc2d) {\n        float c0 = RGBtoLuma(texelFetch(texture, loc2d + ivec2(-1, -1), 0).rgb);\n        float c1 = RGBtoLuma(texelFetch(texture, loc2d + ivec2( 0, -1), 0).rgb);\n        float c2 = RGBtoLuma(texelFetch(texture, loc2d + ivec2(+1, -1), 0).rgb);\n        float c3 = RGBtoLuma(texelFetch(texture, loc2d + ivec2(-1,  0), 0).rgb);\n        float c4 = RGBtoLuma(texelFetch(texture, loc2d + ivec2( 0,  0), 0).rgb);\n        float c5 = RGBtoLuma(texelFetch(texture, loc2d + ivec2(+1,  0), 0).rgb);\n        float c6 = RGBtoLuma(texelFetch(texture, loc2d + ivec2(-1, +1), 0).rgb);\n        float c7 = RGBtoLuma(texelFetch(texture, loc2d + ivec2( 0, +1), 0).rgb);\n        float c8 = RGBtoLuma(texelFetch(texture, loc2d + ivec2(+1, +1), 0).rgb);\n        return 0.25 * c0 + 0.5 * c1 + 0.25 * c2 + 0.5 * c3 - 3.0 * c4 + 0.5 * c5 + 0.25 * c6 + 0.5 * c7 + 0.25 * c8;\n}\n\nfloat laplacianVariance(sampler2D texture, ivec2 loc2d, int radius, ivec2 dimensions) {\n    float sum = 0.0;\n    float variance = 0.0;\n\n    float n = 0.0;\n    for (int y = -radius; y <= radius; y++)\n    {\n        for (int x = -radius; x <= radius; x++)\n        {\n            ivec2 pos = loc2d + ivec2(x, y);\n            if (pos.x < 0 || pos.x >= dimensions.x || pos.y < 0 || pos.y >= dimensions.y) {\n                continue;\n            }\n            float value = laplacian(texture, pos);\n            sum += value;\n            n += 1.0;\n        }\n    }\n\n    // float n = pow(1.0 + 2.0 * float(radius), 2.0);\n    float mean = sum / n;\n\n    for (int y = -radius; y <= radius; y++)\n    {\n        for (int x = -radius; x <= radius; x++)\n        {\n            ivec2 pos = loc2d + ivec2(x, y);\n            if (pos.x < 0 || pos.x >= dimensions.x || pos.y < 0 || pos.y >= dimensions.y) {\n                continue;\n            }\n\n            float value = laplacian(texture, pos);\n\n            variance += pow(value - mean, 2.0);\n        }\n    }\n    variance /= n;\n\n    return variance;\n}\n\nvoid main() {\n    ivec2 dimensions = textureSize(uTexture0, 0);\n    ivec2 loc2d = ivec2(vTextureCoord * vec2(dimensions));\n\n    float value0, value1;\n    \n    //  Sobel\n    if (uType == 0) {\n        value0 = sobel(uTexture0, loc2d, dimensions);\n        value1 = sobel(uTexture1, loc2d, dimensions);\n    }\n\n    //  Laplacian (five point)\n    if (uType == 1) {\n        value0 = laplacian(uTexture0, loc2d);\n        value1 = laplacian(uTexture1, loc2d);\n    }\n\n    //  Laplacian (nine point)\n    if (uType == 2) {\n        value0 = laplacian2(uTexture0, loc2d);\n        value1 = laplacian2(uTexture1, loc2d);\n    }\n\n    //  Laplacian variance\n    if (uType == 3) {\n        value0 = laplacianVariance(uTexture0, loc2d, uVarianceRadius, dimensions);\n        value1 = laplacianVariance(uTexture1, loc2d, uVarianceRadius, dimensions);\n    }\n\n    float value = (value0 - value1) * uMultiplier;\n\n    outColor = vec4(0.0, 0.0, 0.0, 1.0);\n    if (uOverlay) {\n        outColor = texelFetch(uTexture0, loc2d, 0);\n    }\n    if (value > uTolerance) {\n        outColor += vec4(0.0, value, 0.0, 0.0);\n    } else if (value < -uTolerance) {\n        outColor += vec4(-value, 0.0, 0.0, 0.0);\n    }\n}\n',inputs:2,UI:{uType:{name:"Type",type:"dropdown",value:3,alternatives:["Sobel","Laplacian (five point)","Laplacian (nine point)","Laplacian variance"]},uVarianceRadius:{name:"Radius",type:"int",value:3,min:1,max:25,condition:"uType == 3"},uMultiplier:{name:"Multiplier",type:"float",value:3,min:1,max:100,step:.5},uTolerance:{name:"Tolerance",type:"float",value:0,min:0,max:10,step:.1},uOverlay:{name:"Overlay",type:"bool",value:!0}}};const It={name:"Sobel",source:'#version 300 es\n/*\n * SPDX-FileCopyrightText: Copyright (c) 2021 NVIDIA CORPORATION & AFFILIATES. All rights reserved.\n * SPDX-License-Identifier: BSD-3-Clause\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n * list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n * this list of conditions and the following disclaimer in the documentation\n * and/or other materials provided with the distribution.\n *\n * 3. Neither the name of the copyright holder nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nprecision highp float;\n\n//  common uniforms\nuniform vec2 uMouse;\nuniform float uTime;\nuniform float uFrame;\n\n//  shader-specific uniforms\nuniform int uType;\nuniform bool uX;\nuniform bool uY;\nuniform bool uAngle;\nuniform int uVarianceRadius;\nuniform float uMultiplier;\n\n// Texture uniforms\nuniform sampler2D uTexture0;\n\n// Texture\nin vec2 vTextureCoord;\n\nout vec4 outColor;\n\n// from ssim.glsl\nfloat RGBtoLuma(vec3 color) {\n    const float RED_COEFFICIENT = 0.212655;\n    const float GREEN_COEFFICIENT = 0.715158;\n    const float BLUE_COEFFICIENT = 0.072187;\n\n    return color.r * RED_COEFFICIENT + color.g * GREEN_COEFFICIENT + color.b * BLUE_COEFFICIENT;\n}\n\nfloat laplacian(ivec2 loc2d) {\n        float c0 = RGBtoLuma(texelFetch(uTexture0, loc2d, 0).rgb);\n        float c1 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(-1, 0), 0).rgb);\n        float c2 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(+1, 0), 0).rgb);\n        float c3 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(0, -1), 0).rgb);\n        float c4 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(0, +1), 0).rgb);\n        return -4.0 * c0 + c1 + c2 + c3 + c4;\n}\n\nfloat laplacian2(ivec2 loc2d) {\n        float c0 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(-1, -1), 0).rgb);\n        float c1 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2( 0, -1), 0).rgb);\n        float c2 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(+1, -1), 0).rgb);\n        float c3 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(-1,  0), 0).rgb);\n        float c4 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2( 0,  0), 0).rgb);\n        float c5 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(+1,  0), 0).rgb);\n        float c6 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(-1, +1), 0).rgb);\n        float c7 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2( 0, +1), 0).rgb);\n        float c8 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(+1, +1), 0).rgb);\n        return 0.25 * c0 + 0.5 * c1 + 0.25 * c2 + 0.5 * c3 - 3.0 * c4 + 0.5 * c5 + 0.25 * c6 + 0.5 * c7 + 0.25 * c8;\n}\n\nfloat laplacianVariance(ivec2 loc2d, int radius, ivec2 dimensions) {\n    float sum = 0.0;\n    float variance = 0.0;\n\n    float n = 0.0;\n    for (int y = -radius; y <= radius; y++)\n    {\n        for (int x = -radius; x <= radius; x++)\n        {\n            ivec2 pos = loc2d + ivec2(x, y);\n            if (pos.x < 0 || pos.x >= dimensions.x || pos.y < 0 || pos.y >= dimensions.y) {\n                continue;\n            }\n            float value = laplacian(pos);\n            sum += value;\n            n += 1.0;\n        }\n    }\n\n    // float n = pow(1.0 + 2.0 * float(radius), 2.0);\n    float mean = sum / n;\n\n    for (int y = -radius; y <= radius; y++)\n    {\n        for (int x = -radius; x <= radius; x++)\n        {\n            ivec2 pos = loc2d + ivec2(x, y);\n            if (pos.x < 0 || pos.x >= dimensions.x || pos.y < 0 || pos.y >= dimensions.y) {\n                continue;\n            }\n\n            float value = laplacian(pos);\n\n            variance += pow(value - mean, 2.0);\n        }\n    }\n    variance /= n;\n\n    return variance;\n}\n\nvoid main() {\n    ivec2 dimensions = textureSize(uTexture0, 0);\n    ivec2 loc2d = ivec2(vTextureCoord * vec2(dimensions));\n\n\n    const float Pi = 3.14159265358979;\n    const float TwoDivPi = 2.0 / Pi;\n\n    const mat3 kGx = mat3(-1.0, 0.0, 1.0,\n        -2.0, 0.0, 2.0,\n        -1.0, 0.0, 1.0);\n    const mat3 kGy = mat3(-1.0, -2.0, -1.0,\n        0.0, 0.0, 0.0,\n        1.0, 2.0, 1.0);\n\n    vec4 colorSum = vec4(0.0, 0.0, 0.0, 1.0);\n    float kernelSum = 0.0;\n\n    //  Laplacian (five point)\n    if (uType == 1) {\n        float laplacian = laplacian(loc2d) * uMultiplier;\n        outColor = vec4(laplacian, laplacian, laplacian, 1.0);\n        return;\n    }\n\n    //  Laplacian (nine point)\n    if (uType == 2) {\n        float laplacian = laplacian2(loc2d) * uMultiplier;\n        outColor = vec4(laplacian, laplacian, laplacian, 1.0);\n        return;\n    }\n\n    //  Laplacian variance\n    if (uType == 3) {\n        float laplacianVariance = laplacianVariance(loc2d, uVarianceRadius, dimensions) * uMultiplier;\n        outColor = vec4(laplacianVariance, laplacianVariance, laplacianVariance, 1.0);\n        return;\n    }\n\n    //  Sobel\n    vec3 G = vec3(0.0, 0.0, 0.0);\n    for (int y = -1; y <= 1; y++)\n    {\n        for (int x = -1; x <= 1; x++)\n        {\n            ivec2 pos = loc2d + ivec2(x, y);\n\n            if (pos.x < 0 || pos.x >= dimensions.x || pos.y < 0 || pos.y >= dimensions.y) {\n                continue;\n            }\n\n            vec3 c = texelFetch(uTexture0, loc2d + ivec2(x, y), 0).rgb;\n            float luminance = (c.r + c.g + c.b) / 3.0;\n\n            if (uX) {\n                G.x += luminance * kGx[y + 1][x + 1];\n            }\n            if (uY) {\n                G.y += luminance * kGy[y + 1][x + 1];\n            }\n        }\n    }\n\n    if (uAngle)\n    {\n        float angle = atan(G.y / G.x) * TwoDivPi;\n\n        outColor = vec4((angle > 0.0 ? angle : 0.0), (angle < 0.0 ? -angle : 0.0), 0.0, 1.0);\n    }\n    else\n    {\n        //        float value = sqrt(G.x * G.x + G.y * G.y + G.z * G.z);\n        float value = length(G);\n\n        outColor = vec4(value, value, value, 1.0);\n    }\n\n}\n',inputs:1,UI:{uType:{name:"Type",type:"dropdown",value:0,alternatives:["Sobel","Laplacian (five point)","Laplacian (nine point)","Laplacian variance"]},uX:{name:"X",type:"bool",value:!0,condition:"uType == 0"},uY:{name:"Y",type:"bool",value:!0,sameLine:!0,condition:"uType == 0"},uAngle:{name:"Show angle",type:"bool",value:!1,condition:"uType == 0"},uVarianceRadius:{name:"Radius",type:"int",value:3,min:1,max:25,condition:"uType == 3"},uMultiplier:{name:"Multiplier",type:"float",value:10,min:1,max:100,step:.5,condition:"uType == 1,2,3"}}};const kt={name:"SSIM",source:'#version 300 es\n/*\n * SPDX-FileCopyrightText: Copyright (c) 2021 NVIDIA CORPORATION & AFFILIATES. All rights reserved.\n * SPDX-License-Identifier: BSD-3-Clause\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice, this\n * list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n * this list of conditions and the following disclaimer in the documentation\n * and/or other materials provided with the distribution.\n *\n * 3. Neither the name of the copyright holder nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\nprecision highp float;\n\n//  common uniforms\n//uniform vec2 uDimensions;\nuniform vec2 uMouse;\nuniform float uTime;\nuniform float uFrame;\n\n//  shader-specific uniforms\nuniform int uMode;\nuniform float uC1;\nuniform float uC2;\nuniform float uC3;\nuniform float uSigma;\nuniform float uWeightLuminance;\nuniform float uWeightContrast;\nuniform float uWeightStructure;\nuniform bool uInvert;\nuniform int uColorMode;\nuniform int uShowColorMap;\n\n// Texture uniforms\nuniform sampler2D uTexture0;\nuniform sampler2D uTexture1;\n\n// Texture\nin vec2 vTextureCoord;\n\nout vec4 outColor;\n\n\nfloat RGBtoLuma(vec3 color)\n{\n    const float RED_COEFFICIENT = 0.212655;\n    const float GREEN_COEFFICIENT = 0.715158;\n    const float BLUE_COEFFICIENT = 0.072187;\n\n    return color.r * RED_COEFFICIENT + color.g * GREEN_COEFFICIENT + color.b * BLUE_COEFFICIENT;\n}\n\nvec3 XYZtoLAB(vec3 c)\n{\n    vec3 n = abs(c) / vec3(95.047, 100, 108.883);\n    vec3 v;\n    v.x = (n.x > 0.008856) ? pow(n.x, 1.0 / 3.0) : (7.787 * n.x) + (16.0 / 116.0);\n    v.y = (n.y > 0.008856) ? pow(n.y, 1.0 / 3.0) : (7.787 * n.y) + (16.0 / 116.0);\n    v.z = (n.z > 0.008856) ? pow(n.z, 1.0 / 3.0) : (7.787 * n.z) + (16.0 / 116.0);\n    return vec3((116.0 * v.y) - 16.0, 500.0 * (v.x - v.y), 200.0 * (v.y - v.z));\n}\n\nvec3 RGBtoXYZ(vec3 c)\n{\n    vec3 tmp;\n    c = abs(c);\n    tmp.x = (c.r > 0.04045) ? pow((c.r + 0.055) / 1.055, 2.4) : c.r / 12.92;\n    tmp.y = (c.g > 0.04045) ? pow((c.g + 0.055) / 1.055, 2.4) : c.g / 12.92,\n    tmp.z = (c.b > 0.04045) ? pow((c.b + 0.055) / 1.055, 2.4) : c.b / 12.92;\n    const mat3 mat = mat3(\n\t\t0.4124, 0.3576, 0.1805,\n        0.2126, 0.7152, 0.0722,\n        0.0193, 0.1192, 0.9505\n\t);\n\n    return 100.0 * (tmp * transpose(mat));\n}\n\nvec3 RGBtoLAB(vec3 c)\n{\n    vec3 lab = XYZtoLAB(RGBtoXYZ(c));\n    return vec3(lab.x / 100.0, 0.5 + 0.5 * (lab.y / 127.0), 0.5 + 0.5 * (lab.z / 127.0));\n}\n\nvec3 HSVtoRGB(vec3 hsv)\n{\n    float h = hsv.x;\n    float s = hsv.y;\n    float v = hsv.z;\n\n    const float PI = 3.14159265358979;\n    vec3 rgb = vec3(v, v, v);\n\n    if (s > 0.0)\n    {\n\t    h = mod(h + 2.0 * PI, 2.0 * PI);\n\t    h /= (PI / 3.0);\n\t    int i = int(floor(h));\n\t    float f = h - float(i);\n\t    float p = v * (1.0 - s);\n\t    float q = v * (1.0 - (s*f));\n\t    float t = v * (1.0 - (s*(1.0-f)));\n\n        if (i == 0)\n            rgb = vec3(v,t,p);\n        else if (i == 1)\n            rgb = vec3(q,v,p);\n        else if (i == 2)\n            rgb = vec3(p,v,t);\n        else if (i == 3)\n            rgb = vec3(p,q,v);\n        else if (i == 4)\n            rgb = vec3(t,p,v);\n        else\n            rgb = vec3(v,p,q);\n    }\n\n    return rgb;\n}\n\nvec3 heatMap(float value, float lb, float ub)\n{\n    float p = clamp((value - lb) / (ub - lb), 0.0, 1.0);\n\n    float r, g, b;\n    float h = 3.7 * (1.0 - p); // 3.7 is blue\n    float s = sqrt(p);\n    float v = sqrt(p);\n    return HSVtoRGB(vec3(h, s, v));\n}\n\nvec3 colorRamp(float value)\n{\n    vec3 color;\n\n    if (value < 0.25)\n        color.r = 0.0;\n    else if (value >= 0.57)\n        color.r = 1.0;\n    else\n       color.r = value * 3.215 - 0.78125;\n\n    if (value < 0.42)\n        color.g = 0.0;\n    else if (value >= 0.92)\n        color.g = 1.0;\n    else\n        color.g = 2.0 * value - 0.84;\n\n    if (value < 0.0)\n        color.b = 0.0;\n    else if (value > 1.0)\n        color.b = 1.0;\n    else if (value < 0.25)\n        color.b = 4.0 * value;\n    else if (value < 0.42)\n        color.b = 1.0;\n    else if (value < 0.92)\n        color.b = -2.0 * value + 1.84;\n    else\n        color.b = value * 12.5 - 11.5;\n\n    return color;\n}\n\nvec3 colorMap(float value, int mode)\n{\n    vec3 color;\n\n    if (mode == 0)\n    {\n        //  per-pixel difference (no action)\n    }\n    else if (mode == 1)\n    {\n        //  Jet\n        color = clamp(1.5 - abs(4.0 * clamp(value, 0.0, 1.0) - vec3(3.0, 2.0, 1.0)), 0.0, 1.0);\n    }\n    else if (mode == 2)\n    {\n        //  Heat map\n        color = heatMap(value, 0.0, 1.0);\n    }\n    else if (mode == 3)\n    {\n        //  grayscale\n        color = vec3(value, value, value);\n    }\n    else if (mode == 4)\n    {\n        //  black-blue-violet-yellow-white\n        color = colorRamp(value);\n    }\n    else\n    {\n        // binary\n        color = (value > 0.0 ? vec3(1.0, 1.0, 1.0) : vec3(0.0, 0.0, 0.0));\n    }\n\n    return color;\n}\n\nbool isNaN(float val)\n{\n  return !(val < 0.0 || 0.0 < val || val == 0.0);\n}\n\nbool isInf(float val)\n{\n  return (val != 0.0 && val * 2.0 == val);\n}\n\nfloat lerp(float a, float b, float v)\n{\n    v = clamp(v, 0.0, 1.0);\n    return a * (1.0 - v) + b * v;\n}\n\nvec3 lerp(vec3 a, vec3 b, float v)\n{\n    v = clamp(v, 0.0, 1.0);\n    return a * (1.0 - v) + b * v;\n}\n\n#define KERNELWIDTH 11\n\nfloat ssim(ivec2 loc2d, float sigma)\n{\n    const int kKernelWidth = KERNELWIDTH;\n    const int kHalfKernelWidth = (kKernelWidth - 1) / 2;\n\n    //const float C1 = 0.01 * 0.01;\n    //const float C2 = 0.03 * 0.03;\n    //const float C3 = C2 * 0.5;\n\n    float weights[kKernelWidth];\n    float weightsSum = 0.0;\n    float sigmaSq = sigma * sigma;\n    int i = 0;\n    for (i = 0; i < kKernelWidth; i++)\n    {\n        float x = float(i - kHalfKernelWidth);\n        weights[i] = exp(-x * x / (2.0 * sigmaSq));\n        weightsSum += weights[i];\n    }\n    for (i = 0; i < kKernelWidth; i++)\n    {\n        weights[i] /= weightsSum;\n    }\n\n    float mu0 = 0.0, mu1 = 0.0;\n    {\n        for (int y = 0; y < kKernelWidth; y++)\n        {\n            for (int x = 0; x < kKernelWidth; x++)\n            {\n                float weight = weights[x] * weights[y];\n                mu0 += RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(x, y), 0).rgb) / 255.0;\n                mu1 += RGBtoLuma(texelFetch(uTexture1, loc2d + ivec2(x, y), 0).rgb) / 255.0;\n                // mu0 += s_Ref[threadId.y + y][threadId.x + x] * weight;\n                // mu1 += s_Test[threadId.y + y][threadId.x + x] * weight;\n            }\n        }\n    }\n\n    float mu0Sq = mu0 * mu0;\n    float mu1Sq = mu1 * mu1;\n    float mu0mu1 = mu0 * mu1;\n\n    float sigma0Sq = 0.0, sigma1Sq = 0.0, sigma01 = 0.0;\n    {\n        for (int y = 0; y < kKernelWidth; ++y)\n        {\n            for (int x = 0; x < kKernelWidth; ++x)\n            {\n                float weight = weights[x] * weights[y];\n                float color0 = RGBtoLuma(texelFetch(uTexture0, loc2d + ivec2(x, y), 0).rgb) / 255.0;\n                float color1 = RGBtoLuma(texelFetch(uTexture1, loc2d + ivec2(x, y), 0).rgb) / 255.0;\n                // float color0 = s_Ref[threadId.y + y][threadId.x + x];\n                // float color1 = s_Test[threadId.y + y][threadId.x + x];\n                sigma0Sq += (color0 - mu0) * (color0 - mu0) * weight;\n                sigma1Sq += (color1 - mu1) * (color1 - mu1) * weight;\n                sigma01 += (color0 - mu0) * (color1 - mu1) * weight;\n            }\n        }\n    }\n    float sigma0sigma1 = sqrt(sigma0Sq * sigma1Sq);\n\n    float ssimSimple = ((2.0 * mu0mu1 + uC1) * (2.0 * sigma01 + uC2)) / ((mu0Sq + mu1Sq + uC1) * (sigma0Sq + sigma1Sq + uC2));\n\n    float L = pow((2.0 * mu0mu1 + uC1) / (mu0Sq + mu1Sq + uC1), uWeightLuminance);\n    float C = pow((2.0 * sigma0sigma1 + uC2) / (sigma0Sq + sigma1Sq + uC2), uWeightContrast);\n    float S = (sigma01 + uC3) / (sigma0sigma1 + uC3);\n    S = (uWeightStructure == float(int(uWeightStructure)) ? S : pow(S, uWeightStructure));\n\n    float ssim = 1.0;\n    if (uMode == 0)\n        ssim = L * C * S;\n    else if (uMode == 1)\n        ssim = ssimSimple;\n    else if (uMode == 2)\n        ssim = L;\n    else if (uMode == 3)\n        ssim = C;\n    else if (uMode == 4)\n        ssim = S;\n\n    return ssim;\n}\n\nvoid main()\n{\n    ivec2 dimensions = textureSize(uTexture0, 0);\n    ivec2 loc2d = ivec2(vTextureCoord * vec2(dimensions));\n\n    float ssimValue = 1.0 - ssim(loc2d, uSigma);\n\n    if (uInvert) {\n        ssimValue = 1.0 - ssimValue;\n    }\n\n    vec3 value = vec3(ssimValue, ssimValue, ssimValue);\n\n    //float error = RGBtoLuma(value); // single error value per pixel\n\n    // A small legend color map\n    float fade = 0.0;\n    if (uColorMode != 0 && uShowColorMap != 0)\n    {\n        vec2 paletteCorner = vec2((uShowColorMap == 1 || uShowColorMap == 3) ? 0.0 : 1.0, (uShowColorMap == 1 || uShowColorMap == 2) ? 0.0 : 1.0);\n\n        float kPaletteEdgeWidth = 2.0;\n        float kPaletteLength = float(min(dimensions.x, dimensions.y)) * 0.1;\n        float kPaletteWidth = kPaletteLength / 5.0;\n        vec2 kPaletteCenter = abs(vec2(float(dimensions.x), float(dimensions.y)) * paletteCorner - vec2(kPaletteWidth * 5.0, kPaletteLength * 2.0));\n\n        vec2 paletteVec = vec2(loc2d) - vec2(float(kPaletteCenter.x), float(kPaletteCenter.y));\n        vec2 paletteDim = vec2(kPaletteWidth, kPaletteLength);\n        bool bInside = abs(paletteVec.x) < kPaletteWidth && abs(paletteVec.y) < kPaletteLength;\n        if (bInside)\n        {\n            value = vec3((1.0 - paletteVec.y) / kPaletteLength * 0.5 + 0.5);\n\n            if (uColorMode == 0)\n            {\n                if (paletteVec.x < -0.33 * kPaletteWidth)\n                    value.g = value.b = 0.0;\n                else if (paletteVec.x < 0.33 * kPaletteWidth)\n                    value.r = value.b = 0.0;\n                else\n                    value.r = value.g = 0.0;\n            }\n        }\n\n        vec2 distToEdge = clamp(1.0 - abs(vec2(kPaletteWidth, kPaletteLength) - abs(paletteVec)) / kPaletteEdgeWidth, 0.0, 1.0);\n        bool bInsideEdge = abs(paletteVec.x) < kPaletteWidth + kPaletteEdgeWidth && abs(paletteVec.y) < kPaletteLength + kPaletteEdgeWidth;\n        fade = max(distToEdge.x, distToEdge.y) * (bInsideEdge ? 1.0 : 0.0);\n    }\n\n    vec3 color;\n    if (uColorMode != 0) {\n        color = colorMap(RGBtoLuma(value.rgb), uColorMode);\n        color = lerp(color, vec3(0.5, 0.5, 0.5), fade);\n    } else\n        color = vec3(1.0 - ssimValue, 1.0 - ssimValue, 1.0 - ssimValue);\n\n    //if (uMarkInfNaN)\n    if (false)\n    {\n        if (isNaN(value.r) || isNaN(value.g) || isNaN(value.b))\n        {\n            color = vec3(1.0, 0.0, 0.0);\n        }\n        else if (isInf(value.r) || isInf(value.g) || isInf(value.b))\n        {\n            color = vec3(0.0, 1.0, 0.0);\n        }\n    }\n\n    //color = vec3(ssimValue, ssimValue, ssimValue) * 255.0;\n\n    //outColor = vec4(color, error);\n    outColor = vec4(color, 1.0);  //  TODO: allow error metric to be supplied in alpha channel\n}\n',inputs:2,UI:{uMode:{name:"SSIM Mode",type:"dropdown",value:1,alternatives:["SSIM full","SSIM simplified","Luminance error only","Contrast error only","Structural error only"]},uC1:{name:"C1",type:"float",value:1e-4,min:0,max:1,step:1e-5,displayFormat:"%.5f"},uC2:{name:"C2",type:"float",value:9e-4,min:0,max:1,step:1e-5,displayFormat:"%.5f"},uC3:{name:"C3",type:"float",value:45e-5,min:0,max:1,step:1e-5,displayFormat:"%.5f"},uSigma:{name:"Sigma",type:"float",value:1.5,min:.1,max:16,step:.1,displayFormat:"%.1f"},uWeightLuminance:{name:"Weight Luminance",type:"float",value:1,min:0,max:5,step:.01,displayFormat:"%.2f",condition:"uMode == 0,2"},uWeightContrast:{name:"Weight Contrast",type:"float",value:1,min:0,max:5,step:.01,displayFormat:"%.2f",condition:"uMode == 0,3"},uWeightStructure:{name:"Weight Structure",type:"float",value:1,min:0,max:5,step:.01,displayFormat:"%.2f",condition:"uMode == 0,4"},uInvert:{type:"bool",name:"Invert output",value:!1},uColorMode:{name:"Color mode",type:"dropdown",value:0,alternatives:["None (SSIM default)","Jet","Heatmap","Grayscale","Black-blue-violet-yellow-white","Binary"]},uShowColorMap:{name:"Show Color Map Legend",type:"dropdown",value:1,alternatives:["None","Top Left","Top Right","Bottom Left","Bottom Right"],condition:"uColorMode != 0"}}},Rt=e=>localStorage.setItem("customShaders",JSON.stringify(e)),Lt={get:()=>JSON.parse(localStorage.getItem("customShaders")||"[]"),set:e=>{const t=Lt.get(),i=t.findIndex((t=>t.path===e.path));i>-1?t[Number(i)]=e:t.push(e),Rt(t)},remove:e=>{const t=Lt.get(),i=t.findIndex((t=>t.path===e));-1!==i&&(t.splice(i,1),Rt(t))},reload:e=>{const t=window.NvCompareApi;if(!t||!e)return;if("json"!==e.split(".").pop())return;const i=Lt.get(),n=i.findIndex((t=>t.path===e));if(-1===n)return;const a=i[Number(n)];return t.readShaderFile(a.path).then((e=>{const t={name:e.name,source:e.source,UI:e.UI||{},inputs:e.inputs};t.name&&t.source&&t.inputs&&Lt.set({filename:a.filename,path:a.path,created:(new Date).getTime(),data:t})}))}};const Mt={},At=x(Mt),Ot=w('<div id="trim-controls-container"><div id="in-out-left"></div><div id="in-out-center"><div id="in-out-left-handle"><icon-element type="in"></icon-element></div><div id="in-out-center-bar"></div><div id="in-out-right-handle"><icon-element type="out"></icon-element></div></div><div id="in-out-right"></div></div>',":host{align-items:center;display:flex;width:100%}#in-out-center,#trim-controls-container{align-items:center;display:flex;flex-grow:1}#in-out-center{position:relative}#in-out-center-bar{background-color:#bbb;flex-grow:1;height:3px;width:100%}#in-out-left-handle{left:0;-webkit-transform:translate(-50%,calc(-50% + 2px));transform:translate(-50%,calc(-50% + 2px))}#in-out-left-handle,#in-out-right-handle{cursor:-webkit-grab;cursor:grab;font-size:1.25em;position:absolute;top:0}#in-out-right-handle{right:0;-webkit-transform:translate(50%,calc(-50% + 2px));transform:translate(50%,calc(-50% + 2px))}#in-out-left,#in-out-right{background-color:#111;height:3px}");E("trim-controls",class extends v{static get observedAttributes(){return At}_stateConfigs=Mt;#r=0;get duration(){return this.#r}set duration(e){const t=_(0)(e);this.#r=t,this.#l()}#d=0;get startTime(){return this.#d}set startTime(e){const t=_(0)(e);this.#d=t,this.#l()}#c=0;get endTime(){return this.#c}set endTime(e){const t=_(0)(e);this.#c=t,this.#l()}constructor(){super(),C(this,Ot)}#h(){return this.shadowRoot.getElementById("trim-controls-container")}#u(){return this.shadowRoot.getElementById("in-out-left")}#m(){return this.shadowRoot.getElementById("in-out-right")}#p(){return this.shadowRoot.getElementById("in-out-left-handle")}#g(){return this.shadowRoot.getElementById("in-out-right-handle")}#l(){const e=this.#d,t=this.#c,i=this.#r;this.#u().style.minWidth=e/i*100+"%",this.#m().style.minWidth=(i-t)/i*100+"%"}attached(){const t=this.#h(),i=this.#p(),n=this.#g(),a=(e,i)=>{const n=this.#c,a=this.#d,o=this.#r,s=t.getBoundingClientRect(),r=(i-s.left)/s.width,l=Math.min(o,Math.max(0,o*r));let d;if("updatestarttime"===e){const e=(n/o*s.width-16)/s.width*o;d=Math.min(e,l)}else{const e=(a/o*s.width+16)/s.width*o;d=Math.max(e,l)}return d},o=e=>t=>{this.dispatchEvent(new CustomEvent("dopause",{bubbles:!0,composed:!0})),this.dispatchEvent(new CustomEvent(e,{bubbles:!0,composed:!0,detail:a(e,t.clientX)}));const i=t=>{t.preventDefault(),this.dispatchEvent(new CustomEvent(e,{bubbles:!0,composed:!0,detail:a(e,t.clientX)}))},n=e=>{e.preventDefault(),document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",i),document.removeEventListener("pointerup",n),document.removeEventListener("pointerleave",n),i(e)};document.body.style.userSelect="none",window.addEventListener("pointermove",i),document.addEventListener("pointerup",n),document.addEventListener("pointerleave",n)};e(this,"pointerdown",o("updatestarttime"),i),e(this,"pointerdown",o("updateendtime"),n)}});const Bt={},Nt=x(Bt),Pt=w('<div id="secondary-controls"><div id="secondary-controls-left"><button-element type="link" size="2" iconsize="1.334em" icon="sticker" text="Add overlay" id="add-overlay-btn"></button-element><button-element type="link" size="2" iconsize="1.334em" icon="shader" text="Add filter" id="add-filter-select"></button-element></div><div id="secondary-controls-right"><trim-controls id="trim-controls"></trim-controls></div></div>',"#secondary-controls{align-items:center;background-color:#212121;box-shadow:inset 0 0 0 1px #111,inset 10px 10px 5px -10px #111;box-sizing:border-box;display:flex;padding:.5em;width:100%}#secondary-controls[data-has-video=false] #secondary-controls-right{display:none}#secondary-controls-left{align-items:center;display:flex;gap:.75em;min-width:27em}#secondary-controls-right{align-items:center;display:flex;flex-grow:1;margin:.5em 0 .5em 1em}");E("secondary-controls",class extends v{static get observedAttributes(){return Nt}_stateConfigs=Bt;set uiVisibility(e){e&&(!1===e.inOutSlider?this.#b().style.display="none":!0===e.inOutSlider&&this.#b().style.removeProperty("display"),!1===e.addLogoBtn?this.#f().style.display="none":!0===e.addLogoBtn&&this.#f().style.removeProperty("display"),!1===e.addLogoBtn&&!1===e.inOutSlider?this.#h().style.display="none":!0!==e.addLogoBtn&&!0!==e.inOutSlider||this.#h().style.removeProperty("display"),!1===e.addFilterBtn?this.#v().style.display="none":!0===e.addFilterBtn&&this.#v().style.removeProperty("display"))}set hasVideo(e){const t=H(e);this.#h().setAttribute("data-has-video",t.toString())}#r=0;get duration(){return this.#r}set duration(e){const t=_(0)(e);this.#r=t,this.#y().duration=t}#d=0;get startTime(){return this.#d}set startTime(e){const t=_(0)(e);this.#d=t,this.#y().startTime=t}#c=0;get endTime(){return this.#c}set endTime(e){const t=_(0)(e);this.#c=t,this.#y().endTime=t}#w=[];constructor(){super(),C(this,Pt)}#v(){return this.shadowRoot.getElementById("add-filter-select")}#h(){return this.shadowRoot.getElementById("secondary-controls")}#f(){return this.shadowRoot.getElementById("add-overlay-btn")}#b(){return this.shadowRoot.getElementById("secondary-controls-right")}#y(){return this.shadowRoot.getElementById("trim-controls")}#x(){const e=(()=>{const e=Lt.get().map((e=>e.data));return[Et,St,Tt,Ct,It,kt].concat(e).map((e=>({value:a(),label:e.name,data:e})))})();B.isElectron&&e.push({value:"custom",label:"Add custom",data:{}}),this.#w=e,this.#v().options=this.#w}#E(){const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=t=>{t.preventDefault(),t.stopPropagation();const i=e=>this.dispatchEvent(new CustomEvent("showmessage",{bubbles:!0,composed:!0,detail:e})),n=e.files[0];if(!n)return;if("application/json"!==n.type)return i("Error: Only JSON files are accepted");window.NvCompareApi.readShaderFile(n.path).then((e=>{if(!e)return i("Error: Could not read the file you selected");const t={name:e.name,source:e.source,UI:e.UI||{},inputs:e.inputs},a=e=>`Could not import JSON file, missing "${e}" field`;return t.name?t.source?t.inputs?(Lt.set({filename:n.name,path:n.path,created:(new Date).getTime(),data:t}),this.#x(),void this.dispatchEvent(new CustomEvent("add-filter",{composed:!0,bubbles:!0,detail:e}))):i(a("inputs")):i(a("source")):i(a("name"))})).catch((()=>{i("Error: Could not read the file you selected")}))},e.click()}attached(){this.#x();const t=this.#v();e(this,"dropdownclick",(e=>{const t=this.#w.find((t=>t.value===e.detail.value));if(t){if("custom"===t.value){if(!B.isElectron)return;return this.#E()}this.dispatchEvent(new CustomEvent("add-filter",{composed:!0,bubbles:!0,detail:t.data}))}}),t),e(this,"dropdownvisibility",(e=>{e.detail&&this.#x()}),t),e(this,"click",(()=>{this.dispatchEvent(new CustomEvent("selectlogo",{bubbles:!0,composed:!0}))}),this.#f())}});const Ft={},Dt=x(Ft),Vt=w('<div id="timeline-item"><div id="timeline-item-controls"><button-element id="delete-button" size="4" type="link" icon="close" slim="true" hoversecondary="true"></button-element><div id="media-name"></div><button-element id="show-hide-button" size="4" type="link" icon="eye" slim="true" hoversecondary="true"></button-element><button-element id="mute-button" class="video-control" size="4" type="link" icon="speaker-off" slim="true" hoversecondary="true"></button-element><button-element id="previous-frame-button" class="video-control" size="4" type="link" icon="previous-frame" slim="true" hoversecondary="true"></button-element><div id="start-time" class="video-control"></div><button-element id="next-frame-button" class="video-control" size="4" type="link" icon="next-frame" slim="true" hoversecondary="true"></button-element></div><div id="timeline-bar-container"><div id="timeline-thumbnails"></div></div></div>',':host(timeline-item){display:block}#timeline-item{align-items:center;box-shadow:inset 10px 0 5px -10px #111;box-sizing:border-box;display:flex;padding:0 0 0 .5em;width:100%}#timeline-item[data-type=video] .video-control{opacity:1;pointer-events:all}#timeline-item[data-type=audio] #media-name,#timeline-item[data-type=filter] #media-name,#timeline-item[data-type=video] #media-name,#timeline-item[data-type=video] #timeline-thumbnails{cursor:-webkit-grab;cursor:grab}#timeline-item[data-type=overlay] .timeline-thumbnail-image{background-size:contain}#timeline-item[data-show-thumbs="1"] #timeline-thumbnails{background-color:initial;box-shadow:none!important}.video-control{opacity:.25;pointer-events:none}#timeline-item-controls{align-items:center;box-shadow:inset -1px 0 0 #111;display:flex;min-width:27em;padding:.5em 1em .5em 0}#media-name{flex-grow:1;font-size:75%;overflow:hidden;position:relative;text-overflow:ellipsis;white-space:nowrap;width:17em}#delete-button,#media-name,#mute-button,#show-hide-button{margin-right:.5em}#delete-button{margin-left:.125em}#start-time{font-size:75%;text-align:center;width:4em}#timeline-bar-container{flex-grow:1;height:2.5em;overflow:hidden;position:relative;width:100%}#timeline-thumbnails{align-items:center;background-color:#484d62;box-shadow:inset 0 1px 0 0 #505773,inset 0 -1px 0 0 #2d303f;display:flex;flex-wrap:nowrap;height:100%;position:relative}#timeline-thumbnails[data-even=true]{background-color:#3a4452;box-shadow:inset 0 1px 0 0 #40465c,inset 0 -1px 0 0 #303445}.timeline-thumbnail-image{background-position:50% 50%;background-size:cover;height:calc(100% - 2px);pointer-events:none;width:6.6666666667%}');E("timeline-item",class extends v{static get observedAttributes(){return Dt}_stateConfigs=Ft;#r=0;get duration(){return this.#r}set duration(e){const t=_(0)(e);this.#r=t,this.#S()}#d=0;get startTime(){return this.#d}set startTime(e){const t=_(0)(e);this.#d=t,this.#T()}#C={id:"",fps:0,codec:"",bitrate:0,format:"",width:0,height:0,type:"",variableFrameRate:!1,duration:0,size:0,modified:0};get mediaMetadata(){return this.#C}set mediaMetadata(e){this.#C=e,this.#T(),this.#I()}#k={id:"",base:"",path:"",name:"",extension:"",originalBase:""};get mediaNames(){return this.#k}set mediaNames(e){this.#k=e,this.#R().textContent=this.#k.base}#L=[];get mediaThumbnails(){return this.#L}set mediaThumbnails(e){this.#L=e,this.#M()}#A=!0;get mediaVisibility(){return this.#A}set mediaVisibility(e){const t=$(e);this.#A=t,this.#O()}#B=!1;get muteState(){return this.#B}set muteState(e){const t=H(e);this.#B=t,this.#N()}#P=0;get mediaIndex(){return this.#P}set mediaIndex(e){this.#P=e,this.#F().setAttribute("data-even",(e%2==0).toString())}#D=0;get showThumbnails(){return this.#D}set showThumbnails(e){this.#D=e,this.#h().setAttribute("data-show-thumbs",e.toString())}#V=0;constructor(){super(),C(this,Vt)}#R(){return this.shadowRoot.getElementById("media-name")}#U(){return this.shadowRoot.getElementById("delete-button")}#z(){return this.shadowRoot.getElementById("show-hide-button")}#H(){return this.shadowRoot.getElementById("mute-button")}#$(){return this.shadowRoot.getElementById("previous-frame-button")}#_(){return this.shadowRoot.getElementById("next-frame-button")}#q(){return this.shadowRoot.getElementById("start-time")}#G(){return this.shadowRoot.getElementById("timeline-bar-container")}#F(){return this.shadowRoot.getElementById("timeline-thumbnails")}#W(){return Array.from(this.shadowRoot.querySelectorAll(".timeline-thumbnail-image"))}#h(){return this.shadowRoot.getElementById("timeline-item")}#Y(){return!this.#C||this.#C.type&&("video"===this.#C.type||"audio"===this.#C.type)}#O(){this.#z().icon=this.#A?"eye":"eye-off"}#N(){this.#H().icon=this.#B?"speaker-off":"speaker-medium"}#T(){this.#q().textContent=`${st(this.#d)}${T(Math.abs(this.#d),this.#C?this.#C.fps:30)}`}#I(){this.#h().setAttribute("data-type",this.#C?this.#C.type:"filter"),this.#Y()?this.#R().setAttribute("draggable","true"):this.#R().removeAttribute("draggable")}#M=()=>{k({container:this.#F(),array:this.#L||[],getElementsFn:()=>this.#W(),createFn:(e,t)=>y({tag:"div",attributes:{class:"timeline-thumbnail-image","data-index":t.toString(),style:`background-image:url(${e});`}}),valueKeyFn:(e,t)=>t,elementValueKeyFn:e=>parseInt(e.getAttribute("data-index"),10)})};#X=e=>{this.mediaMetadata&&(this.dispatchEvent(new CustomEvent("dopause",{bubbles:!0,composed:!0})),this.dispatchEvent(new CustomEvent("updatemediastarttime",{bubbles:!0,composed:!0,detail:{id:this.mediaMetadata.id,time:e}})))};#S=()=>{this.#C&&(this.#F().style.left="video"===this.#C.type?(this.#d||0)/this.#r*100+"%":"0%",this.#F().style.width="video"===this.#C.type?`${Math.max(0,Math.min(100,this.#C.duration/this.#r*100))}%`:"100%")};attached(){this.#O(),this.#N(),this.#T(),this.#I(),this.#M(),e(this,"click",(()=>{const e=!this.#C||["video","image"].indexOf(this.#C.type)>-1?"deletemedia":"deletelogo";this.dispatchEvent(new CustomEvent(e,{bubbles:!0,composed:!0,detail:this.#k.id}))}),this.#U()),e(this,"click",(()=>{const e=!this.#C||["video","image"].indexOf(this.#C.type)>-1?"toggle-media-visibility":"toggle-overlay-visibility";this.dispatchEvent(new CustomEvent(e,{bubbles:!0,composed:!0,detail:this.#k.id}))}),this.#z()),e(this,"click",(()=>this.dispatchEvent(new CustomEvent("setmute",{bubbles:!0,composed:!0,detail:{id:this.#k.id,value:!this.#B}}))),this.#H()),e(this,"click",(()=>{if(!this.#C)return;const e=L(this.#C.fps),t=this.#d+e;t>=this.#C.duration||this.#X(t)}),this.#$()),e(this,"click",(()=>{if(!this.#C)return;const e=L(this.#C.fps),t=this.#d-e;this.#X(t)}),this.#_()),e(this,"pointerdown",(e=>{if(e.preventDefault(),!this.#C)return;if("video"!==this.#C.type)return;document.body.style.userSelect="none";const t=this.#G().getBoundingClientRect(),i=e=>e-t.left;this.#V=i(e.clientX);const n=e=>{e.preventDefault();const n=i(e.clientX),a=(this.#V-n)/t.width,o=this.duration*a;this.#V=n,this.#X(this.startTime-o)},a=e=>{e.preventDefault(),document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",n),document.removeEventListener("pointerup",a),document.removeEventListener("pointerleave",a)};window.addEventListener("pointermove",n),document.addEventListener("pointerup",a),document.addEventListener("pointerleave",a)}),this.#F());const t=this.#R();t.ondragstart=e=>{this.#Y()||(e.preventDefault(),e.stopPropagation())},t.ondragend=e=>{if(!this.#Y())return e.preventDefault(),void e.stopPropagation();this.dispatchEvent(new CustomEvent("icat-timeline-item-reorder-end",{bubbles:!0,composed:!0,detail:{element:this,x:e.clientX,y:e.clientY}}))}}});const Ut={},zt=x(Ut),Ht=w('<div id="timelines-container"><div id="timeline-items-wrapper"></div><div id="timeline-mask"><div id="timeline-mask-left"></div><div id="timeline-mask-center"></div><div id="timeline-mask-right"></div><div id="playhead"></div></div></div>',"#timelines-container{background-color:#212121;position:relative;width:calc(100% - .5em)}#timelines-container #timeline-items-wrapper{max-height:15em;overflow:overlay}#timelines-container #timeline-items-wrapper timeline-item:nth-child(2n){background-color:#2b2b2b}#timelines-container[data-has-video=false] #timeline-mask{display:none}#timeline-mask{align-items:center;display:flex;height:100%;left:28.5em;pointer-events:none;position:absolute;top:0;width:calc(100% - 28.5em)}#timeline-mask-left,#timeline-mask-right{background-color:#111;height:100%;opacity:.75;position:relative;top:0;width:0}#timeline-mask-center{flex-grow:1}#playhead{background-color:#fff;height:100%;position:absolute;width:1px}");E("timelines-container",class extends v{static get observedAttributes(){return zt}_stateConfigs=Ut;set hasVideo(e){const t=H(e);this.#h().setAttribute("data-has-video",t.toString())}#j=0;get time(){return this.#j}set time(e){const t=_(0)(e);this.#j=t,this.#Z()}#r=0;get duration(){return this.#r}set duration(e){const t=_(0)(e);this.#r=t,this.#Z(),this.#K(),this.#J()}#d=0;get startTime(){return this.#d}set startTime(e){const t=_(0)(e);this.#d=t,this.#Z(),this.#K()}#c=0;get endTime(){return this.#c}set endTime(e){const t=_(0)(e);this.#c=t,this.#Z(),this.#K()}#Q=0;get fps(){return this.#Q}set fps(e){const t=_(0)(e);this.#Q=t,this.#Z()}#C={};get mediaMetadata(){return this.#C}set mediaMetadata(e){this.#C=e,this.#J()}#k={};get mediaNames(){return this.#k}set mediaNames(e){this.#k=e,this.#J()}#ee=[];get mediaOrder(){return this.#ee}set mediaOrder(e){this.#ee=e,this.#J()}#te={};get mediaStartTimes(){return this.#te}set mediaStartTimes(e){this.#te=e,this.#J()}#L={};get mediaThumbnails(){return this.#L}set mediaThumbnails(e){this.#L=e,this.#J()}#A={};get mediaVisibility(){return this.#A}set mediaVisibility(e){this.#A=e,this.#J()}#ie={};get overlayVisibility(){return this.#ie}set overlayVisibility(e){this.#ie=e,this.#J()}#B={};get muteState(){return this.#B}set muteState(e){this.#B=e,this.#J()}#ne=[];get overlays(){return this.#ne}set overlays(e){this.#ne=e,this.#J()}#ae=0;get maxHeight(){return this.#ae}set maxHeight(e){const t=Math.min(3e3,Math.max(e,0));this.#oe().style.height=`${t}px`}#D=0;get showThumbnails(){return this.#D}set showThumbnails(e){this.#D=e,this.#J()}constructor(){super(),C(this,Ht)}#oe(){return this.shadowRoot.getElementById("timeline-items-wrapper")}#se(){return Array.from(this.shadowRoot.querySelectorAll("timeline-item"))}#re(){return this.shadowRoot.getElementById("timeline-mask-left")}#le(){return this.shadowRoot.getElementById("timeline-mask-right")}#de(){return this.shadowRoot.getElementById("playhead")}#h(){return this.shadowRoot.getElementById("timelines-container")}#Z(){this.#de().style.left=this.#j/this.#r*100+"%"}#K(){const e=this.#d,t=this.#c,i=this.#r;this.#re().style.minWidth=e/i*100+"%",this.#le().style.minWidth=(i-t)/i*100+"%"}#J(){const e=e=>-1===this.#ee.findIndex((t=>t===e)),t=t=>{if(e(t)){const e=this.#ne.find((e=>e.id===t));return e?new Array(oe).fill(e.src):[]}return this.#L[`${t}`]},i=t=>e(t)?{id:t,fps:0,codec:"",bitrate:0,format:"",width:0,height:0,type:"overlay",variableFrameRate:!1,duration:0,size:0,modified:0}:this.#C[`${t}`],n=t=>{if(e(t)){const e=this.#ne.find((e=>e.id===t));return{id:t,base:e?e.name:"",path:"",name:"",extension:"",originalBase:""}}return this.#k[`${t}`]},a=t=>e(t)?0:this.#te[`${t}`],o=t=>!!e(t)||this.#B[`${t}`],s=t=>e(t)?this.overlayVisibility[`${t}`]:this.#A[`${t}`];k({container:this.#oe(),array:this.#ne.map((e=>e.id)).concat(this.#ee),getElementsFn:()=>this.#se(),valueKeyFn:e=>e,elementValueKeyFn:e=>e.id,createFn:(e,r)=>y({tag:"timeline-item",attributes:{id:e},properties:{mediaThumbnails:t(e),mediaMetadata:i(e),mediaNames:n(e),startTime:a(e),muteState:o(e),mediaVisibility:s(e),duration:this.#r,mediaIndex:r,showThumbnails:this.#D}}),updateFn:(e,r,l)=>{e.mediaThumbnails=t(r),e.mediaMetadata=i(r),e.mediaNames=n(r),e.startTime=a(r),e.muteState=o(r),e.mediaVisibility=s(r),e.duration=this.#r,e.mediaIndex=l,e.showThumbnails=this.#D}})}getElementAtPoint=(e,t)=>{const i=this.shadowRoot.elementFromPoint(e,t);return i&&"function"==typeof i.getElementAtPoint?i.getElementAtPoint(e,t):i};attached(){this.#K(),this.#J(),this.#Z(),e(this,"icat-timeline-item-reorder-end",(e=>{const t=e.detail.element,i=this.#ee.slice();if(i.length<2)return;if(!t||t&&!t.id)return;const n=t.id,a=i.findIndex((e=>e===n));if(-1===a)return;const o=e.detail.x,s=e.detail.y,r=this.getElementAtPoint(o,s);if(!r||r&&!r.id)return;const l=r.id,d=i.findIndex((e=>e===l));if(-1===d||d===a)return;const c=r.getBoundingClientRect(),h=a<d?0:1,u=d+((s<c.top+c.height/2?-1:0)+h);u<0||u===a||(i.splice(a,1),i.splice(u,0,n),this.dispatchEvent(new CustomEvent("icat-update-media-order",{bubbles:!0,composed:!0,detail:i})))}))}});const $t={},_t=x($t),qt=w('<div id="media-controls"><div id="main-control-bar"><div id="media-controls-buttons"><button-element size="4" iconsize="1em" customstylesdropdown=\'{"fontSize":"75%"}\' slim="true" type="outline" icon="chevron-up" nodropdownicon="true" id="settings-btn" flyoutdirection="right" hoversecondary="true"></button-element><input-element prefixicon="magnifying-glass" prefixiconsize="1.33em" suffixicon="chevron-down" noinnerborders="true" nomargin="true" nominheight="true" slimpadding="true" dropdowndirection="up" classes="very-short-input" tighticons="true" prefixclass="medium-icon" step="1" type="number" id="zoom-input"></input-element><input-element prefixicon="speed" suffixicon="chevron-down" noinnerborders="true" nomargin="true" nominheight="true" slimpadding="true" dropdowndirection="up" classes="very-short-input" tighticons="true" prefixclass="medium-icon" type="select" id="speed-input"></input-element><div id="video-controls"><button-element size="4" iconsize="1em" slim="true" type="outline" icon="previous-frame" id="previous-frame-btn" hoversecondary="true"></button-element><button-element size="4" iconsize="1em" slim="true" type="primary" icon="play" id="play-pause-btn"></button-element><button-element size="4" iconsize="1em" slim="true" type="primary" icon="chevron-down" nodropdownicon="true" id="play-pause-dropdown-btn"></button-element><button-element size="4" iconsize="1em" slim="true" type="outline" icon="next-frame" id="next-frame-btn" hoversecondary="true"></button-element></div><div id="time-duration-display"><div id="time-display"></div><div>/</div><div id="duration-display"></div></div></div><div id="time-controls-container"><trim-controls id="inline-trim-controls"></trim-controls><div id="progress-bar-container"><div id="progress-bar-left-container"></div><div id="progress-bar-center-container"><div id="progress-bar-progress"></div><div id="progress-bar-handle"></div></div><div id="progress-bar-right-container"></div></div></div></div><div id="secondary-playback-controls"><secondary-controls id="secondary-controls"></secondary-controls><timelines-container id="timelines-container"></timelines-container></div><div id="drag-handle"></div></div>',":host{display:block;width:100%}#media-controls{position:relative}#media-controls[data-has-video=false] #speed-input,#media-controls[data-has-video=false] #time-controls-container,#media-controls[data-has-video=false] #time-duration-display,#media-controls[data-has-video=false] #video-controls{display:none}#media-controls[data-show-overlays=false][data-show-filters=false][data-in-out-slider=true] #time-controls-container{padding-bottom:.38em}#media-controls[data-show-overlays=false][data-show-filters=false][data-in-out-slider=true] #time-controls-container #inline-trim-controls{display:flex}#media-controls[data-show-overlays=false][data-show-filters=false][data-in-out-slider=true] #secondary-controls{display:none}#drag-handle{box-shadow:inset 0 3px 0 #76b900;cursor:row-resize;height:15px;opacity:0;position:absolute;right:0;top:0;transition:opacity .2s;width:100%}#drag-handle.active,#drag-handle:hover{opacity:1}#main-control-bar{align-items:center;background-color:#424242;box-shadow:inset 1px 1px 0 #111,inset 10px 0 5px -10px #2b2b2b;box-sizing:border-box;display:flex;padding:.5em;width:100%}#media-controls-buttons{align-items:center;display:flex;min-width:27em}#media-controls-buttons>*{margin:0 .25em}#media-controls-buttons>input-element{font-size:.75em}#video-controls{align-items:center;display:flex}#speed-input,#zoom-input{max-width:6em}#play-pause-btn{margin-left:.125em;margin-right:1px}#play-pause-dropdown-btn{margin-left:0}#first-frame-btn,#next-frame-btn,#play-pause-dropdown-btn,#previous-frame-btn{margin-right:.125em}#last-frame-btn,#next-frame-btn,#play-pause-btn,#previous-frame-btn{margin-left:.125em}#time-duration-display{align-items:center;border-radius:4px;box-shadow:inset 0 0 0 1px hsla(0,0%,93%,.15);display:flex;flex-grow:1;font-size:75%;gap:.25em;justify-content:center;max-width:10em;padding:0 .5em}#time-duration-display>*{opacity:.5}#time-duration-display #time-display{opacity:1}#time-controls-container{align-items:center;display:flex;flex-direction:column;flex-grow:1;gap:.75em;margin-left:1em}#inline-trim-controls{display:none;height:1em}#progress-bar-container{align-items:center;display:flex;width:100%}#progress-bar-left-container{background:#76b900;height:3px;opacity:.38}#progress-bar-right-container{background:#111;height:3px;opacity:.38}#progress-bar-center-container{background:#111;cursor:pointer;flex-grow:1;height:3px;position:relative}#progress-bar-progress{background:#76b900;height:3px}#progress-bar-handle{background:#111;border-radius:50%;box-shadow:inset 0 0 0 2px #76b900;cursor:-webkit-grab;cursor:grab;height:1em;position:absolute;-webkit-transform:translate(-50%,calc(-50% - 1px));transform:translate(-50%,calc(-50% - 1px));width:1em}"),Gt=[{value:-1,label:"Fullscreen"},{value:0,displayValue:!0,label:"Fit"},{value:100,label:100},{value:200,label:200},{value:300,label:300},{value:400,label:400},{value:500,label:500},{value:600,label:600},{value:700,label:700},{value:800,label:800},{value:900,label:900},{value:1e3,label:1e3}],Wt=[{value:.25,label:".25x"},{value:.5,label:".5x"},{value:1,label:"1x"},{value:1.5,label:"1.5x"},{value:2,label:"2x"}],Yt=[].concat(B.isElectron?["thumbnails"]:[]).concat(["grid","antialias"]);E("media-controls",class extends v{static get observedAttributes(){return _t}_stateConfigs=$t;controller;#ce=Yt.slice();set uiVisibility(e){if(!e)return;let t=!1;const i=this.#h();if(!1===e.gridSelect){const e=this.#ce.indexOf("grid");e>-1&&(this.#ce.splice(e,1),t=!0)}else!0===e.gridSelect&&-1===this.#ce.indexOf("grid")&&(this.#ce.push("grid"),t=!0);if(!1===e.speedSelect?this.#he().style.display="none":!0===e.speedSelect&&this.#he().style.removeProperty("display"),!1===e.antiAliasSelect){const e=this.#ce.indexOf("antialias");e>-1&&(this.#ce.splice(e,1),t=!0)}else!0===e.antiAliasSelect&&-1===this.#ce.indexOf("antialias")&&(this.#ce.push("antialias"),t=!0);!1===e.controlBar?i.style.display="none":e.controlBar&&i.style.removeProperty("display"),!1===e.zoomSelect?this.#ue().style.display="none":!0===e.zoomSelect&&this.#ue().style.removeProperty("display"),!1===e.loopButton?this.#me().style.display="none":!0===e.loopButton&&this.#me().style.removeProperty("display"),i.setAttribute("data-in-out-slider",(!!e.inOutSlider).toString()),void 0===e.inOutSlider&&void 0===e.addLogoBtn||(this.#pe().uiVisibility=e,!1===e.inOutSlider&&!1===e.addLogoBtn?(this.#ge().style.minWidth="unset",this.#be().style.display="none",this.#fe().style.display="none"):(this.#ge().style.removeProperty("min-width"),this.#be().style.removeProperty("display"),this.#fe().style.removeProperty("display"))),i.setAttribute("data-timelines",(!!e.timeline).toString()),!1===e.timeline?(this.#ve().style.display="none",this.#ye().style.display="none"):!0===e.timeline&&(this.#ye().style.removeProperty("display"),this.#ve().style.removeProperty("display")),i.setAttribute("data-show-overlays",(!!e.addLogoBtn).toString()),i.setAttribute("data-show-filters",(!!e.addFilterBtn).toString()),t&&this.#we()}#xe=!1;get looping(){return this.#xe}set looping(e){const t=H(e);this.#xe=t,this.#Ee()}#Se=!1;get playing(){return this.#Se}set playing(e){const t=H(e);this.#Se=t,this.#Ee()}#Te=!1;get boomerang(){return this.#Te}set boomerang(e){const t=H(e);this.#Te=t,this.#Ee()}#Ce=100;get fitScale(){return this.#Ce}set fitScale(e){const t=_(100)(e);this.#Ce=t,this.#Ie()}#ke=100;get minScale(){return this.#ke}set minScale(e){const t=_(100)(e);this.#ke=t,this.#Ie()}#Re=100;get zoom(){return this.#Re}set zoom(e){const t=_(100)(e);this.#Re=t,this.#ue().value=t}#Le=1;get speed(){return this.#Le}set speed(e){const t=_(1)(e);this.#Le=t,this.#he().value=t}#Me=0;get grid(){return this.#Me}set grid(e){const t=_(0)(e);this.#Me=t,this.#we()}#Ae=!1;get antiAlias(){return this.#Ae}set antiAlias(e){const t=H(e);this.#Ae=t,this.#we()}#j=0;get time(){return this.#j}set time(e){const t=_(0)(e);this.#j=t,this.#Z(),this.#ye().time=t}#r=0;get duration(){return this.#r}set duration(e){const t=_(0)(e);this.#r=t,this.#Oe(),this.#Z(),this.#pe().duration=t,this.#ye().duration=t,this.#Be().duration=t}#d=0;get startTime(){return this.#d}set startTime(e){const t=_(0)(e);this.#d=t,this.#Oe(),this.#Z(),this.#pe().startTime=t,this.#ye().startTime=t,this.#Be().startTime=t}#c=0;get endTime(){return this.#c}set endTime(e){const t=_(0)(e);this.#c=t,this.#Oe(),this.#Z(),this.#pe().endTime=t,this.#ye().endTime=t,this.#Be().endTime=t}#Q=0;get fps(){return this.#Q}set fps(e){const t=_(0)(e);this.#Q=t,this.#Oe(),this.#Z(),this.#ye().fps=t}#B={};get muteState(){return this.#B}set muteState(e){this.#ye().muteState=e}#D=0;get showThumbnails(){return this.#D}set showThumbnails(e){this.#D=e,this.#we(),this.#ye().showThumbnails=e}set overlays(e){this.#ye().overlays=e}set mediaMetadata(e){const t=Object.keys(e||{}).reduce(((t,i)=>t||"video"===e[`${i}`].type),!1);this.#h().setAttribute("data-has-video",t.toString()),this.#pe().hasVideo=t,this.#ye().hasVideo=t,this.#ye().mediaMetadata=e}set mediaNames(e){this.#ye().mediaNames=e}set mediaOrder(e){this.#ye().mediaOrder=e}set mediaStartTimes(e){this.#ye().mediaStartTimes=e}set mediaVisibility(e){this.#ye().mediaVisibility=e}set overlayVisibility(e){this.#ye().overlayVisibility=e}set mediaThumbnails(e){this.#ye().mediaThumbnails=e}constructor(){super(),C(this,qt)}#Ne(){return this.shadowRoot.getElementById("play-pause-btn")}#me(){return this.shadowRoot.getElementById("play-pause-dropdown-btn")}#$(){return this.shadowRoot.getElementById("previous-frame-btn")}#_(){return this.shadowRoot.getElementById("next-frame-btn")}#ue(){return this.shadowRoot.getElementById("zoom-input")}#he(){return this.shadowRoot.getElementById("speed-input")}#Pe(){return this.shadowRoot.getElementById("settings-btn")}#Fe(){return this.shadowRoot.getElementById("duration-display")}#De(){return this.shadowRoot.getElementById("time-display")}#be(){return this.shadowRoot.getElementById("progress-bar-left-container")}#fe(){return this.shadowRoot.getElementById("progress-bar-right-container")}#Ve(){return this.shadowRoot.getElementById("progress-bar-progress")}#Ue(){return this.shadowRoot.getElementById("progress-bar-handle")}#ze(){return this.shadowRoot.getElementById("progress-bar-center-container")}#pe(){return this.shadowRoot.getElementById("secondary-controls")}#Be(){return this.shadowRoot.getElementById("inline-trim-controls")}#ye(){return this.shadowRoot.getElementById("timelines-container")}#ve(){return this.shadowRoot.getElementById("drag-handle")}#He(){return this.shadowRoot.getElementById("main-control-bar")}#h(){return this.shadowRoot.getElementById("media-controls")}#ge(){return this.shadowRoot.getElementById("media-controls-buttons")}#Oe(){const e=this.#c-this.#d;this.#Fe().textContent=T(e,this.#Q)}#Z(){const e=this.#j-this.#d;this.#De().textContent=T(e,this.#Q),this.#$e()}#$e(){const e=this.#be(),t=this.#fe(),i=this.#Ve(),n=this.#Ue(),a=this.#d,o=this.#c,s=this.#r,r=(this.#j-a)/(o-a)*100;e.style.minWidth=a/s*100+"%",t.style.minWidth=(s-o)/s*100+"%",i.style.width=`${r}%`,n.style.left=`${r}%`}#Ee(){const e=this.#Ne(),t=this.#xe,i=this.#Se,n=this.#Te;let a="1em";i?e.icon="pause":t?(e.icon="loop",a="0.85em"):e.icon=n?"mirror":"play",e.iconsize=a}#Ie(){const e=this.#ue(),t=Gt.slice();t[1]={value:Math.ceil(this.#Ce),displayValue:!0,label:"Fit"},e.options=t}#we(){const e=this.#Me,t=this.#Ae,i=this.#Pe(),n=[];if(0===this.#ce.length)return i.options=[],void(i.style.display="none");i.style.removeProperty("display"),this.#ce.indexOf("thumbnails")>-1&&n.push({label:"Show thumbnails",value:this.#D,onclick:"show-thumbnails-update",displayLabelValue:!0,options:[{label:"Off",value:0},{label:"On",value:1}]}),this.#ce.indexOf("grid")>-1&&n.push({label:"Grid overlay",value:e,onclick:"grid-update",displayLabelValue:!0,options:[{label:"None",value:0},{label:"Small",value:1},{label:"Medium",value:2},{label:"Large",value:3}]}),this.#ce.indexOf("antialias")>-1&&n.push({label:"Filtering Mode",value:t,onclick:"antialias-update",displayLabelValue:!0,options:[{label:"Nearest Neighbor",value:!1},{label:"Bilinear",value:!0}]}),i.options=n}getElementAtPoint=(e,t)=>{const i=this.shadowRoot.elementFromPoint(e,t);return i&&"function"==typeof i.getElementAtPoint?i.getElementAtPoint(e,t):i};attached(){const t=e=>{e.preventDefault(),e.stopPropagation()};this.#Ie(),this.#Oe(),this.#Z();const i=this.#Ne();i.customStyles={borderRadius:"2px 0 0 2px"},i.onclick=()=>{this.#Se?this.dispatchEvent(new CustomEvent("dopause",{bubbles:!0,composed:!0})):this.dispatchEvent(new CustomEvent("doplay",{bubbles:!0,composed:!0}))};const n=this.#me();n.customStyles={borderRadius:"0 2px 2px 0",paddingLeft:"0",paddingRight:"0"},n.customStylesDropdown={fontSize:"0.75em"},n.options=[{label:"Play",icon:"play",iconsize:"1.125em",onclick:"play-normal"},{label:"Loop",icon:"loop",onclick:"play-loop"}],e(this,"play-normal",(e=>{t(e),this.dispatchEvent(new CustomEvent("setlooping",{bubbles:!0,composed:!0,detail:!1})),this.dispatchEvent(new CustomEvent("setboomerang",{bubbles:!0,composed:!0,detail:!1})),this.dispatchEvent(new CustomEvent("doplay",{bubbles:!0,composed:!0}))}),n),e(this,"play-loop",(e=>{t(e),this.dispatchEvent(new CustomEvent("setlooping",{bubbles:!0,composed:!0,detail:!0})),this.dispatchEvent(new CustomEvent("setboomerang",{bubbles:!0,composed:!0,detail:!1})),this.dispatchEvent(new CustomEvent("doplay",{bubbles:!0,composed:!0}))}),n),e(this,"play-boomerang",(e=>{t(e),this.dispatchEvent(new CustomEvent("setlooping",{bubbles:!0,composed:!0,detail:!1})),this.dispatchEvent(new CustomEvent("setboomerang",{bubbles:!0,composed:!0,detail:!0})),this.dispatchEvent(new CustomEvent("doplay",{bubbles:!0,composed:!0}))}),n),e(this,"click",(()=>{this.dispatchEvent(new CustomEvent("gopreviousframe",{bubbles:!0,composed:!0}))}),this.#$()),e(this,"click",(()=>{this.dispatchEvent(new CustomEvent("gonextframe",{bubbles:!0,composed:!0}))}),this.#_()),this.#we();const a=this.#Pe();e(this,"show-thumbnails-update",(e=>{t(e),this.dispatchEvent(new CustomEvent("show-thumbnails",{bubbles:!0,composed:!0,detail:e.detail.value}))}),a),e(this,"grid-update",(e=>{t(e),this.dispatchEvent(new CustomEvent("setgrid",{bubbles:!0,composed:!0,detail:e.detail.value}))}),a),e(this,"antialias-update",(e=>{t(e),this.dispatchEvent(new CustomEvent("antialiasupdate",{bubbles:!0,composed:!0,detail:e.detail.value}))}),a);const o=this.#ue(),s=e=>{const t=Math.ceil(this.#ke);let i=e;i<t&&(i=t),this.dispatchEvent(new CustomEvent("zoomupdate",{bubbles:!0,composed:!0,detail:i})),o.getValue()!==this.#Re&&(o.value=this.#Re)};e(this,"inputvalue",(e=>{t(e);const i=Math.ceil(this.#ke),n=o.getValue();if(-1===n)return o.value=-2,o.value=this.#Re,this.dispatchEvent(new CustomEvent("togglefullscreen",{bubbles:!0,composed:!0}));n<i||s(n)}),o),e(this,"inputblur",(e=>{t(e),s(o.getValue())}),o);const r=this.#he();r.options=V(Wt),r.value=this.#Le;const l=e=>{this.dispatchEvent(new CustomEvent("speedupdate",{bubbles:!0,composed:!0,detail:e}))};e(this,"inputvalue",(e=>{t(e),l(r.getValue())}),r),e(this,"inputblur",(e=>{t(e),l(r.getValue())}),r);const d=this.#ze();e(this,"pointerdown",(e=>{this.dispatchEvent(new CustomEvent("dopause",{bubbles:!0,composed:!0}));const t=this.#d,i=this.#c-t,n=d.getBoundingClientRect(),a=(e.clientX-n.left)/n.width,o=i*a;this.dispatchEvent(new CustomEvent("updatetime",{bubbles:!0,composed:!0,detail:{time:o,updatePlayers:!0}}));const s=(e,t=!1)=>{e.preventDefault();const n=d.getBoundingClientRect(),a=(e.clientX-n.left)/n.width,o=i*a;this.dispatchEvent(new CustomEvent("updatetime",{bubbles:!0,composed:!0,detail:{time:o,updatePlayers:t}}))},r=e=>{e.preventDefault(),document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",s),document.removeEventListener("pointerup",r),document.removeEventListener("pointerleave",r),s(e,!0)};document.body.style.userSelect="none",window.addEventListener("pointermove",s),document.addEventListener("pointerup",r),document.addEventListener("pointerleave",r)}),d);const c=this.#ve(),h=this.#ye(),u=this.#He(),m=this.#pe();e(this,"pointerdown",(e=>{let t=0;const i=m.offsetHeight,n=u.offsetHeight,a=e=>{const a=this.controller.getBoundingClientRect(),o=(a.height-(e.clientY+t-a.top))/a.height*a.height-(i+n);h.maxHeight=o};c.classList.add("active");const o=this.getBoundingClientRect();t=o.top-e.clientY,a(e);const s=e=>{e.preventDefault(),a(e)},r=e=>{e.preventDefault(),c.classList.remove("active"),document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",s),document.removeEventListener("pointerup",r),document.removeEventListener("pointerleave",r),s(e)};document.body.style.userSelect="none",window.addEventListener("pointermove",s),document.addEventListener("pointerup",r),document.addEventListener("pointerleave",r)}),c)}});const Xt={logo:{onChange(e,t){if(e&&e.src){if(t.previous.src!==e.src){this.image().src=e.src}this.setStyle()}}},styleString:{attribute:!1},active:{formatter:H},hideEdit:{formatter:$,onChange(e){this.container().setAttribute("data-editable",(!e).toString())}},visible:{formatter:$}},jt=x(Xt),Zt=w('<div id="logo-container" bind-attr-visible="data-show"><div id="image-container" bind-attr-stylestring="style" bind-attr-active="data-active" draggable="false" bind-attr-hideedit="data-update"><img id="logo-image" draggable="false"><div class="logo-controls"><div class="resizers"><div class="resizer-handle" id="top-left-handle"></div><div class="resizer-handle" id="top-right-handle"></div><div class="resizer-handle" id="bottom-left-handle"></div><div class="resizer-handle" id="bottom-right-handle"></div></div></div></div></div>',':host(logo-element){display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}#logo-container{height:100%;pointer-events:none;width:100%}#logo-container[data-show=false]{display:none}#logo-container #image-container{display:inline-flex;max-width:95%;pointer-events:all;position:relative}#logo-container #image-container img{display:block;pointer-events:all;width:100%}#logo-container #image-container .logo-controls{height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}#logo-container #image-container .logo-controls .resizers{height:100%;pointer-events:none;position:relative;width:100%}#logo-container #image-container .logo-controls .resizers:before{box-shadow:0 0 0 1px #fff;content:"";height:100%;left:0;opacity:0;position:absolute;top:0;transition:opacity .2s;width:100%}#logo-container #image-container .logo-controls .resizers .resizer-handle{background:#fff;border-radius:50%;height:10px;opacity:0;pointer-events:none;position:absolute;transition:opacity .2s;width:10px}#logo-container #image-container .logo-controls .resizers .resizer-handle#top-left-handle{cursor:nwse-resize;left:-5px;top:-5px}#logo-container #image-container .logo-controls .resizers .resizer-handle#top-right-handle{cursor:nesw-resize;right:-5px;top:-5px}#logo-container #image-container .logo-controls .resizers .resizer-handle#bottom-left-handle{bottom:-5px;cursor:nesw-resize;left:-5px}#logo-container #image-container .logo-controls .resizers .resizer-handle#bottom-right-handle{bottom:-5px;cursor:nwse-resize;right:-5px}#logo-container #image-container[data-editable=true] img{cursor:move}#logo-container #image-container[data-editable=true]:hover .logo-controls .resizers:before,#logo-container #image-container[data-editable=true][data-active=true] .logo-controls .resizers:before{opacity:1}#logo-container #image-container[data-editable=true]:hover .logo-controls .resizers .resizer-handle,#logo-container #image-container[data-editable=true][data-active=true] .logo-controls .resizers .resizer-handle{opacity:1;pointer-events:all}#logo-container #image-container[data-editable=true] .resizers:hover:before{opacity:1}#logo-container #image-container[data-editable=true] .resizers:hover .resizer-handle{opacity:1;pointer-events:all}');E("logo-element",class extends v{static get observedAttributes(){return jt}_stateConfigs=Xt;availableWidth=0;availableHeight=0;resizeObserver;resizing=!1;active=!1;hideEdit=!1;visible=!0;logo={displayWidth:0,height:0,width:0,id:"",name:"",src:"",x:0,y:0,visible:!0,path:"",size:0,modified:0};styleString="";constructor(){super(),C(this,Zt)}#_e(){return this.shadowRoot.getElementById("top-left-handle")}#qe(){return this.shadowRoot.getElementById("top-right-handle")}#Ge(){return this.shadowRoot.getElementById("bottom-left-handle")}#We(){return this.shadowRoot.getElementById("bottom-right-handle")}availableDimensions(){return this.getBoundingClientRect()}container(){return this.shadowRoot.getElementById("image-container")}image(){return this.shadowRoot.getElementById("logo-image")}deleteLogo=()=>{this.dispatchEvent(new CustomEvent("deletelogo",{bubbles:!0,composed:!0,detail:this.logo.id}))};setViewport=()=>{this.availableWidth=this.offsetWidth,this.availableHeight=this.offsetHeight,this.setStyle()};setStyle(){const e=this.logo;let t=e.displayWidth;let i=e.displayWidth/100*this.availableWidth/e.width*e.height/this.availableHeight,n=e.y,a=e.x;i>.85&&(i=.85,t=this.availableHeight*i/this.availableWidth*(e.width/e.height)*100),n+100*i>100&&(n=100-100*i),a+t>100&&(a=100-t),this.styleString=`width:${t}%;left:${a}%;top:${n}%;`}attached(){this.resizeObserver=new ResizeObserver((()=>this.setViewport())),this.resizeObserver.observe(this),this.setViewport();const t=this.image();e(this,"pointerdown",(e=>{let i=0,n=0;const a=e=>{const a=this.getBoundingClientRect(),o=t.getBoundingClientRect();let s=e.clientX+i-a.left,r=e.clientY+n-a.top;s+o.width+a.left>a.right?(i-=s-(a.right-a.left-o.width),s=e.clientX+i-a.left):s<0&&(i-=s,s=e.clientX+i-a.left),r+o.height+a.top>a.bottom?(n-=r-(a.bottom-a.top-o.height),r=e.clientY+n-a.top):r<0&&(n-=r,r=e.clientY+n-a.top);const l=s/a.width*100,d=r/a.height*100;this.dispatchEvent(new CustomEvent("updatelogovalues",{bubbles:!0,composed:!0,detail:{id:this.logo.id,data:{x:l,y:d}}}))};this.active=!0;const o=t.getBoundingClientRect();i=o.left-e.clientX,n=o.top-e.clientY,a(e);const s=e=>{e.preventDefault(),a(e)},r=e=>{e.preventDefault(),this.active=!1,document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",s),document.removeEventListener("pointerup",r),document.removeEventListener("pointerleave",r),s(e)};document.body.style.userSelect="none",window.addEventListener("pointermove",s),document.addEventListener("pointerup",r),document.addEventListener("pointerleave",r)}),t);e(this,"pointerdown",(e=>{const i=e=>{const i=this.getBoundingClientRect(),n=t.getBoundingClientRect(),a=Math.max(0,e.clientX+0-i.left),o=Math.max(0,e.clientY+0-i.top),s=i.right-n.left,r=i.bottom-n.top,l=Math.min(Math.max(10,n.right-i.left-a),s),d=Math.min(Math.max(10,n.bottom-i.top-o),r),c=Math.min(l/n.width,d/n.height),h=n.width*c/i.width,u=(n.right-i.left-n.width*c)/i.width,m=(n.bottom-i.top-n.height*c)/i.height;this.dispatchEvent(new CustomEvent("updatelogovalues",{bubbles:!0,composed:!0,detail:{id:this.logo.id,data:{x:100*u,y:100*m,displayWidth:100*h}}}))};this.active=!0,i(e);const n=e=>{e.preventDefault(),i(e)},a=e=>{e.preventDefault(),this.active=!1,document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",n),document.removeEventListener("pointerup",a),document.removeEventListener("pointerleave",a),n(e)};document.body.style.userSelect="none",window.addEventListener("pointermove",n),document.addEventListener("pointerup",a),document.addEventListener("pointerleave",a)}),this.#_e());e(this,"pointerdown",(e=>{const i=e=>{const i=this.getBoundingClientRect(),n=t.getBoundingClientRect(),a=Math.max(0,e.clientY+0-i.top),o=i.right-n.left,s=i.bottom-n.top,r=Math.min(Math.max(10,e.clientX+0-n.left),o),l=Math.min(Math.max(10,n.bottom-i.top-a),s),d=Math.min(r/n.width,l/n.height),c=n.width*d/i.width,h=Math.max(0,(n.bottom-i.top-n.height*d)/i.height);this.dispatchEvent(new CustomEvent("updatelogovalues",{bubbles:!0,composed:!0,detail:{id:this.logo.id,data:{y:100*h,displayWidth:100*c}}}))};this.active=!0,i(e);const n=e=>{e.preventDefault(),i(e)},a=e=>{e.preventDefault(),this.active=!1,document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",n),document.removeEventListener("pointerup",a),document.removeEventListener("pointerleave",a),n(e)};document.body.style.userSelect="none",window.addEventListener("pointermove",n),document.addEventListener("pointerup",a),document.addEventListener("pointerleave",a)}),this.#qe());e(this,"pointerdown",(e=>{const i=e=>{const i=this.getBoundingClientRect(),n=t.getBoundingClientRect(),a=Math.max(0,e.clientX+0-i.left),o=i.right-n.left,s=i.bottom-n.top,r=Math.min(Math.max(10,n.right-i.left-a),o),l=Math.min(Math.max(10,e.clientY+0-n.top),s),d=Math.min(r/n.width,l/n.height),c=n.width*d/i.width,h=Math.max(0,(n.right-i.left-n.width*d)/i.width);this.dispatchEvent(new CustomEvent("updatelogovalues",{bubbles:!0,composed:!0,detail:{id:this.logo.id,data:{x:100*h,displayWidth:100*c}}}))};this.active=!0,i(e);const n=e=>{e.preventDefault(),i(e)},a=e=>{e.preventDefault(),this.active=!1,document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",n),document.removeEventListener("pointerup",a),document.removeEventListener("pointerleave",a),n(e)};document.body.style.userSelect="none",window.addEventListener("pointermove",n),document.addEventListener("pointerup",a),document.addEventListener("pointerleave",a)}),this.#Ge());e(this,"pointerdown",(e=>{const i=e=>{const i=this.getBoundingClientRect(),n=t.getBoundingClientRect(),a=i.right-n.left,o=i.bottom-n.top,s=Math.min(Math.max(10,e.clientX+0-n.left),a),r=Math.min(Math.max(10,e.clientY+0-n.top),o),l=Math.min(s/n.width,r/n.height),d=n.width*l/i.width;this.dispatchEvent(new CustomEvent("updatelogovalues",{bubbles:!0,composed:!0,detail:{id:this.logo.id,data:{displayWidth:100*d}}}))};this.active=!0,i(e);const n=e=>{e.preventDefault(),i(e)},a=e=>{e.preventDefault(),this.active=!1,document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",n),document.removeEventListener("pointerup",a),document.removeEventListener("pointerleave",a),n(e)};document.body.style.userSelect="none",window.addEventListener("pointermove",n),document.addEventListener("pointerup",a),document.addEventListener("pointerleave",a)}),this.#We())}detached(){this.resizeObserver.disconnect()}});const Kt={visible:{formatter:H,onChange(i){this.setAttribute("data-showing",i),this._resizeObserver&&this._resizeObserver.disconnect();const n=this.container();if(!n)return;const a=this.content();a&&(this._box=a.getBoundingClientRect(),i?(e(this,"keydown",(e=>{if(!this.visible)return t(this,"keydown",n);e.path&&"INPUT"===e.path[0].tagName||"Escape"===e.key&&this.visible&&(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),this.close(),t(this,"keydown",n),this.dispatchEvent(new CustomEvent("appfocus",{bubbles:!0,composed:!0})))}),n),n.focus(),this.setPosition(),this._resizeObserver=new ResizeObserver((()=>{this._box=a.getBoundingClientRect(),this.setPosition()})),this._resizeObserver.observe(n)):(this.position={x:0,y:0},this._box=null,n.blur(),t(this,"keydown",n),this.dispatchEvent(new CustomEvent("contentoverlayclose",{bubbles:!0,composed:!0,detail:this}))))}},scrim:{formatter:$},closable:{formatter:$},movable:{formatter:H,onChange(e){e||(this.position={x:0,y:0})}},position:{onChange(){this.setPosition()}},hasFooter:{formatter:H},removeContentOnClose:{formatter:$}},Jt=x(Kt),Qt=w('<div id="content-overlay-container" bind-attr-visible="data-shown" bind-attr-movable="data-movable" bind-attr-hasfooter="data-has-footer" bind-attr-scrim="data-scrim" tabindex="0" bind-attr-closable="data-closable"><div class="content-overlay-inner"><div class="content-overlay-background"><slot name="scrim"><div class="content-overlay-background-content"></div></slot></div><div class="content-overlay-box-outer"><div class="heading-container"><div class="heading" bind-events="pointerdown:handleDragstart"><slot name="heading"></slot></div><div id="content-overlay-close"><button-element id="close-button" icon="close" type="link" bind-events="click:close" size="3" iconsize="1.137em"></button-element></div></div><div class="content-box"><div id="content"><slot></slot></div></div><div class="footer-container"><div class="footer"><slot name="footer"></slot></div></div></div></div></div>',":host{height:100%;left:0;pointer-events:none;position:fixed;top:0;width:100%;z-index:99999}:host(content-overlay[data-showing=false]){display:none}#content-overlay-container{height:100%;left:0;opacity:0;outline:none!important;pointer-events:none;position:absolute;top:0;width:100%;z-index:-1}#content-overlay-container[data-shown=true]{opacity:1;z-index:99999}#content-overlay-container[data-shown=true] .content-overlay-inner .content-box,#content-overlay-container[data-shown=true] .content-overlay-inner .content-overlay-box-outer{pointer-events:all}#content-overlay-container[data-shown=true][data-scrim=true] .content-overlay-background{opacity:1;pointer-events:all}#content-overlay-container[data-shown=true][data-has-footer=true] .footer-container{background-color:#2b2b2b;padding:1em}#content-overlay-container[data-shown=true][data-has-footer=true] #close-button{padding:.73em .25em}#content-overlay-container[data-closable=false] #close-button{display:none}#content-overlay-container .content-overlay-inner{align-items:center;color:inherit;display:flex;height:100%;justify-content:center;position:relative;width:100%}#content-overlay-container .content-overlay-inner .content-overlay-background{height:100%;opacity:0;pointer-events:none;position:absolute;width:100%}#content-overlay-container .content-overlay-inner .content-overlay-background .content-overlay-background-content,#content-overlay-container .content-overlay-inner .content-overlay-background [slot=scrim]{height:100%;position:absolute;width:100%}#content-overlay-container .content-overlay-inner .content-overlay-background .content-overlay-background-content{background-color:#000;opacity:.8}#content-overlay-container .content-overlay-inner .content-overlay-box-outer{align-items:center;border-radius:4px;box-shadow:0 10px 20px -10px #000,0 0 2em rgba(0,0,0,.5);display:inline-flex;flex-direction:column;justify-content:center;max-height:90%;max-width:90%;min-width:20em;pointer-events:none;position:relative;width:auto}#content-overlay-container .content-overlay-inner .content-box{align-items:flex-start;background:#2b2b2b;box-sizing:border-box;display:flex;flex-wrap:nowrap;min-width:100%;overflow:auto;padding:1em}#content-overlay-container .content-overlay-inner .content-box #content{flex-grow:1}#content-overlay-container[data-movable=true] .heading-container .heading{cursor:-webkit-grab;cursor:grab}.heading-container{align-items:flex-start;background-color:#2b2b2b;border-radius:4px 4px 0 0;display:flex;flex-wrap:nowrap;justify-content:space-between;min-width:100%}.heading-container .heading{align-self:center;flex-grow:1;padding:1.5em 1em 1em}#close-button{border-radius:0 4px 0 0;cursor:pointer;padding:.25em;transition:background-color .2s}#close-button:hover{background-color:#424242}.footer-container{border-radius:0 0 4px 4px;box-sizing:border-box;min-width:100%}.footer-container .footer{align-items:center;display:flex;justify-content:flex-end;min-width:100%}slot[name=heading]{font-size:1.5em}");E("content-overlay",class extends v{static get observedAttributes(){return Jt}_stateConfigs=Kt;_box=null;_resizeObserver=null;position={x:0,y:0};visible=!1;hasFooter=!1;scrim=!0;movable=!1;closable=!0;removeContentOnClose=!0;constructor(){super(),C(this,Qt)}container(){return this.shadowRoot.getElementById("content-overlay-container")}heading(){return this.shadowRoot.querySelector(".heading-container .heading")}content(){return this.shadowRoot.querySelector(".content-overlay-box-outer")}close=()=>{this.removeContentOnClose&&(this.innerHTML=""),this.visible=!1};resetScroll(){this.shadowRoot.querySelector(".content-box").scrollTo(0,0)}updateVisible(){const e=Array.from(this.children),t=e.findIndex((e=>"footer"===e.slot))>-1;this.removeContentOnClose&&(this.visible=e.length>0),this.hasFooter=t}childrenCallback(){this.updateVisible()}focus(){if(this.visible)try{this.container().focus()}catch(e){}}setPosition=()=>{if(!this.position)return;const e=this.content();this._box||(this._box=e.getBoundingClientRect());const t=(this.offsetHeight-this._box.height)/this._box.height/2;let i=this.position.y/100;i>t&&(i=t),i<-t&&(i=-t);const n=(this.offsetWidth-this._box.width)/this._box.width/2;let a=this.position.x/100;a>n&&(a=n),a<-n&&(a=-n),e.style.transform=`translateX(${100*a}%) translateY(${100*i}%)`};handleDragstart=e=>{if(e.preventDefault(),e.stopPropagation(),!this.movable)return;document.body.style.userSelect="none";const t=this.content(),i=e.clientX,n=e.clientY,a=this.position.x/100,o=this.position.y/100;this._box=t.getBoundingClientRect();const s=it((e=>{e.preventDefault();const t=e.clientX-i,s=e.clientY-n,r=(this.offsetHeight-this._box.height)/this._box.height/2,l=(this.offsetWidth-this._box.width)/this._box.width/2;let d=t/this._box.width+a,c=s/this._box.height+o;Number.isFinite(d)&&Number.isFinite(c)&&(d<-l&&(d=-l),d>l&&(d=l),c>r&&(c=r),c<-r&&(c=-r),this.position={x:100*d,y:100*c})}),100),r=e=>{e.preventDefault(),document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",s),document.removeEventListener("pointerup",r),document.removeEventListener("pointerleave",r)};window.addEventListener("pointermove",s),document.addEventListener("pointerup",r),document.addEventListener("pointerleave",r)};attached(){this.updateVisible()}});const ei={active:{formatter:H,onChange(){this.update()}},fps:{attribute:!1}},ti=x(ei),ii=w('<div id="fps-overlay-container" bind-attr-active="data-show"><div bind-prop-fps="textContent"></div><div>&nbsp;FPS</div></div>',':host{display:block;height:0;left:0;max-width:100%;pointer-events:none;position:absolute;top:0;width:0}#fps-overlay-container{align-items:center;box-sizing:border-box;display:inline-flex;font-size:75%;opacity:0;padding:.5em 1em;position:relative;transition:opacity .2s}#fps-overlay-container:before{background-color:#2b2b2b;border-radius:4px;content:"";height:100%;left:0;opacity:.5;position:absolute;top:0;width:100%}#fps-overlay-container[data-show=true]{opacity:1}');E("fps-overlay",class extends v{static get observedAttributes(){return ti}_stateConfigs=ei;active=!1;fps=0;times=[];timer;constructor(){super(),C(this,ii)}run=()=>{cancelAnimationFrame(this.timer),this.active&&(this.timer=window.requestAnimationFrame((()=>{const e=performance.now();for(;this.times.length>0&&this.times[0]<=e-1e3;)this.times.shift();this.times.push(e),this.fps=this.times.length,this.run()})))};update(){this.active?this.run():(cancelAnimationFrame(this.timer),this.times=[],this.fps=0)}});class ni{gl;mediaElements=[];inputCount=0;shader;shaderSettings={};hasAllInputs=!1;textures=[];drawListeners=[];switchedCanvasListeners=[];rendering=!1;queued=!1;width=0;height=0;constructor(e){this.gl=e.getContext("webgl2",{antialias:!1,preserveDrawingBuffer:!0,alpha:!0}),this.gl.getExtension("EXT_color_buffer_float"),this.gl.getExtension("EXT_float_blend"),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0)}setUniforms(e){this.shaderSettings=e,this.render()}render=()=>{this.rendering?this.queued=!0:this.hasAllInputs&&this.shader&&this.textures.length===this.inputCount&&(this.rendering=!0,this.setDimensions(this.mediaElements),this.textures.forEach((e=>{e.use(),this.shader.setUniforms(this.shaderSettings).draw()})),this.gl.canvas.dispatchEvent(new CustomEvent("canvasdraw",{bubbles:!0,composed:!0,detail:this.gl.canvas})),this.rendering=!1,(this.queued||this.shader.constantRender)&&requestAnimationFrame((()=>{this.queued=!1,this.render()})))};setDimensions(e){let t=0,i=0;e.forEach((e=>{e&&(t=Math.max(e.naturalWidth||e.videoWidth||e.width,t),i=Math.max(e.naturalHeight||e.videoHeight||e.height,i))})),t===this.width&&i===this.height||(this.width=t,this.height=i,this.shader.width=t,this.shader.height=i,this.gl.canvas.width=t,this.gl.canvas.height=i,this.gl.canvas.style.width=`${t}px`,this.gl.canvas.style.height=`${i}px`,this.gl.viewport(0,0,t,i))}loadMedia(e){this.mediaElements=e;let t=e.length===this.inputCount;this.drawListeners.forEach((e=>e())),this.textures.forEach((e=>e.dispose())),this.textures=[],e.forEach(((e,i)=>{if(!e)return void(t=!1);const n=qe(this.gl,e,i,this.shader.program);this.textures.push(n),e.addEventListener("canvasdraw",this.render),this.drawListeners.push((()=>e.removeEventListener("canvasdraw",this.render)))})),this.setDimensions(e),this.hasAllInputs=t,this.render()}loadShader(e,t,i){this.shaderSettings=i,this.inputCount=t,this.shader=Ge(this.gl,e)}getScreenshot(){const e=document.createElement("canvas").getContext("2d");return e.canvas.width=this.width,e.canvas.height=this.height,e.drawImage(this.gl.canvas,0,0),e.canvas.toDataURL()}dispose(){this.drawListeners.forEach((e=>e())),this.textures.forEach((e=>e.dispose())),this.shader&&this.shader.dispose()}}const ai={index:{formatter:_(0)},position:{onChange(){this.resize()}},layout:{onChange(){this.setViewport()}},viewportWidth:{onChange(){this.setViewport()}},uiSettings:{onChange(e){this.renderer&&this.renderer.setUniforms(e)}},inputMedia:{onChange(e){this.renderer&&this.renderer.loadMedia(e.map((e=>e?e.element:null)))}},shaderSource:{onChange(e){this.renderer&&this.renderer.loadShader(e.source,e.inputs,e.defaultSettings)}},grid:{formatter:_(0)},exposure:{formatter:_(1)},gamma:{formatter:_(1)}},oi=x(ai),si=w('<div id="media-player" bind-events="pointerdown:handleDrag" bind-attr-layout="data-layout" bind-attr-index="data-index"><div class="media-player-canvas-container"><div id="canvas-container" bind-attr-showalpha="data-show-alpha"><canvas></canvas></div><grid-overlay bind-prop-grid="grid"></grid-overlay></div></div>',':host(shader-viewer){background-color:#000;cursor:-webkit-grab;cursor:grab;display:block;height:100%;position:relative;width:100%}#media-player{cursor:-webkit-grab;cursor:grab;height:100%;overflow:hidden;pointer-events:all;position:absolute;width:100%}#media-player #canvas-container{-ms-interpolation-mode:nearest-neighbor;background-color:#000;display:inline-block;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:pixelated;-webkit-transform-origin:0 0;transform-origin:0 0}#media-player #canvas-container[data-show-alpha=true]:before{background:repeating-conic-gradient(#000 0 25%,#eee 0 50%) 50%/60px 60px;content:"";height:100%;left:0;opacity:.2;position:absolute;top:0;width:100%}#media-player #canvas-container canvas{-ms-interpolation-mode:nearest-neighbor;display:block;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:pixelated;position:relative}#media-player #canvas-container #pixel-grid{background-image:linear-gradient(90deg,#fff .065px,transparent 0),linear-gradient(180deg,#fff .065px,transparent 0);background-position:0 0;background-size:1px 1px;height:100%;left:0;opacity:0;pointer-events:none;position:absolute;top:0;transition:opacity .2s;width:100%}#media-player #canvas-container #pixel-grid[data-show=true]{opacity:.33}#media-player[data-layout=split]{overflow:hidden;position:absolute;width:0}#media-player[data-layout=split][data-index="0"],#media-player[data-layout=split][data-index="1"]{width:100%}#media-player[data-layout=split][data-index="0"]{left:0}#media-player[data-layout=split][data-index="1"]{right:0}');E("shader-viewer",class extends v{static get observedAttributes(){return oi}_stateConfigs=ai;renderer=null;ready=!1;index=0;layout="";position={x:0,y:0,z:100};viewportWidth=0;uiSettings={};inputMedia=[];shaderSource={source:"",inputs:0,defaultSettings:{}};showAlpha=!1;exposure=1;gamma=1;constructor(){super(),C(this,si)}canvasContainer(){return this.shadowRoot.getElementById("canvas-container")}canvas(){return this.shadowRoot.querySelector("canvas")}root(){return this.shadowRoot.getElementById("media-player")}resize=()=>{if(!this.position)return;const e=this.canvasContainer();if(!e)return;const t=this.position.z/100;e.style.transform=`scale(${t},${t}) translate(${this.position.x/t}px, ${this.position.y/t}px)`};screenshot(){return this.renderer?this.renderer.getScreenshot():""}handleDrag=e=>{e.preventDefault(),this.dispatchEvent(new CustomEvent("dragstartcanvas",{bubbles:!0,composed:!0,detail:{clientX:e.clientX,clientY:e.clientY}}))};initRender=()=>{this.renderer=new ni(this.canvas()),this.renderReady()};renderReady=()=>{this.ready=!0,this.dispatchEvent(new CustomEvent("rendererready",{bubbles:!0,composed:!0,detail:this}))};setViewport=()=>{this.root().style.width="split"===this.layout?`${this.viewportWidth}px`:"100%"};attached(){this.initRender(),this.setViewport()}detached(){this.renderer&&(this.renderer.dispose(),this.renderer=null)}});const ri=function e(t,i){const n=l(t),a=l(i),o=["object","array"];if(-1===o.indexOf(n)||-1===o.indexOf(a)||n!==a)return void 0===i?t:i;if("object"===n&&"object"===a){const n={...t},a=Object.keys(n);return Object.keys(i).forEach((t=>{-1===a.indexOf(t)?n[`${t}`]=i[`${t}`]:n[`${t}`]=e(n[`${t}`],i[`${t}`])})),n}if("array"===n&&"array"===a){const e=t.slice();return i.forEach((t=>-1===e.indexOf(t)?e.push(t):void 0)),e}return t}(vt,{showMeta:{formatter:H,onChange(i){i?e(this,"keydown",(e=>{e.path&&"INPUT"===e.path[0].tagName||"Escape"===e.key&&this.showMeta&&(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation(),this.showMeta=!1,t(this,"keydown",window),this.dispatchEvent(new CustomEvent("appfocus",{bubbles:!0,composed:!0})))}),window):t(this,"keydown",window)}},options:{onChange(){this.setRefInputs()}},position:{},uiSettings:{onChange(){this.setUiInputs()}},inputMedia:{onChange(){this.setRefInputs()}},shaderSource:{},editable:{formatter:H}}),li=x(ri),di=(e=>{const t=ft(e),i=t.labelsContainer,n=t.muteContainer;return t.container.setAttribute("bind-attr-editable","data-editable"),n.parentElement.removeChild(n),i.parentElement.insertBefore(y({tag:"span",attributes:{class:"file-settings","bind-events":"click:toggleMeta"},children:[y({tag:"icon-element",attributes:{type:"cog"}})]}),i),i.parentElement.insertBefore(y({tag:"span",attributes:{class:"file-delete","bind-events":"click:deleteMedia"},children:[y({tag:"icon-element",attributes:{type:"close"}})]}),i),t.container.appendChild(y({tag:"content-overlay",attributes:{class:"media-settings","bind-prop-showMeta":"visible",removeContentOnClose:"false",visible:"false",scrim:"false",movable:"true"},properties:{innerHTML:'<div slot="heading"><span bind-prop-names="textContent:base"></span> settings</div><div class="shader-settings-content" bind-attr-editable="data-editable"><div class="media-settings-item"><input-element id="media-name-input" label="Name" bind-prop-names="value:base" bind-events="inputvalue:setMediaName"><button-element slot="input-button" bind-events="click:resetMediaName" text="Reset"></button-element></input-element></div><div id="reference-input-container"></div><div id="ui-input-container"></div></div>'}})),e})(w('<div class="media-meta-container" bind-attr-metadata="data-type:type" bind-attr-fullscreen="data-fullscreen" bind-attr-alignright="data-align-right" bind-attr-noselect="data-no-select"><div class="media-meta-container-inner"><div class="media-meta-labels"><span id="media-select"><input-element id="select-media-input" type="select" bind-prop-mediaid="value" bind-prop-options="options" dropdowndirection="up" bind-events="input:switchMedia" noinnerborders="true" nobackground="true" nomargin="true" nominheight="true"></input-element><span id="media-title" bind-prop-names="textContent:base"></span> </span><span class="mute-settings" bind-events="click:toggleMute" bind-attr-mute="data-muted"><icon-element bind-prop-audioicon="type"></icon-element></span><span class="optional-labels-container"><span class="optional-media-label" bind-attr-labels="data-show:duration" bind-prop-durationstring="textContent"></span> <span class="optional-media-label" bind-attr-labels="data-show:startTime" bind-prop-starttimestring="textContent"></span> <span class="optional-media-label" bind-attr-labels="data-show:fps" bind-prop-fpsstring="textContent"></span> <span class="optional-media-label" bind-attr-labels="data-show:dimensions" bind-prop-dimensionsstring="textContent"></span> <span class="optional-media-label" bind-attr-labels="data-show:codec" bind-prop-metadata="textContent:codec"></span> <span class="optional-media-label" bind-attr-labels="data-show:format" bind-prop-metadata="textContent:format"></span> <span class="optional-media-label" bind-attr-labels="data-show:bitrate" bind-prop-bitratestring="textContent"></span></span></div></div></div>','.input-grid{align-items:flex-end;display:flex;flex-wrap:wrap;margin:0 -.5em}.input-grid .input-control{margin:.5em .5em 0}.input-grid .input-control:not(.btn-control){padding:0 0 .5em}.input-grid .btn-control{align-self:flex-end;margin-bottom:.75em}.input-grid.no-wrap{flex-wrap:nowrap}.short-input{max-width:6.18em}[slot=input-button]{font-size:85%;position:relative}[slot=input-button]:first-child:before{box-shadow:-1px 0 0 0;content:"";display:block;height:100%;opacity:.1;position:absolute;width:1px}:host{display:block;position:relative}.media-meta-container{max-width:100%;pointer-events:all;width:100%}.media-meta-container #select-media-input{font-size:1.071425em;margin-top:.35em;max-width:100%}.media-meta-container .media-meta-container-inner{position:relative;width:100%}.media-meta-container .media-meta-container-inner .media-meta-labels{align-items:flex-start;box-sizing:border-box;display:flex;flex-wrap:wrap;padding:.75em;width:100%}.media-meta-container .media-meta-container-inner .media-meta-labels .optional-labels-container{align-items:center;display:flex;flex-wrap:wrap;font-size:.75em;margin-top:.65em;opacity:.5}.media-meta-container .media-meta-container-inner .media-meta-labels .optional-labels-container>.optional-media-label{align-items:center;display:flex;flex-wrap:nowrap;margin-left:1em;white-space:nowrap}.media-meta-container .media-meta-container-inner .media-meta-labels .optional-labels-container>.optional-media-label:empty,.media-meta-container .media-meta-container-inner .media-meta-labels .optional-labels-container>.optional-media-label[data-show=false]{display:none}.media-meta-container[data-align-right=true] .media-meta-container-inner .media-meta-labels{justify-content:flex-end}.media-meta-container[data-fullscreen=true] .mute-settings,.media-meta-container[data-fullscreen=true] .optional-labels-container,.media-meta-container[data-type=image] .mute-settings{display:none}.media-meta-container[data-no-select=false] #select-media-input{display:block}.media-meta-container[data-no-select=false] #media-title,.media-meta-container[data-no-select=true] #select-media-input{display:none}.media-meta-container[data-no-select=true] #media-title{display:block}#media-select{align-self:center;margin-right:.25em}#media-title{padding-top:.55em}.mute-settings{align-items:center;border-radius:4px;color:#eee;cursor:pointer;display:flex;font-size:114%;justify-content:center;margin:.33em .25em 0;opacity:1;padding:.26em;transition:color .2s,background-color .2s}.mute-settings:hover{background-color:hsla(0,0%,46%,.5);color:#eee;opacity:1}.mute-settings[data-muted=false],.mute-settings[data-muted=false]:hover{opacity:1}.mute-settings icon-element{font-size:147%}.input-grid{align-items:flex-end;display:flex;flex-wrap:wrap;margin:0 -.5em}.input-grid .input-control{margin:.5em .5em 0}.input-grid .input-control:not(.btn-control){padding:0 0 .5em}.input-grid .btn-control{align-self:flex-end;margin-bottom:.75em}.input-grid.no-wrap{flex-wrap:nowrap}.short-input{max-width:6.18em}[slot=input-button]{font-size:85%;position:relative}[slot=input-button]:first-child:before{box-shadow:-1px 0 0 0;content:"";display:block;height:100%;opacity:.1;position:absolute;width:1px}#media-select,#media-select input-element{max-width:100%}.file-delete,.file-settings{align-items:center;border-radius:4px;cursor:pointer;display:flex;font-size:120%;justify-content:center;margin:.32em .125em 0;padding:.34em;transition:color .2s,background-color .2s}.file-delete icon-element,.file-settings icon-element{font-size:119.1%}.file-delete:hover,.file-settings:hover{background-color:hsla(0,0%,46%,.5)}content-overlay{font-size:1rem}.media-settings-content{font-size:88%;margin-bottom:1em;margin-top:-1em}.media-name-input-container{padding-bottom:.5em}.media-settings-item-text{margin-left:.5em;text-align:left}.media-settings-item-value{margin-left:.25em;opacity:.75}.meta-item{align-items:center;display:flex}.meta-item[data-active=false] icon-element{color:#bbb}.meta-item[data-active=true] icon-element{color:#76b900}.dimension-settings{display:flex;flex-wrap:wrap;padding-bottom:1em}.media-meta-container[data-fullscreen=true] .file-delete,.media-meta-container[data-fullscreen=true] .file-settings,.media-meta-container[data-fullscreen=true] .media-settings,.media-meta-container[data-fullscreen=true] .optional-labels-container,.media-meta-container[data-type=image] .media-meta-container-inner .media-settings .meta-item.meta-item-bitrate,.media-meta-container[data-type=image] .media-meta-container-inner .media-settings .meta-item.meta-item-codec,.media-meta-container[data-type=image] .media-meta-container-inner .media-settings .meta-item.meta-item-duration,.media-meta-container[data-type=image] .media-meta-container-inner .media-settings .meta-item.meta-item-fps,.media-meta-container[data-type=image] .media-meta-container-inner .media-settings .meta-item.meta-item-startTime{display:none}.label-toggles .media-settings-item.meta-item{font-size:110%}.dimension-settings[data-show=false],.label-toggles[data-show=false]{display:none}.shader-setting-bg{background-color:#000;height:100%;left:0;opacity:.25;position:absolute;top:0;width:100%}.shader-settings-content{font-size:75%}#reference-input-container input-element,#ui-input-container input-element{display:block;margin:1em 0}#ui-input-container input-element[data-show=false],.media-meta-container-inner[data-editable=false] .file-delete,.media-meta-container-inner[data-editable=false] .file-settings{display:none}'));E("shader-settings",class extends xt{static get observedAttributes(){return li}_stateConfigs=ri;showMeta=!1;uiSettings={};inputMedia=[];shaderSource={source:"",inputs:0};position={id:"",x:0,y:0,z:100};editable=!1;constructor(){super(),C(this,di)}toggleMeta=()=>{this.showMeta=!this.showMeta};deleteMedia=()=>{this.dispatchEvent(new CustomEvent("deletemedia",{bubbles:!0,composed:!0,detail:this.mediaId}))};setMediaName=()=>{const e=this.shadowRoot.getElementById("media-name-input").getValue();this.dispatchEvent(new CustomEvent("updatemedianame",{bubbles:!0,composed:!0,detail:{id:this.mediaId,base:e}}))};resetMediaName=()=>{const e=W(this.names.path),t=(function(e=""){return`.${e.split(".").pop()||""}`}(e)||"").slice(1)||"",i=e.split(`.${t}`)[0],n=this.shadowRoot.getElementById("media-name-input");this.dispatchEvent(new CustomEvent("updatemedianame",{bubbles:!0,composed:!0,detail:{id:this.mediaId,base:i}})),n.value=this.names.base};setUiInputs(){const e=this.uiSettings,t=this.shadowRoot.getElementById("ui-input-container"),i=[],n=Array.from(t.querySelectorAll("input-element")).reduce(((t,n)=>{const a=n.getAttribute("name");return a&&e[`${a}`]?t[`${a}`]=n:i.push(n),t}),{});i.forEach((e=>t.removeChild(e))),Object.keys(e).forEach(((i,a)=>{const o=e[`${i}`],s=n[`${i}`],r=!(l=o.condition)||l.split("&").reduce(((t,i)=>{const n=i.trim();if(!n)return t;const a="!"===n[0],o=n.split("==").map((e=>e.trim())).filter((e=>!!e));if(o.length>1){const t=o[0],i=e[`${t}`],n=o[1].split(",").includes(i.value.toString());if(a&&n||!a&&!n)return!1}else{const i=a?n.slice(1):n,o=e[`${i}`];if(!o)return t;const s=o.value;if(a&&s||!a&&!s)return!1}return t}),!0);var l;const d=o.alternatives&&0!==o.alternatives.length?o.alternatives.map(((e,t)=>({value:t,label:e}))):[];let c="text";if(d.length&&(c="select"),"bool"===o.type&&(c="checkbox"),"float"!==o.type&&"int"!==o.type||(c="number"),s){s.value=o.value;r!==JSON.parse(s.getAttribute("data-show"))&&s.setAttribute("data-show",r.toString())}else{const e=y({tag:"input-element",attributes:{name:i,"bind-events":"inputvalue:updateShaderSetting","data-show":r.toString()},properties:{max:o.max,min:o.min,step:o.step,value:o.value,label:o.name||i,options:d,type:c}});t.insertBefore(e,t.children[Number(a)])}}))}setRefInputs(){const e=()=>this.options.filter((e=>e.value!==this.mediaId)),t=e=>`Input ${this.inputMedia.length>1?e+1:""}`;k({container:this.shadowRoot.getElementById("reference-input-container"),array:this.inputMedia,getElementsFn:()=>Array.from(this.shadowRoot.querySelectorAll(".input-reference")),valueKeyFn:(e,t)=>t,elementValueKeyFn:e=>e.mediaIndex,createFn:(i,n)=>y({tag:"input-element",attributes:{id:i,type:"select",class:"input-reference","bind-events":"inputvalue:updateShaderInput"},properties:{options:e(),label:t(n),mediaIndex:n,value:i&&i.id?i.id:null}}),updateFn:(i,n,a)=>{i.options=e(),i.label=t(a),i.value=n&&n.id?n.id:null}})}updateShaderInput=e=>{const t=e.detail,i=t.mediaIndex,n=t.getValue();this.dispatchEvent(new CustomEvent("updateshaderinput",{bubbles:!0,composed:!0,detail:{index:i,value:n,id:this.id}}))};updateShaderSetting=e=>{const t=e.detail,i=t.getValue(),n=t.getAttribute("name");this.dispatchEvent(new CustomEvent("updateshadersetting",{bubbles:!0,composed:!0,detail:{key:n,value:i,id:this.id}}))};attached(){super.attached(),e(this,"contentoverlayclose",(e=>{e.preventDefault(),e.stopPropagation(),this.showMeta=!1}))}});const ci={exposure:{formatter:_(1)},gamma:{formatter:_(1)},visible:{formatter:H,onChange(e){e&&B.isElectron&&this.updateLocalShaderUI()}}},hi=x(ci),ui=w('<div id="app-settings"><content-overlay id="ab-content-overlay" bind-prop-visible="visible" removecontentonclose="false" scrim="false" movable="true"><div slot="heading">Settings</div><div class="content"><input-element bind-prop-exposure="value" type="number" step="0.01" min="0.01" max="10" label="Exposure" bind-events="inputvalue:updateExposure" id="exposure-input"><button-element slot="input-button" text="Reset" bind-events="click:resetExposure" size="4" style="margin-left: 0.5em;"></button-element></input-element><input-element bind-prop-gamma="value" type="number" step="0.01" min="0.01" max="4" label="Gamma" bind-events="inputvalue:updateGamma" id="gamma-input"><button-element slot="input-button" text="Reset" bind-events="click:resetGamma" size="4" style="margin-left: 0.5em;"></button-element></input-element><div id="local-shaders"></div></div></content-overlay></div>',"#app-settings .content{font-size:88%;margin-bottom:1em;margin-top:-1em}#app-settings input-element{display:block;margin:.5em 0;width:100%}#app-settings #exposure-input,#app-settings #gamma-input{margin-top:1em}#app-settings .local-shaders-heading{margin-top:2em}#app-settings .local-shader-item{align-items:center;border-radius:4px;display:flex;margin:.5em 0;padding:.5em}#app-settings .local-shader-item:nth-child(2n){background-color:#424242}#app-settings .local-shader-item .local-shader-item-name{display:flex;flex-direction:column;flex-grow:1;line-height:125%}#app-settings .local-shader-item .local-shader-item-name span{font-size:90%}#app-settings .local-shader-item .local-shader-item-name small{font-size:75%;font-style:italic;line-height:100%;opacity:.5}#app-settings .local-shader-item button-element{margin-left:.5em}");E("app-settings",class extends v{static get observedAttributes(){return hi}_stateConfigs=ci;exposure=1;gamma=1;visible=!1;constructor(){super(),C(this,ui)}localShadersContainer(){return this.shadowRoot.getElementById("local-shaders")}updateExposure=(e,t)=>{e.preventDefault(),e.stopPropagation();let i=t;if(void 0===i){i=this.shadowRoot.getElementById("exposure-input").getValue()}this.dispatchEvent(new CustomEvent("updateexposure",{bubbles:!0,composed:!0,detail:i}))};resetExposure=e=>this.updateExposure(e,1);updateGamma=(e,t)=>{e.preventDefault(),e.stopPropagation();let i=t;if(void 0===i||Number.isNaN(i)){i=this.shadowRoot.getElementById("gamma-input").getValue()}this.dispatchEvent(new CustomEvent("updategamma",{bubbles:!0,composed:!0,detail:i}))};resetGamma=e=>this.updateGamma(e,1);updateLocalShaderUI(){const e=this.localShadersContainer();if(e.innerHTML="",!B.isElectron)return;const t=Lt.get();t.length&&(e.appendChild(y({tag:"div",attributes:{class:"local-shaders-heading"},properties:{textContent:"Local shaders"}})),t.forEach((t=>{e.appendChild(y({tag:"div",attributes:{class:"local-shader-item"},children:[y({tag:"div",attributes:{class:"local-shader-item-name"},children:[y({tag:"span",properties:{textContent:t.data.name}}),y({tag:"small",properties:{textContent:t.filename}})]}),y({tag:"button-element",attributes:{type:"outline",text:"Delete",size:"2"},events:{click:()=>{Lt.remove(t.path),this.updateLocalShaderUI()}}}),y({tag:"button-element",attributes:{text:"Reload",size:"2"},events:{click:()=>{Lt.reload(t.path).then((()=>{this.updateLocalShaderUI()}))}}})]}))})))}attached(){this.updateLocalShaderUI(),e(this,"contentoverlayclose",(e=>{e.preventDefault(),e.stopPropagation(),this.visible=!1}))}});const mi={},pi=x(mi);E("top-bar",class extends v{static get observedAttributes(){return pi}_stateConfigs=mi;#Ye=!0;get isEmbed(){return this.#Ye}set isEmbed(e){const t=$(e);this.#Ye=t,this.shadowRoot.getElementById("top-bar").setAttribute("data-is-embed",t.toString())}constructor(){super(),C(this,w('<div id="top-bar"><div id="top-bar-left" class="content-row"><slot name="left"></slot></div><div id="top-bar-center" class="content-row"><slot name="center"></slot></div><div id="top-bar-right" class="content-row"><slot name="right"></slot></div></div>',"#top-bar{align-items:center;background-color:#2b2b2b;box-sizing:border-box;display:grid;grid-template-columns:1fr 14.05em 1fr;padding:0 1em;position:relative;width:100%}#top-bar[data-is-embed=true]{display:flex;justify-content:space-between;padding:0 .5em}#top-bar[data-is-embed=true] #top-bar-left{display:none}.content-row{align-items:center;display:flex}#top-bar-center{gap:1.25em}#top-bar-left,#top-bar-right{flex-grow:1;gap:.25em}#top-bar-right{justify-content:flex-end}"))}});const gi={},bi=x(gi);E("content-sidebar",class extends v{static get observedAttributes(){return bi}_stateConfigs=gi;#Xe;get controller(){return this.#Xe}set controller(e){this.#Xe=e,e&&0===this.#je&&(this.width=200)}#je=0;get width(){return this.#je}set width(e){this.style.width=`${e}px`}set uiVisibility(e){e&&void 0!==e.contentSidebar&&(this.style.display=e.contentSidebar?"block":"none")}#Ze=[];get sets(){return this.#Ze}set sets(e){this.#Ze=e,this.#Ke()}#Je="";get activeSet(){return this.#Je}set activeSet(e){this.#Je=e,this.#Ke()}constructor(){super(),C(this,w('<div id="content-sidebar"><div class="heading"><span class="heading-text">Comparison sets</span><button-element id="add-magic-set" icon="wand" type="link" hoversecondary="true"></button-element><button-element id="add-set" icon="plus" type="link" hoversecondary="true"></button-element></div><div id="sets-container"></div><div class="heading"><span class="heading-text">Media</span><button-element id="add-media" icon="plus" type="link" hoversecondary="true"></button-element></div><div id="media-container"></div><div id="empty-media"><div id="empty-media-img"><svg width="136" height="136" viewBox="0 0 136 136" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="136" height="136" rx="68" fill="#424242"/><path d="M47 41V89" stroke="#E0E0E0"/><path d="M77 41H47" stroke="#E0E0E0"/><path d="M77 65H47" stroke="#E0E0E0"/><path d="M77 89H47" stroke="#E0E0E0"/><path d="M47 53H35" stroke="#E0E0E0"/><path d="M47 65H35" stroke="#E0E0E0"/><path d="M47 77H35" stroke="#E0E0E0"/><path d="M47 89H35V41H47" stroke="#E0E0E0"/><path d="M77 41V89" stroke="#E0E0E0"/><path d="M77 41H89V89H77" stroke="#E0E0E0"/><path d="M89 53H77" stroke="#E0E0E0"/><path d="M89 65H77" stroke="#E0E0E0"/><path d="M89 77H77" stroke="#E0E0E0"/><path d="M101 50V101H44" stroke="#E0E0E0"/></svg></div><div id="empty-media-text">Add content to use in your comparison sets</div><button-element id="big-add-media-btn" text="Add media" fullwidth="true"></button-element></div><div id="drag-handle"></div></div>',":host{background-color:#212121;box-shadow:inset 0 9px 9px -9px #111,inset -1px 1px 0 0 #111;height:100%;max-width:50%;min-width:200px;position:relative}#content-sidebar{max-height:100%;overflow:auto}.heading{align-items:center;box-shadow:inset 0 1px #111;display:flex;padding:1em}.heading-text{flex-grow:1;font-size:87.5%}#sets-container{margin-bottom:1em;margin-top:-.5em}#sets-container:empty{display:none}.set-item{align-items:center;box-sizing:border-box;cursor:pointer;display:flex;font-size:80%;gap:.5em;max-width:100%;padding:.5em 1em}.set-item icon-element{font-size:1.25em}.set-item button-element{opacity:0;pointer-events:none;transition:opacity .2s}.set-item input-element{flex-grow:1;flex-shrink:1;font-size:94%;max-width:calc(100% - 3.5em)}.set-item:hover{background-color:#2b2b2b}.set-item:hover button-element{opacity:1;pointer-events:all}.set-item.active,.set-item.active:hover{background-color:#424242}.media-item{align-items:center;box-sizing:border-box;cursor:pointer;display:flex;font-size:80%;gap:.5em;padding:.5em 1em}.media-item icon-element{font-size:1.25em}.media-item button-element{opacity:0;pointer-events:none;transition:opacity .2s}.media-item .media-item-text{flex-grow:1;font-size:94%;line-height:125%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.media-item:hover{background-color:#2b2b2b}.media-item:hover button-element{opacity:1;pointer-events:all}#drag-handle{box-shadow:inset -3px 0 0 #76b900;cursor:col-resize;height:100%;opacity:0;position:absolute;right:0;top:0;transition:opacity .2s;width:15px}#drag-handle.active,#drag-handle:hover{opacity:1}#empty-media{align-items:center;display:flex;flex-direction:column;justify-content:center;margin:auto;max-width:150px;text-align:center}#empty-media-text{font-size:75%;font-style:italic;line-height:175%;opacity:.5;padding:1em 1em 1.5em}"))}#Qe(){return this.shadowRoot.getElementById("add-media")}#et(){return this.shadowRoot.getElementById("big-add-media-btn")}#tt(){return this.shadowRoot.getElementById("add-set")}#it(){return this.shadowRoot.getElementById("add-magic-set")}#nt(){return this.shadowRoot.getElementById("sets-container")}#at(){return Array.from(this.shadowRoot.querySelectorAll(".set-item"))}#ot(){return this.shadowRoot.getElementById("media-container")}#st(){return Array.from(this.shadowRoot.querySelectorAll(".media-item"))}#ve(){return this.shadowRoot.getElementById("drag-handle")}#rt(){return this.shadowRoot.getElementById("empty-media")}#Ke(){const e=this.#Ze.sort(((e,t)=>e.label.localeCompare(t.label)));!!e.find((e=>e.media.length>0))?this.#rt().style.display="none":this.#rt().style.removeProperty("display"),k({container:this.#nt(),array:e,getElementsFn:()=>this.#at(),valueKeyFn:e=>e.id,elementValueKeyFn:e=>e.id,createFn:e=>{const t=M((t=>{2!==t.detail&&this.#Je!==e.id&&this.dispatchEvent(new CustomEvent("loadset",{bubbles:!0,composed:!0,detail:e.id}))}),200),i=y({tag:"input-element",attributes:{value:e.label,class:"set-item-input",nomargin:"true",nominheight:"true",slimpadding:"true",liveInput:"false"},properties:{inlineEdit:!0},events:{inputvalue:()=>{const t=i.getValue(),n=this.#Ze.find((t=>t.id===e.id));t&&n&&t!==n.label&&this.dispatchEvent(new CustomEvent("rename-set",{bubbles:!0,composed:!0,detail:{id:e.id,label:t}}))}}});return y({tag:"div",attributes:{id:e.id,class:e.id===this.#Je?"set-item active":"set-item"},properties:{onclick:t},children:[y({tag:"icon-element",attributes:{type:"cards"}}),i,y({tag:"button-element",attributes:{icon:"close",type:"link",hoversecondary:"true"},events:{click:t=>{t.preventDefault(),t.stopPropagation();const i=this.#Ze.find((t=>t.id===e.id));i&&this.dispatchEvent(new CustomEvent("confirm-delete-set",{bubbles:!0,composed:!0,detail:{id:e.id,name:i.label}}))}}})]})},updateFn:(e,t)=>{e.classList[t.id===this.#Je?"add":"remove"]("active");const i=e.querySelector(".set-item-input");i&&(i.value=t.label)}});const t=["TIMELINE-ITEM","MEDIA-PLAYER"],i=e.reduce(((e,t)=>(t.media.forEach((i=>{if(!(!!i.metadata&&!!i.metadata.type))return;const n=i.mediaName.path,a=i.metadata.size,o=i.metadata.modified;e.findIndex((e=>e.path===n&&e.size===a&&e.modified===o))>-1||e.push({label:i.mediaName.name,id:i.id,type:i.metadata.type,setId:t.id,mediaData:i,path:i.mediaName.path,size:a,modified:o})})),e)),[]).sort(((e,t)=>e.label.localeCompare(t.label)));k({container:this.#ot(),array:i,getElementsFn:()=>this.#st(),valueKeyFn:e=>e.id,elementValueKeyFn:e=>e.id,createFn:e=>{const i=y({tag:"div",attributes:{class:"media-item",id:e.id,draggable:"true"},events:{dragstart:n=>{if(!this.controller)return n.preventDefault(),void n.stopPropagation();i.ondrag=()=>{},i.ondragend=i=>{const n=i.clientX,a=i.clientY,o=this.controller.getElementAtPoint(n,a),s=this.#Ze.find((e=>e.id===this.#Je));if(!s||!o)return;const r=o.tagName,l=t.indexOf(r)>-1,d="media-container"===o.id;if("DEFAULT-SCREEN"===r)return this.dispatchEvent(new CustomEvent("add-media-to-current-set",{bubbles:!0,composed:!0,detail:{media:e.mediaData,index:0}}));if(l||d){const t=o.getBoundingClientRect();let i=s.media.findIndex((e=>e.id===o.id)),r=!1;"TIMELINE-ITEM"===o.tagName?r=a-t.y<t.height/2:"MEDIA-PLAYER"===o.tagName?r=n-t.x<t.width/2:i=0,this.dispatchEvent(new CustomEvent("add-media-to-current-set",{bubbles:!0,composed:!0,detail:{media:e.mediaData,index:i+(r?0:1)}}))}}}},children:[y({tag:"icon-element",attributes:{type:"video"===e.type?"video":"image"}}),y({tag:"div",attributes:{class:"media-item-text"},properties:{textContent:e.label}}),y({tag:"button-element",attributes:{icon:"close",type:"link",hoversecondary:"true"},events:{click:()=>{this.dispatchEvent(new CustomEvent("confirm-delete-media",{bubbles:!0,composed:!0,detail:e.mediaData}))}}})]});return i},updateFn:(e,t)=>{e.querySelector(".media-item-text").textContent=t.label;e.querySelector("icon-element").type="video"===t.type?"video":"image"}})}attached(){this.#Ke(),e(this,"click",(()=>this.dispatchEvent(new CustomEvent("selectmedia",{bubbles:!0,composed:!0}))),this.#Qe()),e(this,"click",(()=>this.dispatchEvent(new CustomEvent("selectmedia",{bubbles:!0,composed:!0}))),this.#et()),e(this,"click",(()=>this.dispatchEvent(new CustomEvent("newset",{bubbles:!0,composed:!0}))),this.#tt()),e(this,"click",(()=>this.dispatchEvent(new CustomEvent("openabfoldersmodal",{bubbles:!0,composed:!0}))),this.#it());const t=this.#ve();e(this,"pointerdown",(e=>{const i=it((e=>{const t=this.controller.getBoundingClientRect();this.width=e.clientX-t.left}),33);t.classList.add("active"),i(e);const n=e=>{e.preventDefault(),i(e)},a=e=>{e.preventDefault(),t.classList.remove("active"),document.body.style.removeProperty("user-select"),window.removeEventListener("pointermove",n),document.removeEventListener("pointerup",a),document.removeEventListener("pointerleave",a),n(e)};document.body.style.userSelect="none",window.addEventListener("pointermove",n),document.addEventListener("pointerup",a),document.addEventListener("pointerleave",a)}),t)}});const fi={},vi=x(fi),yi=w('<div id="confirm-delete-set"><content-overlay id="content-overlay" removecontentonclose="false" scrim="true" movable="false"><div slot="heading" id="heading"></div><div class="content"><div>Your media clips will remain in the Media panel, but anything you have done in this comparison set will be lost. Do you want to remove this set?</div></div><div slot="footer"><button-element type="outline" text="Cancel" id="cancel-btn"></button-element><button-element type="danger" id="delete-btn" text="Remove comparison set"></button-element></div></content-overlay></div>',":host{height:100%;pointer-events:none;position:absolute;width:100%}#confirm-delete-set{height:100%;position:relative;width:100%}#content-overlay{position:absolute}[slot=footer]{align-items:center;display:flex;gap:.5em}.content{font-size:88%}");E("confirm-delete-set",class extends v{static get observedAttributes(){return vi}_stateConfigs=fi;#lt="";get setId(){return this.#lt}set setId(e){this.#lt=e}#dt="";get setName(){return this.#dt}set setName(e){this.#dt=e,this.#ct().textContent=`Remove the "${e}" comparison set?`}#ht=!1;get visible(){return this.#ht}set visible(e){this.#ht=e,this.#ut().visible=e}constructor(){super(),C(this,yi)}#ct(){return this.shadowRoot.getElementById("heading")}#ut(){return this.shadowRoot.getElementById("content-overlay")}#mt(){return this.shadowRoot.getElementById("cancel-btn")}#U(){return this.shadowRoot.getElementById("delete-btn")}attached(){e(this,"click",(()=>{this.visible=!1}),this.#mt()),e(this,"click",(()=>{this.visible=!1,this.dispatchEvent(new CustomEvent("delete-set",{bubbles:!0,composed:!0,detail:this.#lt}))}),this.#U()),e(this,"contentoverlayclose",(e=>{e.preventDefault(),e.stopPropagation(),this.visible=!1}),this.#ut())}});const wi={},xi=x(wi),Ei=w('<div id="confirm-delete-media"><content-overlay id="content-overlay" removecontentonclose="false" scrim="true" movable="false"><div slot="heading" id="heading"></div><div class="content"><div>This will also remove the media from all comparison sets in this project. Do you want to remove this media?</div></div><div slot="footer"><button-element type="outline" text="Cancel" id="cancel-btn"></button-element><button-element type="danger" id="delete-btn" text="Remove"></button-element></div></content-overlay></div>',":host{height:100%;pointer-events:none;position:absolute;width:100%}#confirm-delete-media{height:100%;position:relative;width:100%}#content-overlay{position:absolute}[slot=footer]{align-items:center;display:flex;gap:.5em}.content{font-size:88%}");E("confirm-delete-media",class extends v{static get observedAttributes(){return xi}_stateConfigs=wi;#pt;get media(){return this.#pt}set media(e){this.#pt=e,this.#ct().textContent=`Remove ${e.mediaName.name}?`}#ht=!1;get visible(){return this.#ht}set visible(e){this.#ht=e,this.#ut().visible=e}constructor(){super(),C(this,Ei)}#ct(){return this.shadowRoot.getElementById("heading")}#ut(){return this.shadowRoot.getElementById("content-overlay")}#mt(){return this.shadowRoot.getElementById("cancel-btn")}#U(){return this.shadowRoot.getElementById("delete-btn")}attached(){e(this,"click",(()=>{this.visible=!1}),this.#mt()),e(this,"click",(()=>{this.visible=!1,this.dispatchEvent(new CustomEvent("delete-media-in-all-sets",{bubbles:!0,composed:!0,detail:this.#pt}))}),this.#U()),e(this,"contentoverlayclose",(e=>{e.preventDefault(),e.stopPropagation(),this.visible=!1}),this.#ut())}});const Si={},Ti=x(Si),Ci=w('<div id="confirm-save-project"><content-overlay id="content-overlay" removecontentonclose="false" scrim="true" movable="false"><div slot="heading" id="heading">Save project</div><div class="content"><div>Would you like to save your current project before continuing?</div></div><div slot="footer"><button-element type="outline" text="Cancel" id="cancel-btn"></button-element><button-element id="dont-save-btn" type="outline" text="Don\'t save"></button-element><button-element id="save-btn" text="Save"></button-element></div></content-overlay></div>',":host{height:100%;pointer-events:none;position:absolute;width:100%}#confirm-save-project{height:100%;position:relative;width:100%}#content-overlay{position:absolute}[slot=footer]{align-items:center;display:flex;gap:.5em}.content{font-size:88%}");E("confirm-save-project",class extends v{static get observedAttributes(){return Ti}_stateConfigs=Si;#ht=!1;get visible(){return this.#ht}set visible(e){this.#ht=e,this.#ut().visible=e}noSaveEventName="icat-open-project";saveEventName="icat-save-and-open-project";constructor(){super(),C(this,Ci)}#ut(){return this.shadowRoot.getElementById("content-overlay")}#mt(){return this.shadowRoot.getElementById("cancel-btn")}#gt(){return this.shadowRoot.getElementById("dont-save-btn")}#bt(){return this.shadowRoot.getElementById("save-btn")}attached(){e(this,"click",(()=>{this.visible=!1}),this.#mt()),e(this,"click",(()=>{this.visible=!1,this.dispatchEvent(new CustomEvent(this.noSaveEventName,{bubbles:!0,composed:!0}))}),this.#gt()),e(this,"click",(()=>{this.visible=!1,this.dispatchEvent(new CustomEvent(this.saveEventName,{bubbles:!0,composed:!0}))}),this.#bt()),e(this,"contentoverlayclose",(e=>{e.preventDefault(),e.stopPropagation(),this.visible=!1}),this.#ut())}});const Ii=x(G),ki=w('<div class="app-container" bind-attr-fullscreen="data-fullscreen" bind-attr-showspinner="data-show-spinner" tabindex="0" bind-attr-isembed="data-embed" bind-attr-hasmedia="data-has-media" bind-attr-emptyset="data-empty-set" bind-attr-hasvideo="data-has-video"><div class="app-content"><div class="app-top"><div class="app-top-inner"><top-bar id="top-bar-element"><button-element id="layout-btn-tile" slot="center" text="Side-by-side" type="active-underline" size="4" dim="2"></button-element><button-element id="layout-btn-split" slot="center" text="Split screen" type="active-underline" size="4" dim="2"></button-element><set-select id="sets-select" slot="right" bind-prop-sets="sets" bind-prop-activeset="activeSet" bind-attr-uivisibility="data-show:setSelect"></set-select><button-element id="settings-btn" slot="right" icon="cog" type="link" size="6" dim="2" slim="true" hoversecondary="true"></button-element><button-element id="help-btn" slot="right" icon="help-circle" type="link" size="6" dim="2" slim="true" hoversecondary="true"></button-element></top-bar></div></div><div id="media-content-wrapper"><content-sidebar id="content-sidebar"></content-sidebar><div id="media-controller" bind-attr-fullscreen="data-fullscreen" bind-attr-showsplit="data-show-split"><div id="media-controller-inner-players-container"><div id="media-container"></div><div class="logos-container"><div id="logos-container-inner"></div></div><fps-overlay bind-prop-showperformance="active"></fps-overlay><split-handle id="split-handle" bind-prop-splitposition="split"></split-handle></div><div class="media-controller-controls"><div class="media-metadata-wrapper" bind-attr-uivisibility="data-show:mediaInfo"><div id="media-metadata-container"></div></div><div class="media-controller-playback-controls"><media-controls id="playback-controls"></media-controls></div></div></div></div><app-settings id="app-settings-modal" visible="false" bind-prop-showalpha="showAlpha" bind-prop-pixelhighlight="pixelHighlight" bind-prop-exposure="exposure" bind-prop-gamma="gamma"></app-settings><confirm-delete-set id="confirm-delete-set-modal" visible="false"></confirm-delete-set><confirm-delete-media id="confirm-delete-media-modal" visible="false"></confirm-delete-media><confirm-save-project id="confirm-save-project-modal" visible="false"></confirm-save-project><spinner-element bind-prop-showspinner="visible" bind-prop-spinnermessage="message" scrim="true"></spinner-element><message-overlay id="app-message" bind-prop-message="message"></message-overlay></div></div>',":host{display:block;height:100%;outline:none!important;overflow:hidden;position:relative;width:100%}.app-container{background-color:#000;color:#eee;font-family:sans-serif;font-size:inherit;height:100%;line-height:150%;outline:none!important;position:absolute;width:100%}.app-container,.app-container .app-content{display:flex;flex-direction:column;flex-grow:1}.app-container .app-content{overflow:hidden;position:relative}.app-container .media-controller-controls{display:inline-flex;flex-direction:column}.app-container [data-hide=true],.app-container [data-show=false]{display:none}.app-container[data-has-media=false] #export-project-btn,.app-container[data-has-media=false] #layout-btn-split,.app-container[data-has-media=false] #layout-btn-tile,.app-container[data-has-media=false] #new-project-btn,.app-container[data-has-media=false] #save-project-btn,.app-container[data-has-media=false] .media-controller-playback-controls{opacity:.25;pointer-events:none}.app-container[data-has-media=false] #no-media{display:block}.app-container[data-has-media=true] #no-media{display:none}.app-container[data-empty-set=true] .media-controller-playback-controls{display:none!important}.app-container[data-empty-set=true] #no-media{display:block}.app-container[data-fullscreen=true] content-sidebar,.app-container[data-fullscreen=true] title-bar{display:none!important}.app-container[data-fullscreen=true] .app-top{height:1em;left:0;overflow:hidden;position:absolute;top:0;transition:height .2s;width:100%;z-index:40}.app-container[data-fullscreen=true] .app-top .app-top-inner{height:0;overflow:hidden;transition:height .2s}.app-container[data-fullscreen=true] .app-top:hover,.app-container[data-fullscreen=true] .app-top:hover .app-top-inner{height:4.7em}.app-container[data-fullscreen=true] .media-controller-controls{bottom:0;left:0;position:absolute;width:100%}.app-container[data-fullscreen=true] #media-metadata-container{background-color:initial}.app-container[data-fullscreen=true] #secondary-playback-controls{display:none}.app-container[data-fullscreen=true] #secondary-playback-controls #timelines-container{max-height:10em;overflow:overlay}.app-container[data-fullscreen=true] .media-controller-playback-controls{max-height:1em;opacity:0;transition:max-height .2s,opacity .2s}.app-container[data-fullscreen=true] .media-controller-playback-controls media-controls{pointer-events:none}.app-container[data-fullscreen=true] .media-controller-playback-controls:hover{max-height:2.5em;opacity:1;pointer-events:all}.app-container[data-fullscreen=true] .media-controller-playback-controls:hover media-controls{pointer-events:all}set-select{margin-bottom:-.34em}content-sidebar{flex-shrink:0;max-width:50%;min-width:200px}top-bar button-element{pointer-events:all}top-bar button-element[text]{margin:0 .5em}top-bar button-element[slim=true]{margin:0 .25em}top-bar button-element#layout-btn-split,top-bar button-element#layout-btn-tile{margin:0}top-bar .divider{background-color:currentColor;height:1.5em;margin:0 .25em;opacity:.25;width:1px}#media-content-wrapper{display:flex;flex-grow:1;max-height:100%;overflow:hidden;width:100%}#media-controller[data-show-split=true] #media-container .media-player{height:0;opacity:0;overflow:hidden;pointer-events:none;position:absolute;top:0;width:0;z-index:-1}#media-controller[data-show-split=true] #media-container .media-player.split-left,#media-controller[data-show-split=true] #media-container .media-player.split-right{height:100%;opacity:1;pointer-events:all;width:100%;z-index:unset}#media-controller[data-show-split=true] #media-container .media-player.split-left{left:0}#media-controller[data-show-split=true] #media-container .media-player.split-right{right:0}#media-controller[data-show-split=true] #media-metadata-container .media-info{height:0;opacity:0;overflow:hidden;pointer-events:none;position:absolute;top:0;width:0;z-index:-1}#media-controller[data-show-split=true] #media-metadata-container .media-info.split-left,#media-controller[data-show-split=true] #media-metadata-container .media-info.split-right{height:auto;opacity:1;overflow:visible;pointer-events:all;position:relative;width:100%;z-index:unset}#media-controller[data-show-split=false] #media-container{display:flex;flex-wrap:nowrap;width:100%}#media-controller[data-show-split=false] #media-container .media-player{flex:0 1 auto;overflow:hidden;position:relative}#media-controller[data-show-split=false] split-handle{display:none}#media-controller-inner-players-container{display:flex;flex-direction:column;flex-grow:1;position:relative;width:100%}#media-controller-inner-players-container #media-container{flex-grow:1;position:relative}#media-controller{display:flex;flex-direction:column;overflow:hidden}#media-controller #media-container .media-player[data-visible=false]{height:0;opacity:0;overflow:hidden;pointer-events:none;position:absolute;top:0;width:0;z-index:-1}#media-controller,#pre-media-container{flex-grow:1}#media-controller:empty,#media-controller[data-hide=true],#media-controller[data-show=false],#pre-media-container:empty,#pre-media-container[data-hide=true],#pre-media-container[data-show=false]{display:none}.media-metadata-wrapper{font-size:70%}#media-metadata-container{align-items:flex-start;background-color:hsla(0,0%,7%,.9);display:flex;display:grid;flex-wrap:nowrap;grid-auto-columns:minmax(0,1fr);grid-auto-flow:column;justify-content:space-around;width:100%}#media-metadata-container .media-info{flex-grow:1;width:100%}#media-metadata-container .media-info[data-visible=false]{height:0;opacity:0;overflow:hidden;pointer-events:none;position:absolute;top:0;width:0;z-index:-1}content-overlay[data-showing=false] *{pointer-events:none}");E("compare-app",class extends v{static get observedAttributes(){return Ii}_stateConfigs=G;mediaFiles={};mediaThumbnails={};lastMediaStartTimeUpdate=0;lastX=0;lastY=0;maxZoom=1e8;minStartTime=0;resizeObserver;cancelTimeListener;undoStack=[];lastStartTimeUpdate=0;lastEndTimeUpdate=0;activeSet="";adjustedDuration=0;adjustedTime=0;antiAlias=!1;boomerang=!1;boomerangDirection=1;disableReorder=!1;disableTimeControls=!1;duration=0;durationString="";endTime=0;endTimeString="";exposure=1;fitScale=100;fps=0;fullscreen=!1;gamma=1;grid=0;hasMedia=!1;hasShownResolutionMessage=!1;hasVideo=!1;layout=R[0];logos=[];looping=!1;maxHeight=0;maxWidth=0;mediaLabels={};mediaMetadata={};mediaNames={};mediaOrder=[];mediaPositions={};mediaStartTimes={};mediaVisibility={};overlayVisibility={};message="";minScale=100;muteState={};playing=!1;position={x:0,y:0,z:100};sets=[];shaderInputs={};shaderSources={};shaderUiSettings={};showAlpha=!1;showPerformance=!1;showSpinner=!1;showSplit=!1;speed=1;spinnerMessage="";splitposition=.5;startTime=0;startTimeString="";quickTimeUpdate=!1;time=0;timeString="";uiVisibility={antiAliasSelect:!0,fullscreenButton:!0,gridSelect:!0,helpButton:!0,layersButton:!0,layoutTabs:!0,loopButton:!0,mediaInfo:!0,pixelDataButton:!0,progressBar:!0,setSelect:!0,speedSelect:!0,startEndTime:!1,timeDisplay:!0,titleBar:!1,videoControls:!0,zoomSelect:!0,timeline:!1,contentSidebar:!1,controlBar:!0,inOutSlider:!1,addLogoBtn:!1,appSettingsBtn:!0,addFilterBtn:!1};viewportWidth=0;viewportHeight=0;sourceControllers={};constrainScaleToFit=!1;thumbnailCallbacks={};isembed=!0;emptySet=!0;#t=!0;get webgl(){return this.#t}set webgl(e){const t=$(e);if(this.#t===t)return;this.pause(),this.#t=t;const i=this.shadowRoot.getElementById("help-overlay-content");i&&(i.webgl=t);const n=this.query.mediaPlayers;n&&n.forEach((e=>{e.webgl=t}))}#ft=!1;get shouldPlay(){return this.#ft}set shouldPlay(e){const t=H(e);this.#ft=t}#D=0;get showThumbnails(){return this.#D}set showThumbnails(e){if(this.#D=e,this.query.playbackControls.showThumbnails=e,0===e)return Object.keys(this.thumbnailCallbacks).forEach((e=>{-1===this.mediaOrder.indexOf(e)&&("function"==typeof this.thumbnailCallbacks[`${e}`]&&this.thumbnailCallbacks[`${e}`](),delete this.thumbnailCallbacks[`${e}`])})),void(this.mediaThumbnails={});this.updateCurrentSet();const t=this.sets.find((e=>e.id===this.activeSet));t&&0!==this.#D&&this.uiVisibility.timeline&&t.media.forEach((e=>{(!e.mediaThumbnails||e.mediaThumbnails.length<oe)&&e.metadata&&!this.thumbnailCallbacks[`${e.id}`]&&(this.thumbnailCallbacks[`${e.id}`]=le(e.id,B.isElectron?e.src:this.mediaFiles[`${e.id}`],e.metadata.type,e.mediaName.extension,(t=>this.updateMediaThumb(e.id,t)),(()=>{"function"==typeof this.thumbnailCallbacks[`${e.id}`]&&this.thumbnailCallbacks[`${e.id}`](),delete this.thumbnailCallbacks[`${e.id}`]})))}))}get query(){return function(e){const t=()=>e.shadowRoot?e.shadowRoot:e.content;return{get container(){return t().querySelector(".app-container")},get appContent(){return t().querySelector(".app-content")},get mediaContentWrapper(){return t().getElementById("media-content-wrapper")},get mediaController(){return t().getElementById("media-controller")},get controlsContainer(){return t().querySelector(".media-controller-controls")},get logoElements(){return Array.from(t().querySelectorAll(".logo-element"))},get logosContainer(){return t().getElementById("logos-container-inner")},get mediaContainer(){return t().getElementById("media-container")},get mediaOuterContainer(){return t().getElementById("media-controller-inner-players-container")},get mediaInfoContainer(){return t().getElementById("media-metadata-container")},get mediaInfos(){return Array.from(t().querySelectorAll(".media-info"))},get mediaPlayers(){return Array.from(t().querySelectorAll(".media-player"))},get messageOverlay(){return t().getElementById("app-message")},get navBar(){return t().getElementById("nav-bar")},get playbackControls(){return t().getElementById("playback-controls")},get secondaryControlsContainer(){return t().getElementById("secondary-playback-controls")},get splitHandle(){return t().getElementById("split-handle")},get layoutBtnTile(){return t().getElementById("layout-btn-tile")},get layoutBtnSplit(){return t().getElementById("layout-btn-split")},get helpBtn(){return t().getElementById("help-btn")},get appSettingsBtn(){return t().getElementById("settings-btn")},get topBar(){return t().getElementById("top-bar-element")},get contentSidebar(){return t().getElementById("content-sidebar")},get confirmDeleteSetModal(){return t().getElementById("confirm-delete-set-modal")},get confirmDeleteMediaModal(){return t().getElementById("confirm-delete-media-modal")},get confirmSaveProjectModal(){return t().getElementById("confirm-save-project-modal")}}}(this)}get isPlaying(){return this.query.mediaPlayers.reduce(((e,t)=>t&&t.mediaElement?!t.mediaElement.paused:e),!1)}constructor(){super(),C(this,ki)}getAppData(){this.updateCurrentSet();const e=this.getViewport(),t={activeSet:this.activeSet,sets:V(this.sets).map((t=>({...t,media:t.media.map((e=>({...e,mediaThumbnails:[]}))),viewport:{...e}})))};return this.mediaFiles&&(t.mediaFiles={...this.mediaFiles}),t}playerById(e){const t=this.query.mediaPlayers;return t[Number(t.findIndex((t=>t.id===e)))]}updateMediaSource=async(e,t="",i="")=>{const n=this.playerById(e);n&&"function"==typeof n.loadSrc&&n.loadSrc(t,i)};setAppData(e){e&&(this.activeSet="",this.sets=[],this.clearMedia(),this.antiAlias=!1,this.duration=0,this.endTime=0,this.fps=0,this.logos=[],this.time=0,this.grid=0,this.layout=R[0],this.looping=!1,this.boomerang=!1,this.boomerangDirection=1,this.position={x:0,y:0,z:100},this.shaderSources={},this.shaderUiSettings={},this.speed=1,this.splitposition=.5,this.startTime=0,this.muteState={},this.mediaLabels={},this.mediaNames={},this.mediaPositions={},this.mediaStartTimes={},this.mediaMetadata={},this.mediaOrder=[],this.mediaVisibility={},this.overlayVisibility={},"mediaFiles"in e&&(this.mediaFiles={...e.mediaFiles}),"sets"in e&&(this.sets=V(e.sets)),"uiVisibility"in e&&(this.uiVisibility=V(e.uiVisibility)),"activeSet"in e&&"sets"in e&&this.loadSet(e.activeSet))}addNewSet(){const e=a(),t=V(this.sets);var i;return t.push({id:e,label:(i=[],0===i.length?"Default set":i.reduce(((e,t)=>{const i=W(t.mediaName.base);return e?e===i?e:`${e} > ${i}`:i}),"")),customLabel:!1,antiAlias:!1,endTime:0,grid:0,layout:R[0],logos:[],looping:!1,boomerang:!1,media:[],position:{x:0,y:0,z:100},speed:1,splitposition:.5,startTime:0,time:0,viewport:this.getViewport(),shaderInputs:{},shaderSources:{},shaderUiSettings:{}}),this.sets=t,e}addMedia(e,t,i){if(B.isElectron||(this.mediaFiles[`${e}`]=t.file),this.addUndo("addMedia",e),!this.hasShownResolutionMessage){const{width:e,height:i}=t,n=Object.keys(this.mediaMetadata);let a=!1,o=0;for(;!a&&o<n.length;){const t=n[Number(o)];this.mediaMetadata[`${t}`].width===e&&this.mediaMetadata[`${t}`].height===i||(a=!0),o+=1}a&&(this.hasShownResolutionMessage=!0,this.showMessage("You have selected media with different resolutions. Click the gear icon next to the media selector to scale/move the media if needed."))}if(this.muteState={...this.muteState,[e]:!0},this.mediaLabels={...this.mediaLabels,[e]:{id:e,codec:!1,bitrate:!1,format:!1,dimensions:!1,fps:!1,variableFrameRate:!1,duration:!1,startTime:!1}},this.mediaNames={...this.mediaNames,[e]:{id:e,name:t.name,path:t.path,base:t.base,extension:t.extension,originalBase:t.base}},this.mediaPositions={...this.mediaPositions,[e]:{id:e,x:0,y:0,z:100}},this.mediaStartTimes={...this.mediaStartTimes,[e]:this.startTime||0},this.mediaThumbnails={...this.mediaThumbnails,[e]:t.thumbnails.slice()},this.mediaVisibility={...this.mediaVisibility,[e]:!0},this.mediaMetadata={...this.mediaMetadata,[e]:{id:e,codec:t.codec||"",bitrate:t.bitrate||0,format:t.format||"",width:t.width||0,height:t.height||0,type:t.type||"",fps:t.fps||0,variableFrameRate:t.variableFrameRate||!1,duration:t.duration||0,size:t.size,modified:t.modified}},void 0!==i&&i>-1){const t=this.mediaOrder.slice();t.splice(i,0,e),this.mediaOrder=t}else this.mediaOrder=this.mediaOrder.concat([e]);if(this.updateMediaSource(e,t.src,t.extension),this.refreshMedia(),this.updateXYZ(this.position.x,this.position.y,this.minScale),1!==this.#D||this.mediaThumbnails[`${e}`]&&!(this.mediaThumbnails[`${e}`].length<oe)||this.thumbnailCallbacks[`${e}`]||(this.thumbnailCallbacks[`${e}`]=le(e,B.isElectron?t.src:t.file,t.type,t.extension,(t=>this.updateMediaThumb(e,t)),(()=>{"function"==typeof this.thumbnailCallbacks[`${e}`]&&this.thumbnailCallbacks[`${e}`](),delete this.thumbnailCallbacks[`${e}`]}))),!this.activeSet){const e=this.addNewSet();this.activeSet=e}const n={...this.shaderInputs},a=this.query.mediaPlayers,o=a[Number(a.findIndex((t=>t.id===e)))];o?(Object.keys(n).forEach((t=>{let i=!1;const a=n[`${t}`].slice();let s=0;for(;a.length>s&&!i;)a[Number(s)]||(i=!0,a[Number(s)]={id:e,element:o.canvas()}),s+=1;n[`${t}`]=a})),this.shaderInputs=n,this.updateCurrentSet()):this.updateCurrentSet(),requestAnimationFrame((()=>this.focus()))}reAddMedia(e){const{id:t}=e;this.mediaFiles[`${t}`]=e.file,e.mediaLabels&&(this.mediaLabels={...this.mediaLabels,[t]:e.mediaLabels}),this.mediaNames={...this.mediaNames,[t]:e.mediaNames},e.mediaPositions&&(this.mediaPositions={...this.mediaPositions,[t]:e.mediaPositions}),this.mediaStartTimes={...this.mediaStartTimes,[t]:e.mediaStartTimes||0},this.mediaVisibility={...this.mediaVisibility,[t]:e.mediaVisibility},e.mediaMetadata&&(this.mediaMetadata={...this.mediaMetadata,[t]:e.mediaMetadata}),this.muteState={...this.muteState,[t]:e.muteState},1===this.#D&&(!this.mediaThumbnails[`${t}`]||this.mediaThumbnails[`${t}`].length<oe)&&e.mediaMetadata&&!this.thumbnailCallbacks[`${t}`]&&(this.thumbnailCallbacks[`${t}`]=le(t,B.isElectron?e.src:e.file,e.mediaMetadata.type,e.mediaNames.extension,(e=>this.updateMediaThumb(t,e)),(()=>{"function"==typeof this.thumbnailCallbacks[`${t}`]&&this.thumbnailCallbacks[`${t}`](),delete this.thumbnailCallbacks[`${t}`]})));const i=this.mediaOrder.slice();i.splice(e.index,0,t),this.mediaOrder=i;const n=B.getUrl(e.file,e.src);this.updateMediaSource(t,n,e.mediaNames.extension),this.refreshMedia(),this.updateCurrentSet()}updateMediaThumb=(e,t)=>{this.mediaThumbnails={...this.mediaThumbnails,[e]:t},this.updateCurrentSet()};deleteMedia(e,t=!0){if(!e)return;const i=this.mediaOrder.indexOf(e);if(t){const t=this.query.mediaPlayers.find((t=>t.id===e));let i;t&&"function"==typeof t.getSrc&&(i=B.pathFromElectronUrl(t.getSrc())),this.addUndo("deleteMedia",{mediaStartTimes:this.mediaStartTimes[`${e}`],mediaPositions:this.mediaPositions[`${e}`]?{...this.mediaPositions[`${e}`]}:void 0,mediaNames:{...this.mediaNames[`${e}`]},mediaLabels:this.mediaLabels[`${e}`]?{...this.mediaLabels[`${e}`]}:void 0,mediaVisibility:this.mediaVisibility[`${e}`],mediaMetadata:this.mediaMetadata[`${e}`]?{...this.mediaMetadata[`${e}`]}:void 0,file:this.mediaFiles[`${e}`],src:i,id:e,index:this.mediaOrder.indexOf(e)})}else this.undoStack=this.undoStack.filter((t=>t.value!==e));if(delete this.mediaFiles[`${e}`],i>-1){const e=this.mediaOrder.slice();e.splice(i,1),this.mediaOrder=e}const n={...this.mediaVisibility};delete n[`${e}`],this.mediaVisibility=n;const a={...this.muteState};delete a[`${e}`],this.muteState=a;const o={...this.mediaStartTimes};delete o[`${e}`],this.mediaStartTimes=o;const s={...this.mediaPositions};delete s[`${e}`],this.mediaPositions=s;const r={...this.mediaNames};delete r[`${e}`],this.mediaNames=r;const l={...this.mediaLabels};delete l[`${e}`],this.mediaLabels=l;const d={...this.mediaMetadata};delete d[`${e}`],this.mediaMetadata=d,0===this.mediaOrder.length&&(this.splitposition=.5,this.time=0,this.startTime=0,this.endTime=0);const c={...this.shaderInputs},h=this.query.mediaPlayers,u=h.map((e=>e.id));Object.keys(c).forEach((t=>{const i=[],n=c[`${t}`].map((t=>t&&t.id===e?null:(t&&t.id&&i.push(t.id),t)));n.forEach(((e,a)=>{if(!e){const e=u.findIndex((e=>-1===i.indexOf(e)&&t!==e));if(e>-1){const t=u[Number(e)];n[Number(a)]={id:t,element:h[Number(e)].canvas()},i.push(t)}}})),c[`${t}`]=n})),this.shaderInputs=c,this.updateCurrentSet()}addShader=e=>{const t=a();this.shaderSources={...this.shaderSources,[t]:{source:e.source,inputs:e.inputs,defaultSettings:e.UI}};const i=Array(e.inputs).fill(null),n=this.query.mediaPlayers;i.forEach(((e,t)=>{const a=n[Number(t)];a&&(i[Number(t)]={id:a.id,element:a.canvas()})})),this.shaderInputs={...this.shaderInputs,[t]:i},this.shaderUiSettings={...this.shaderUiSettings,[t]:e.UI},this.mediaNames={...this.mediaNames,[t]:{id:t,extension:"",name:e.name,base:e.name,path:e.name,originalBase:e.name}},this.mediaVisibility={...this.mediaVisibility,[t]:!0},this.mediaOrder=this.mediaOrder.concat([t]),this.refreshMedia(),this.updateCurrentSet()};loadSet(e,t=!0){this.activeSet!==e&&t&&this.addUndo("loadSet",{from:this.activeSet,to:e}),this.shouldPlay=!1,this.playing=!1;const i=this.sets.find((t=>t.id===e));if(!i)return;this.updateCurrentSet(),this.clearMedia();const n=[],a={},o={},s={},r={},l={},d={},c={},h={},u={},m=i.media.map((e=>e.id));Object.keys(this.sourceControllers).forEach((e=>{-1===m.indexOf(e)&&(this.sourceControllers[`${e}`].abort(),delete this.sourceControllers[`${e}`])})),i.media.forEach((e=>{const t=e.id;n.push(t),a[`${t}`]=e.visible,s[`${t}`]=e.muted,r[`${t}`]=e.mediaStartTime,u[`${t}`]=e.mediaThumbnails,e.mediaPosition&&(l[`${t}`]=V(e.mediaPosition)),d[`${t}`]=V(e.mediaName),e.mediaLabels&&(c[`${t}`]=V(e.mediaLabels)),e.mediaLabels&&(h[`${t}`]=V(e.metadata)),this.uiVisibility.timeline&&1===this.#D&&(!e.mediaThumbnails||e.mediaThumbnails.length<oe)&&e.metadata&&!this.thumbnailCallbacks[`${e.id}`]&&(this.thumbnailCallbacks[`${e.id}`]=le(e.id,B.isElectron?e.src:this.mediaFiles[`${e.id}`],e.metadata.type,e.mediaName.extension,(t=>this.updateMediaThumb(e.id,t)),(()=>{"function"==typeof this.thumbnailCallbacks[`${e.id}`]&&this.thumbnailCallbacks[`${e.id}`](),delete this.thumbnailCallbacks[`${e.id}`]})))})),Object.keys(this.thumbnailCallbacks).forEach((e=>{-1===n.indexOf(e)&&("function"==typeof this.thumbnailCallbacks[`${e}`]&&this.thumbnailCallbacks[`${e}`](),delete this.thumbnailCallbacks[`${e}`])})),i.logos.forEach((e=>{o[`${e.id}`]=void 0===e.visible||e.visible})),this.mediaThumbnails=u,this.hasMedia=!0,this.antiAlias=i.antiAlias,this.layout=i.layout,this.splitposition=i.splitposition,this.time=i.time,this.startTime=i.startTime,this.endTime=i.endTime,this.grid=i.grid,this.speed=i.speed,this.position=V(i.position),this.looping=i.looping,this.boomerang=i.boomerang,this.logos=V(i.logos),this.shaderSources=i.shaderSources,this.shaderUiSettings=i.shaderUiSettings,this.mediaVisibility=a,this.overlayVisibility=o,this.muteState=s,this.mediaStartTimes=r,this.mediaPositions=l,this.mediaNames=d,this.mediaLabels=c,this.mediaMetadata=h,this.mediaOrder=n;const p=this.mediaFiles||{};i.media.forEach((e=>{let t="";e.src?t=e.src:p[`${e.id}`]&&(t=URL.createObjectURL(p[`${e.id}`])),t&&this.updateMediaSource(e.id,t,e.mediaName.extension)}));const g=this.query.mediaPlayers;this.shaderInputs=Object.keys(i.shaderInputs||{}).reduce(((e,t)=>({...e,[`${t}`]:i.shaderInputs[`${t}`].map((e=>{const t=g.find((t=>t.id===e.id));return{id:e.id,element:t?t.canvas():void 0}}))})),{});const b=this.query.mediaPlayers;let f=0;const v=()=>{this.setViewport();const{width:e,height:t}=this.getViewport(),n=Math.max(this.minScale,Math.max(i.position.z,this.minScale)/Math.max(i.viewport.width/e,i.viewport.height/t)),a=i.position.z/n;this.updateXYZ(i.position.x/a,i.position.y/a,n),this.dispatchEvent(new CustomEvent("playersready",{bubbles:!0,composed:!0,detail:this}))};return b.forEach((e=>{const t=()=>{f===b.length&&(v(),this.disableTimeControls=!1)};if(e.ready)return f+=1,t();const i=()=>{e.removeEventListener("rendererready",i),f+=1,t()};e.addEventListener("rendererready",i)})),this.activeSet=i.id,this.updateXYZ(i.position.x,i.position.y,i.position.z||this.minScale),requestAnimationFrame((()=>this.focus())),this.dispatchEvent(new CustomEvent("compare-app-set-loaded",{bubbles:!0,composed:!0,detail:this.activeSet})),i}updateCurrentSet(){const e=this.sets.find((e=>e.id===this.activeSet));if(!e)return;const t={...e};t.antiAlias=this.antiAlias,t.splitposition=this.splitposition,t.time=this.time,t.position=V(this.position),t.viewport=V(this.getViewport()),t.startTime=this.startTime,t.endTime=this.endTime,t.grid=this.grid,t.speed=this.speed,t.looping=this.looping,t.boomerang=this.boomerang,t.layout=this.layout,t.logos=V(this.logos).map((e=>({...e,visible:this.overlayVisibility[`${e.id}`]}))),t.media=((e,t)=>t.mediaOrder.map((i=>{const n=V({...e.media.find((e=>e.id===i))});n.id=i,n.visible=void 0===t.mediaVisibility[`${i}`]||t.mediaVisibility[`${i}`],n.mediaLabels=t.mediaLabels[`${i}`]?V(t.mediaLabels[`${i}`]):void 0,n.muted=void 0===t.muteState[`${i}`]||t.muteState[`${i}`],n.mediaStartTime=t.mediaStartTimes[`${i}`]||0,n.mediaPosition=t.mediaPositions[`${i}`]?V(t.mediaPositions[`${i}`]):void 0,n.mediaName=V(t.mediaNames[`${i}`]),n.metadata=t.mediaMetadata[`${i}`]?V(t.mediaMetadata[`${i}`]):void 0;const a=t.mediaThumbnails&&t.mediaThumbnails[`${i}`]||[];return n.mediaThumbnails=a,B.setMediaSourceFromPlayer(t,n)})))(t,this),t.label=t.label||"Default set",t.shaderInputs=Object.keys(this.shaderInputs).reduce(((e,t)=>({...e,[`${t}`]:this.shaderInputs[`${t}`].map((e=>e?{id:e.id}:null))})),{}),t.shaderSources=V(this.shaderSources),t.shaderUiSettings=V(this.shaderUiSettings);const i=V(this.sets),n=i.findIndex((e=>e.id===t.id));return i[Number(n)]=t,this.sets=i,t}clearMedia(){this.mediaOrder=[],this.mediaVisibility={},this.overlayVisibility={},this.muteState={},this.mediaStartTimes={},this.mediaPositions={},this.mediaNames={},this.mediaLabels={},this.mediaMetadata={},this.splitposition=.5,this.time=0,this.startTime=0,this.endTime=0}getElementAtPoint=(e,t)=>{const i=this.shadowRoot.elementFromPoint(e,t);return i&&"function"==typeof i.getElementAtPoint?i.getElementAtPoint(e,t):i};getViewport(){if("split"===this.layout){const e=this.query.mediaContainer,{width:t,height:i}=e.getBoundingClientRect();return{width:t,height:i}}const e=this.mediaVisibility,t=this.query.mediaPlayers.find((t=>!0===e[`${t.id}`]));if(!t)return{width:this.offsetWidth,height:this.offsetHeight};const{width:i,height:n}=t.getBoundingClientRect();return{width:i,height:n}}addUndo(e,t){if(void 0===t)return;let i,n=this.undoStack.length-1;for(;!i&&n>-1;){const t=this.undoStack[Number(n)];t&&t.key===e&&(i=t),n-=1}if(!(i&&i.value===t||"endTime"===e&&0===t)){for(this.undoStack.push({key:e,value:t});this.undoStack.length>20;)this.undoStack.shift();B.clearCache()}}undo(){const e=this.undoStack.pop();if(e)if("loadSet"===e.key&&this.loadSet(e.value.from,!1),"antiAlias"!==e.key)if("grid"!==e.key)if("speed"!==e.key)if("startTime"!==e.key)if("endTime"!==e.key){if("switchMedia"!==e.key)return e;this.switchMedia(e.value.id,e.value.from,!1)}else this.endTime=this.calculateEndTime(e.value,this.startTime||0);else this.startTime=this.calculateStartTime(e.value);else this.speed=e.value;else this.grid=e.value;else this.antiAlias=e.value}setAdjustedTime(){this.adjustedDuration=this.endTime-this.startTime,this.adjustedTime=Math.max(0,Math.min(this.adjustedDuration,this.time-this.startTime))}setDurationString(){this.durationString=T(this.adjustedDuration,this.fps)}setEndTimeString(){this.endTimeString=T(this.endTime,this.fps)}setStartTimeString(){this.startTimeString=T(this.startTime,this.fps)}setTimeString(){this.timeString=T(this.adjustedTime,this.fps)}showMessage=e=>{this.message=e};showHelp=()=>{this.message="";const{messageOverlay:e}=this.query;e.innerHTML=`<help-content slot="content" webgl="${this.#t}" id="help-overlay-content"></help-content>`};switchMedia=(e,t,i=!0)=>{const n=this.mediaOrder.slice(),a=n.indexOf(e);if(-1===a||a===t)return;i&&this.addUndo("switchMedia",{from:a,to:t,id:e});const o=n[Number(t)];n[Number(a)]=o,n[Number(t)]=e,this.mediaOrder=n};refreshMedia(){const{fps:e,duration:t,hasVideo:i,maxHeight:n,maxWidth:a,minStartTime:o}=(s=this.mediaVisibility,r=this.mediaMetadata,l=this.mediaStartTimes,Object.keys(r).reduce(((e,t)=>{const i=r[`${t}`];if(!i)return e;const n=!0===s[`${t}`]||void 0===s[`${t}`];return{fps:Math.max(e.fps,i.fps),duration:Math.max(e.duration,i.duration),maxWidth:Math.max(e.maxWidth,n?i.width:0),maxHeight:Math.max(e.maxHeight,n?i.height:0),hasVideo:e.hasVideo||"video"===i.type,minStartTime:Math.max(e.minStartTime,l[`${t}`])}}),{fps:0,duration:0,maxWidth:0,maxHeight:0,hasVideo:!1,minStartTime:0}));var s,r,l;this.fps=e,this.duration=t,this.hasVideo=i,this.maxHeight=n,this.maxWidth=a,this.hasMedia=this.mediaOrder.length>0||this.sets.length>0,this.minStartTime=o,this.setViewport(),this.adjustStartEnd()}updateMediaInfo(){const e=()=>this.mediaOrder.map((e=>({value:e,label:this.mediaNames[`${e}`].base}))),t=e();k({array:this.mediaOrder,container:this.query.mediaInfoContainer,getElementsFn:()=>this.query.mediaInfos,valueKeyFn:e=>e,elementValueKeyFn:e=>e.mediaId,createFn:(e,i)=>{const n=!!this.shaderUiSettings[`${e}`],a=this.isembed?"media-info":n?"shader-settings":"media-settings",o={class:"media-info",id:e,"bind-prop-mediaLabels":`labels:${e}`,"bind-prop-mediaNames":`names:${e}`,"bind-prop-mediaPositions":`position:${e}`,"bind-prop-fullscreen":"fullscreen","bind-attr-mediaVisibility":`data-visible:${e}`,"bind-prop-disableReorder":"noSelect"};"media-settings"===a||"media-info"===a?(o["bind-prop-mediaMetadata"]=`metadata:${e}`,o["bind-prop-mediaStartTimes"]=`startTime:${e}`,o["bind-prop-muteState"]=`mute:${e}`):(o.class="media-info shader-settings",o.editable=this.isembed?"false":"true",o["bind-prop-shaderSources"]=`shaderSource:${e}`,o["bind-prop-shaderInputs"]=`inputMedia:${e}`,o["bind-prop-shaderUiSettings"]=`uiSettings:${e}`);return y({tag:a,properties:{options:t,mediaId:e,mediaindex:i},attributes:o})},updateFn:(t,i,n)=>{t.options=e(),t.mediaindex=n}})}updatePlayers(){k({array:this.mediaOrder,container:this.query.mediaContainer,getElementsFn:()=>this.query.mediaPlayers,valueKeyFn:e=>e,elementValueKeyFn:e=>e.id,updateFn:()=>{},createFn:e=>{const t={class:"media-player","bind-prop-mediaNames":`extension:${e}.extension`,"bind-prop-antiAlias":"antiAlias","bind-prop-grid":"grid","bind-prop-layout":"layout","bind-prop-position":"position","bind-prop-speed":"speed","bind-prop-time":"time","bind-prop-mediaPositions":`mediaPosition:${e}`,"bind-attr-mediaVisibility":`data-visible:${e}`,"bind-prop-muteState":`mute:${e}`,"bind-prop-viewportWidth":"viewportWidth","bind-prop-gamma":"gamma","bind-prop-exposure":"exposure","bind-prop-quickTimeUpdate":"quickTimeUpdate","bind-prop-boomerang":"boomerang","bind-prop-boomerangDirection":"boomerangDirection",webgl:this.#t.toString()},i={id:e};return y(!this.shaderUiSettings[`${e}`]?{tag:"media-player",properties:{...i,type:this.mediaMetadata[`${e}`].type,fps:this.mediaMetadata[`${e}`].fps},attributes:t}:{tag:"shader-viewer",properties:i,attributes:{...t,class:"media-player shader-viewer","bind-prop-shaderSources":`shaderSource:${e}`,"bind-prop-shaderInputs":`inputMedia:${e}`,"bind-prop-shaderUiSettings":`uiSettings:${e}`}})}})}updateLogos(){k({container:this.query.logosContainer,array:this.logos,getElementsFn:()=>this.query.logoElements,createFn:(e,t)=>y({tag:"logo-element",attributes:{class:"logo-element",id:e.id,"bind-prop-logos":`logo:${t}`},properties:{hideEdit:!0,visible:this.overlayVisibility[`${e.id}`]}}),valueKeyFn:e=>e.id,elementValueKeyFn:e=>e.id,updateFn:(e,t)=>{e.visible=this.overlayVisibility[`${t.id}`]}})}paneDimensions(){const e=this.mediaVisibility,t=this.mediaOrder.filter((t=>!0===e[`${t}`]||void 0===e[`${t}`])).length;return{width:this.viewportWidth/("split"===this.layout?1:t),height:this.viewportHeight}}setSplit(){this.query.layoutBtnSplit.active="split"===this.layout,this.query.layoutBtnTile.active="tile"===this.layout;const e=this.mediaVisibility,t=t=>{if(!t)return!1;const i=t.id||t.mediaId,n=e[`${i}`];return!0===n||void 0===n},i=this.query.mediaPlayers||[],n=this.query.mediaInfos||[],a=(e,t)=>{e.classList.remove("split-left"),e.classList.remove("split-right"),e.mediaindex=t};i.forEach(((e,t)=>{a(e,t),e.style.removeProperty("width")})),n.forEach(((e,t)=>{a(e,t),e.alignRight=!1}));const o=i.filter(t),s=n.filter(t);if(o.length<2||"split"!==this.layout)return this.showSplit=!1,void this.setMinScale();this.showSplit=!0,o[0]&&(o[0].index=0,o[0].classList.add("split-left"),o[0].style.width=100*this.splitposition+"%"),o[1]&&(o[1].index=1,o[1].classList.add("split-right"),o[1].style.width=100*(1-this.splitposition)+"%"),s[0]&&(s[0].mediaindex=0,s[0].classList.add("split-left"),s[0].alignRight=!1),s[1]&&(s[1].mediaindex=1,s[1].classList.add("split-right"),s[1].alignRight=!0),this.setMinScale()}setViewport=()=>{const{mediaContainer:e}=this.query;let t=e.offsetWidth,i=e.offsetHeight;if(!B.isElectron){const n=this.query.controlsContainer,a=this.query.navBar;if(n&&a){const o=n.offsetHeight,s=a.offsetHeight,r=t*(this.maxHeight/this.maxWidth)+o+s,l=window.innerHeight,d=l<r?l:r;Number.isNaN(d)||(this.style.minHeight=`${Math.round(d)}px`),t=e.offsetWidth,i=e.offsetHeight}}const n=this.viewportWidth,a=this.viewportHeight;this.viewportWidth=t,this.viewportHeight=i,t===n&&i===a||this.dispatchEvent(new CustomEvent("viewportresize",{bubbles:!0,composed:!0,detail:this})),this.setMinScale(),this.updateXYZ(this.position.x,this.position.y,this.position.z)};scaleOrMin(e){return Math.max(e,this.minScale)}setMinScale(){const e=this.query.mediaContainer;if(!this.mediaOrder.length||!e)return;const{width:t,height:i}=this.paneDimensions(),n=100*Math.min(t/this.maxWidth,i/this.maxHeight),a=Math.min(100,100*Math.min(t/this.maxWidth,i/this.maxHeight));!Number.isNaN(a)&&Number.isFinite(a)&&(this.minScale=this.constrainScaleToFit?n:a,this.fitScale=n,this.position.z<a?this.updateXYZ(this.position.x,this.position.y,a):this.updateXYZ(this.position.x,this.position.y,this.position.z))}updateXYZ(e,t,i){const n=Math.round(e),a=Math.round(t),o=Math.round(i),s=o/100,{width:r,height:l}=this.paneDimensions(),d=0===this.mediaOrder.length?0:1e14,c={...this.mediaVisibility},{x:h,y:u}=this.mediaOrder.reduce(((e,t)=>{const i=this.mediaMetadata[`${t}`],o=!0===c[`${t}`]||void 0===c[`${t}`],h=this.shaderInputs[`${t}`];if(h&&o){const{__x:t,__y:i}=h.reduce(((e,t)=>{if(!t)return e;const i=this.mediaMetadata[`${t.id}`];return i?(e.__x=Math.min(e.__x,I(s,r,i.width||r,n)),e.__y=Math.min(e.__y,I(s,l,i.height||l,a)),e):e}),{__x:d,__y:d});return e.x=Math.min(e.x,t),e.y=Math.min(e.y,i),e}return i&&o?(e.x=Math.round(Math.min(e.x,I(s,r,i.width||r,n))),e.y=Math.round(Math.min(e.y,I(s,l,i.height||l,a))),e):e}),{x:d,y:d});Number.isNaN(h)||Number.isNaN(u)||Number.isNaN(o)||(this.position={x:h,y:u,z:o})}async onVideoEnd(){await this.pause(),this.looping?(await this.setCurrentTime(this.startTime,!0),requestAnimationFrame((()=>{this.shouldPlay&&this.play()}))):this.boomerang&&this.time>=this.getEndTime()?(await this.setCurrentTime(this.time,!0),this.boomerangDirection=-1,requestAnimationFrame((()=>this.play()))):this.boomerang&&this.time<=this.startTime?(await this.setCurrentTime(this.startTime,!0),this.boomerangDirection=1,requestAnimationFrame((()=>this.play()))):(this.shouldPlay=!1,await this.setCurrentTime(this.startTime,!0),this.playing=!1,this.time=this.startTime)}async setCurrentTime(e,t=!1){return t&&(this.playing=!1),this.time=Math.max(this.startTime,Math.min(e,this.getEndTime())),t?(await this.refreshPlayerTime(),Promise.resolve(this.time)):Promise.resolve(this.time)}async refreshPlayerTime(){await Promise.all(this.query.mediaPlayers.map((e=>"function"==typeof e.seek?e.seek(this.time-this.getMediaStartTime(e.id)):Promise.resolve())))}async play(){if(!this.hasVideo||!this.shouldPlay)return;"function"==typeof this.cancelTimeListener&&this.cancelTimeListener(),this.disableTimeControls=!0,this.cancelTimeListener=null,this.playing=!0,this.boomerangDirection=this.time<this.getEndTime()?1:-1;let e=0;const t=this.query.mediaPlayers;for(;!this.cancelTimeListener&&e<this.mediaOrder.length;){const i=this.mediaOrder[Number(e)],n=this.mediaMetadata[`${i}`];n&&"video"===n.type&&(this.cancelTimeListener=t[Number(e)].onTime(((e,t)=>{const n=e+this.getMediaStartTime(i);this.boomerang&&-1===this.boomerangDirection&&n<=this.startTime||n>=this.getEndTime()||t?this.onVideoEnd():this.setCurrentTime(n)}))),e+=1}await Promise.all(t.map((e=>"function"==typeof e.play?e.play():Promise.resolve()))),this.shouldPlay||await this.pause(),this.disableTimeControls=!1}async pause(){"function"==typeof this.cancelTimeListener&&this.cancelTimeListener(),this.disableTimeControls=!0,this.cancelTimeListener=null,this.playing=!1;const e=this.query.mediaPlayers;await Promise.all(e.map((e=>"function"==typeof e.pause?e.pause():Promise.resolve())));const t=Math.min(this.getEndTime(),Math.max(this.startTime,e.reduce(((e,t)=>"function"==typeof t.currentTime?Math.max(e,t.currentTime()+this.getMediaStartTime(t.id)):e),0)));await Promise.all(e.map((e=>"function"==typeof e.seek?e.seek(t-this.getMediaStartTime(e.id)):Promise.resolve()))),this.time=t,this.disableTimeControls=!1}getMediaStartTime(e){return this.mediaStartTimes[`${e}`]||0}updateMediaTime(e){const t=this.playerById(e),i=this.getMediaStartTime(e);!t||t&&"function"!=typeof t.seek||t.seek(this.time-i)}getEndTime(){return 0===this.endTime?this.duration:this.endTime}startEndUpdate(){0!==this.endTime&&(this.time>this.endTime?this.setCurrentTime(this.endTime,!0):this.time<this.startTime&&this.setCurrentTime(this.startTime,!0))}getMinEndTime(){const e=(e,t)=>e&&0!==e.duration?t+(e.duration-L(e.fps)):this.duration;return this.mediaOrder.reduce(((t,i)=>Math.min(t,e(this.mediaMetadata[`${i}`],this.getMediaStartTime(i)))),this.duration)}getMinStartTime(){return this.mediaOrder.reduce(((e,t)=>Math.max(e,this.getMediaStartTime(t))),0)}calculateStartTime(e){return Math.max(this.minStartTime,e)}calculateEndTime(e,t){const i=this.getMinEndTime();return Math.min(i,Math.max(t+L(this.fps),e))}adjustStartEnd(){if(0===this.duration)return;this.startTime=this.calculateStartTime(this.startTime),this.endTime=this.calculateEndTime(this.getEndTime(),this.startTime);const e=(new Date).getTime();this._state.startTime.previous!==this.startTime&&e-this.lastStartTimeUpdate>1e3&&(this.lastStartTimeUpdate=e,this.addUndo("startTime",this._state.startTime.previous)),-1!==this._state.endTime.previous&&this._state.endTime.previous!==this.endTime&&e-this.lastEndTimeUpdate>1e3&&(this.lastEndTimeUpdate=e,this.addUndo("endTime",this._state.endTime.previous))}focus(){this.query.container.focus()}updateMediaStartTime(e,t){const i=this.mediaStartTimes[`${e}`],n=this.mediaMetadata[`${e}`],a=n?n.duration:0,o=this.getEndTime(),s=this.startTime,r=t;if(!a||a<=0)return;if(r+a<s+.5||r+.5>o)return;this.mediaStartTimes={...this.mediaStartTimes,[e]:r},this.minStartTime=Object.keys(this.mediaStartTimes).reduce(((e,t)=>Math.max(e,this.mediaStartTimes[`${t}`])),0),this.adjustStartEnd(),this.updateMediaTime(e);const l=(new Date).getTime();i!==this.mediaStartTimes[`${e}`]&&l-this.lastMediaStartTimeUpdate>1e3&&(this.lastMediaStartTimeUpdate=l,this.addUndo("mediaStartTime",{id:e,value:i}))}updateEndTime(e){if(0===this.duration)return;const t=this.getMinEndTime();e>t?this.endTime=t:e<=this.startTime+.25?this.endTime=this.startTime+.25:this.endTime=e,this.adjustStartEnd()}updateStartTime(e){if(0===this.duration)return;const t=this.getMinStartTime();e>=this.endTime-.5?this.startTime=this.endTime-.5:this.startTime=e<0?0:e<t?t:e,this.adjustStartEnd()}attached(){B.isElectron&&(document.body.style.overflow="hidden",window.addEventListener("error",(e=>{try{B.logError(e.error.toString())}catch(e){}})));const{mediaContainer:e}=this.query;this.viewportWidth=e.offsetWidth,this.viewportHeight=e.offsetHeight,this.resizeObserver=new ResizeObserver((()=>this.setViewport())),this.resizeObserver.observe(this.query.mediaContainer),this.setViewport(),this.setSplit(),this.setAdjustedTime(),this.setStartTimeString(),z.bind(this)();const t=this.query.contentSidebar;t&&(t.controller=this);const i=this.query.playbackControls;i&&(i.controller=this)}detached(){this.resizeObserver&&this.resizeObserver.disconnect()}})}));
</script><script type="text/javascript">(function(){ const app = document.getElementById('icat-20187219999999553fdecabf76ce608c924534'); app.setAppData({"activeSet":"5539bb3388050191cdd712446","uiVisibility":{"antiAliasSelect":true,"fullscreenButton":true,"gridSelect":true,"helpButton":true,"layersButton":true,"layoutTabs":true,"loopButton":true,"mediaInfo":true,"pixelDataButton":true,"progressBar":true,"setSelect":true,"speedSelect":true,"startEndTime":false,"timeDisplay":true,"titleBar":false,"videoControls":true,"zoomSelect":true,"timeline":false,"contentSidebar":false,"controlBar":true,"inOutSlider":false,"addLogoBtn":false,"appSettingsBtn":true,"addFilterBtn":false},"sets":[{"id":"5539bb3388050191cdd712446","label":"Default set","customLabel":false,"antiAlias":false,"endTime":25,"grid":0,"layout":"split","logos":[],"looping":false,"boomerang":false,"media":[{"id":"5431759999999403959f2a6e44db579ad49900","visible":true,"mediaLabels":{"id":"5431759999999403959f2a6e44db579ad49900","codec":false,"bitrate":false,"format":false,"dimensions":false,"fps":false,"variableFrameRate":false,"duration":false,"startTime":false},"muted":true,"mediaStartTime":0,"mediaPosition":{"id":"5431759999999403959f2a6e44db579ad49900","x":0,"y":0,"z":100},"mediaName":{"id":"5431759999999403959f2a6e44db579ad49900","name":"Ground-Truth.webm","base":"Ground-Truth","extension":"webm","originalBase":"Ground-Truth"},"metadata":{"id":"5431759999999403959f2a6e44db579ad49900","codec":"V_VP9","bitrate":17828456,"format":"WebM","width":1280,"height":720,"type":"video","fps":20,"variableFrameRate":false,"duration":25.05,"size":58149686,"modified":1668782486632},"mediaThumbnails":[],"src":"Ground-Truth.webm"},{"id":"8599a2999999970227f7f8c4cd8acbd312788","visible":true,"mediaLabels":{"id":"8599a2999999970227f7f8c4cd8acbd312788","codec":false,"bitrate":false,"format":false,"dimensions":false,"fps":false,"variableFrameRate":false,"duration":false,"startTime":false},"muted":true,"mediaStartTime":0,"mediaPosition":{"id":"8599a2999999970227f7f8c4cd8acbd312788","x":0,"y":0,"z":100},"mediaName":{"id":"8599a2999999970227f7f8c4cd8acbd312788","name":"VideoINR.webm","base":"VideoINR","extension":"webm","originalBase":"VideoINR"},"metadata":{"id":"8599a2999999970227f7f8c4cd8acbd312788","codec":"V_VP9","bitrate":17381166,"format":"WebM","width":1280,"height":720,"type":"video","fps":20,"variableFrameRate":false,"duration":25.05,"size":56691358,"modified":1668781488369},"mediaThumbnails":[],"src":"VideoINR.webm"}],"position":{"x":320,"y":31,"z":100},"speed":1,"splitposition":0.5,"startTime":0,"time":0,"viewport":{"width":1920,"height":781.078125},"shaderInputs":{},"shaderSources":{},"shaderUiSettings":{}}]});})()</script></body></html>